Index: app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNewEventFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.organizer;\r\n\r\nimport android.app.DatePickerDialog;\r\nimport android.app.TimePickerDialog;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.text.TextUtils;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.CheckBox;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageButton;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.result.ActivityResultLauncher;\r\nimport androidx.activity.result.contract.ActivityResultContracts;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.navigation.Navigation;\r\n\r\nimport com.example.magpie_wingman.MyApp;\r\nimport com.example.magpie_wingman.R;\r\nimport com.example.magpie_wingman.data.DbManager;\r\nimport com.example.magpie_wingman.data.model.User;\r\nimport com.google.firebase.firestore.SetOptions;\r\n\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.Calendar;\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.Locale;\r\nimport java.util.Map;\r\n\r\npublic class OrganizerNewEventFragment extends Fragment {\r\n\r\n    private EditText eventTitleField, eventLimitField, eventAddressField, eventCityField, eventProvinceField, eventDescriptionField;\r\n    private EditText eventDateField, eventTimeField, regStartDateField, regEndDateField;\r\n    private CheckBox qrCheckBox;\r\n    private Button createButton, uploadPosterButton;\r\n\r\n    User currentUser = MyApp.getInstance().getCurrentUser();\r\n    private final Calendar eventCalendar = Calendar.getInstance();\r\n    private final Calendar regStartCalendar = Calendar.getInstance();\r\n    private final Calendar regEndCalendar = Calendar.getInstance();\r\n    private final SimpleDateFormat dateFmt = new SimpleDateFormat(\"yyyy-MM-dd\", Locale.getDefault());\r\n    private final SimpleDateFormat timeFmt = new SimpleDateFormat(\"HH:mm\", Locale.getDefault());\r\n\r\n    private Uri posterImageUri;\r\n    private ActivityResultLauncher<String> pickImageLauncher;\r\n\r\n    public OrganizerNewEventFragment() { }\r\n\r\n    @Override\r\n    public void onCreate(@Nullable Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        pickImageLauncher = registerForActivityResult(new ActivityResultContracts.GetContent(), uri -> {\r\n            if (uri != null) {\r\n                posterImageUri = uri;\r\n                if (uploadPosterButton != null) uploadPosterButton.setText(\"Poster selected\");\r\n            }\r\n        });\r\n    }\r\n\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\r\n        return inflater.inflate(R.layout.fragment_organizer_new_event, container, false);\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\r\n        super.onViewCreated(view, savedInstanceState);\r\n\r\n        eventTitleField = view.findViewById(R.id.edit_event_title);\r\n        eventLimitField = view.findViewById(R.id.edit_limit);\r\n        eventAddressField = view.findViewById(R.id.edit_address);\r\n        eventCityField = view.findViewById(R.id.edit_city);\r\n        eventProvinceField = view.findViewById(R.id.edit_province);\r\n        eventDescriptionField = view.findViewById(R.id.edit_description);\r\n        eventDateField = view.findViewById(R.id.edit_date);\r\n        eventTimeField = view.findViewById(R.id.edit_time);\r\n        regStartDateField = view.findViewById(R.id.edit_registration_start);\r\n        regEndDateField = view.findViewById(R.id.edit_registration_end);\r\n        qrCheckBox = view.findViewById(R.id.checkbox_qr);\r\n        createButton = view.findViewById(R.id.button_create);\r\n        uploadPosterButton = view.findViewById(R.id.button_upload_poster);\r\n        ImageButton backBtn = view.findViewById(R.id.button_back);\r\n\r\n        setupPickers();\r\n        backBtn.setOnClickListener(v -> Navigation.findNavController(view).navigateUp());\r\n        uploadPosterButton.setOnClickListener(v -> pickImageLauncher.launch(\"image/*\"));\r\n        createButton.setOnClickListener(v -> saveEvent(view));\r\n    }\r\n\r\n    private void saveEvent(View view) {\r\n        String title = eventTitleField.getText().toString().trim();\r\n        String desc = eventDescriptionField.getText().toString().trim();\r\n        String limitStr = eventLimitField.getText().toString().trim();\r\n\r\n        if (TextUtils.isEmpty(title)) {\r\n            Toast.makeText(getContext(), \"Title is required\", Toast.LENGTH_SHORT).show();\r\n            return;\r\n        }\r\n\r\n        int waitlistLimit = limitStr.isEmpty() ? 0 : Integer.parseInt(limitStr);\r\n        int capacity = 100;\r\n        String location = eventAddressField.getText().toString() + \", \" + eventCityField.getText().toString();\r\n        String organizerId = (currentUser != null) ? currentUser.getUserId() : \"unknown\";\r\n\r\n        createButton.setEnabled(false);\r\n        createButton.setText(\"Creating...\");\r\n\r\n        new Thread(() -> {\r\n            try {\r\n                com.google.android.gms.tasks.Task<Void> task = DbManager.getInstance().createEvent(\r\n                        title, desc, organizerId, regStartCalendar.getTime(), regEndCalendar.getTime()\r\n                );\r\n                if (getActivity() != null) {\r\n                    task.addOnSuccessListener(getActivity(), aVoid -> {\r\n                        findLastEventAndFillDetails(title, organizerId, location, capacity, waitlistLimit, eventCalendar.getTime(), posterImageUri);\r\n                        Toast.makeText(getContext(), \"Event Created!\", Toast.LENGTH_SHORT).show();\r\n                        Navigation.findNavController(view).navigateUp();\r\n                    }).addOnFailureListener(getActivity(), e -> {\r\n                        createButton.setEnabled(true);\r\n                        createButton.setText(\"CREATE\");\r\n                    });\r\n                }\r\n            } catch (Exception e) {\r\n                // ignore\r\n            }\r\n        }).start();\r\n    }\r\n\r\n    private void findLastEventAndFillDetails(String title, String orgId, String loc, int cap, int wlLimit, Date start, @Nullable Uri posterUri) {\r\n        DbManager.getInstance().getDb().collection(\"events\")\r\n                .whereEqualTo(\"eventName\", title).whereEqualTo(\"organizerId\", orgId).limit(1)\r\n                .get()\r\n                .addOnSuccessListener(snapshots -> {\r\n                    if (!snapshots.isEmpty()) {\r\n                        String eventId = snapshots.getDocuments().get(0).getId();\r\n                        Map<String, Object> updates = new HashMap<>();\r\n                        updates.put(\"eventLocation\", loc);\r\n                        updates.put(\"eventCapacity\", cap);\r\n                        updates.put(\"eventStartTime\", start);\r\n                        updates.put(\"waitlistCount\", 0);\r\n                        updates.put(\"waitingListLimit\", wlLimit);\r\n                        if (qrCheckBox.isChecked()) updates.put(\"qrCodeHash\", eventId);\r\n\r\n                        DbManager.getInstance().getDb().collection(\"events\").document(eventId).set(updates, SetOptions.merge());\r\n\r\n                        if (posterUri != null) DbManager.getInstance().uploadEventPoster(eventId, posterUri);\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void setupPickers() {\r\n        makeReadOnly(eventDateField); makeReadOnly(eventTimeField);\r\n        makeReadOnly(regStartDateField); makeReadOnly(regEndDateField);\r\n        eventDateField.setOnClickListener(v -> showDate(eventCalendar, eventDateField));\r\n        eventTimeField.setOnClickListener(v -> showTime(eventCalendar, eventTimeField));\r\n        regStartDateField.setOnClickListener(v -> showDate(regStartCalendar, regStartDateField));\r\n        regEndDateField.setOnClickListener(v -> showDate(regEndCalendar, regEndDateField));\r\n    }\r\n    private void makeReadOnly(EditText et) { et.setFocusable(false); et.setClickable(true); }\r\n    private void showDate(Calendar cal, EditText et) {\r\n        new DatePickerDialog(getContext(), (v, y, m, d) -> {\r\n            cal.set(Calendar.YEAR, y); cal.set(Calendar.MONTH, m); cal.set(Calendar.DAY_OF_MONTH, d);\r\n            et.setText(dateFmt.format(cal.getTime()));\r\n        }, cal.get(Calendar.YEAR), cal.get(Calendar.MONTH), cal.get(Calendar.DAY_OF_MONTH)).show();\r\n    }\r\n    private void showTime(Calendar cal, EditText et) {\r\n        new TimePickerDialog(getContext(), (v, h, m) -> {\r\n            cal.set(Calendar.HOUR_OF_DAY, h); cal.set(Calendar.MINUTE, m);\r\n            et.setText(timeFmt.format(cal.getTime()));\r\n        }, cal.get(Calendar.HOUR_OF_DAY), cal.get(Calendar.MINUTE), true).show();\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNewEventFragment.java b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNewEventFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNewEventFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNewEventFragment.java	(date 1764449277205)
@@ -4,6 +4,7 @@
 import android.app.TimePickerDialog;
 import android.net.Uri;
 import android.os.Bundle;
+import android.provider.Settings;
 import android.text.TextUtils;
 import android.view.LayoutInflater;
 import android.view.View;
@@ -36,7 +37,8 @@
 
 public class OrganizerNewEventFragment extends Fragment {
 
-    private EditText eventTitleField, eventLimitField, eventAddressField, eventCityField, eventProvinceField, eventDescriptionField;
+    // Added eventCapacityField to the list
+    private EditText eventTitleField, eventLimitField, eventCapacityField, eventAddressField, eventCityField, eventProvinceField, eventDescriptionField;
     private EditText eventDateField, eventTimeField, regStartDateField, regEndDateField;
     private CheckBox qrCheckBox;
     private Button createButton, uploadPosterButton;
@@ -74,15 +76,19 @@
         super.onViewCreated(view, savedInstanceState);
 
         eventTitleField = view.findViewById(R.id.edit_event_title);
-        eventLimitField = view.findViewById(R.id.edit_limit);
+        eventCapacityField = view.findViewById(R.id.edit_capacity); // Bind the Capacity box
+        eventLimitField = view.findViewById(R.id.edit_limit);       // Bind the Waitlist Limit box
+
         eventAddressField = view.findViewById(R.id.edit_address);
         eventCityField = view.findViewById(R.id.edit_city);
         eventProvinceField = view.findViewById(R.id.edit_province);
         eventDescriptionField = view.findViewById(R.id.edit_description);
+
         eventDateField = view.findViewById(R.id.edit_date);
         eventTimeField = view.findViewById(R.id.edit_time);
         regStartDateField = view.findViewById(R.id.edit_registration_start);
         regEndDateField = view.findViewById(R.id.edit_registration_end);
+
         qrCheckBox = view.findViewById(R.id.checkbox_qr);
         createButton = view.findViewById(R.id.button_create);
         uploadPosterButton = view.findViewById(R.id.button_upload_poster);
@@ -97,15 +103,20 @@
     private void saveEvent(View view) {
         String title = eventTitleField.getText().toString().trim();
         String desc = eventDescriptionField.getText().toString().trim();
+
+        // 1. Get Capacity (Attendees)
+        String capStr = eventCapacityField.getText().toString().trim();
+        int capacity = capStr.isEmpty() ? 0 : Integer.parseInt(capStr);
+
+        // 2. Get Waitlist Limit (Queue)
         String limitStr = eventLimitField.getText().toString().trim();
+        int waitlistLimit = limitStr.isEmpty() ? 0 : Integer.parseInt(limitStr);
 
         if (TextUtils.isEmpty(title)) {
             Toast.makeText(getContext(), "Title is required", Toast.LENGTH_SHORT).show();
             return;
         }
 
-        int waitlistLimit = limitStr.isEmpty() ? 0 : Integer.parseInt(limitStr);
-        int capacity = 100;
         String location = eventAddressField.getText().toString() + ", " + eventCityField.getText().toString();
         String organizerId = (currentUser != null) ? currentUser.getUserId() : "unknown";
 
@@ -119,38 +130,52 @@
                 );
                 if (getActivity() != null) {
                     task.addOnSuccessListener(getActivity(), aVoid -> {
+                        // Pass both distinct numbers: capacity AND waitlistLimit
                         findLastEventAndFillDetails(title, organizerId, location, capacity, waitlistLimit, eventCalendar.getTime(), posterImageUri);
                         Toast.makeText(getContext(), "Event Created!", Toast.LENGTH_SHORT).show();
                         Navigation.findNavController(view).navigateUp();
                     }).addOnFailureListener(getActivity(), e -> {
                         createButton.setEnabled(true);
                         createButton.setText("CREATE");
+                        Toast.makeText(getContext(), "Failed: " + e.getMessage(), Toast.LENGTH_SHORT).show();
                     });
                 }
             } catch (Exception e) {
-                // ignore
+                if (getActivity() != null) {
+                    getActivity().runOnUiThread(() -> {
+                        createButton.setEnabled(true);
+                        createButton.setText("CREATE");
+                    });
+                }
             }
         }).start();
     }
 
     private void findLastEventAndFillDetails(String title, String orgId, String loc, int cap, int wlLimit, Date start, @Nullable Uri posterUri) {
         DbManager.getInstance().getDb().collection("events")
-                .whereEqualTo("eventName", title).whereEqualTo("organizerId", orgId).limit(1)
+                .whereEqualTo("eventName", title)
+                .whereEqualTo("organizerId", orgId)
+                .limit(1)
                 .get()
                 .addOnSuccessListener(snapshots -> {
                     if (!snapshots.isEmpty()) {
                         String eventId = snapshots.getDocuments().get(0).getId();
                         Map<String, Object> updates = new HashMap<>();
                         updates.put("eventLocation", loc);
-                        updates.put("eventCapacity", cap);
+                        updates.put("eventCapacity", cap);        // Saved as eventCapacity
+                        updates.put("waitingListLimit", wlLimit); // Saved as waitingListLimit (Your Story)
                         updates.put("eventStartTime", start);
                         updates.put("waitlistCount", 0);
-                        updates.put("waitingListLimit", wlLimit);
-                        if (qrCheckBox.isChecked()) updates.put("qrCodeHash", eventId);
+
+                        if (qrCheckBox.isChecked()) {
+                            updates.put("qrCodeHash", eventId);
+                        }
 
                         DbManager.getInstance().getDb().collection("events").document(eventId).set(updates, SetOptions.merge());
 
-                        if (posterUri != null) DbManager.getInstance().uploadEventPoster(eventId, posterUri);
+                        if (posterUri != null) {
+                            DbManager.getInstance().uploadEventPoster(eventId, posterUri);
+                        }
                     }
                 });
     }
Index: app/src/androidTest/java/com/example/magpie_wingman/DbManagerInstrumentedTest.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman;\r\n\r\nimport static org.junit.Assert.assertEquals;\r\nimport static org.junit.Assert.assertFalse;\r\nimport static org.junit.Assert.assertNotNull;\r\nimport static org.junit.Assert.assertTrue;\r\n\r\nimport android.content.Context;\r\n\r\nimport androidx.test.core.app.ApplicationProvider;\r\nimport androidx.test.ext.junit.runners.AndroidJUnit4;\r\n\r\nimport com.example.magpie_wingman.data.DbManager;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.gms.tasks.Tasks;\r\nimport com.google.firebase.Timestamp;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.QuerySnapshot;\r\n\r\nimport org.junit.Test;\r\nimport org.junit.runner.RunWith;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\nimport java.util.concurrent.TimeUnit;\r\n\r\n@RunWith(AndroidJUnit4.class)\r\npublic class DbManagerInstrumentedTest {\r\n\r\n    @Test\r\n    public void dbManager_initializes() {\r\n        Context ctx = ApplicationProvider.getApplicationContext();\r\n        assertNotNull(ctx);\r\n\r\n        DbManager dbm = DbManager.getInstance();\r\n        assertNotNull(dbm);\r\n\r\n        FirebaseFirestore db = dbm.getDb();\r\n        assertNotNull(db);\r\n    }\r\n\r\n    @Test\r\n    public void createUser_writesAllFields() throws Exception {\r\n        // arrange\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String name = \"Test User\";\r\n\r\n        String email = \"test_user_\" + System.currentTimeMillis() + \"@example.com\";\r\n        String phone = \"555-0000\";\r\n\r\n\r\n        Task<Void> writeTask = dbm.createUser(name, email, phone);\r\n\r\n        Tasks.await(writeTask, 10, TimeUnit.SECONDS);\r\n\r\n\r\n        Task<QuerySnapshot> queryTask = db.collection(\"users\")\r\n                .whereEqualTo(\"email\", email)\r\n                .get();\r\n\r\n        QuerySnapshot qs = Tasks.await(queryTask, 10, TimeUnit.SECONDS);\r\n        assertNotNull(qs);\r\n        List<DocumentSnapshot> docs = qs.getDocuments();\r\n        assertTrue(\"Expected at least 1 user doc with this email\", docs.size() >= 1);\r\n\r\n\r\n        DocumentSnapshot doc = docs.get(0);\r\n        assertNotNull(doc);\r\n        assertTrue(doc.exists());\r\n\r\n\r\n        assertEquals(name, doc.getString(\"name\"));\r\n        assertEquals(email, doc.getString(\"email\"));\r\n        assertEquals(phone, doc.getString(\"phone\"));\r\n\r\n        Boolean isOrganizer = doc.getBoolean(\"isOrganizer\");\r\n        assertNotNull(isOrganizer);\r\n        assertTrue(isOrganizer);\r\n\r\n\r\n        String userId = doc.getString(\"userId\");\r\n        assertNotNull(\"userId should be written in the doc\", userId);\r\n\r\n        assertTrue(\"userId should contain '#'\", userId.contains(\"#\"));\r\n    }\r\n\r\n\r\n    @Test\r\n    public void createEvent_writesAllFields() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String eventName = \"Magpie Meetup \" + System.currentTimeMillis();\r\n        String description = \"Test description for magpie meetup\";\r\n        String organizerId = \"stuart#1234\";  // can be any existing/placeholder user id\r\n        Date regStart = \"2025-11-01\";\r\n        String regEnd = \"2025-11-05\";\r\n\r\n        Tasks.await(\r\n                dbm.createEvent(\r\n                        eventName,\r\n                        description,\r\n                        organizerId,\r\n                        regStart,\r\n                        regEnd\r\n                ),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        QuerySnapshot qs = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        assertNotNull(qs);\r\n        assertTrue(\"Expected at least 1 event with this name\", qs.getDocuments().size() >= 1);\r\n\r\n        DocumentSnapshot doc = qs.getDocuments().get(0);\r\n        assertNotNull(doc);\r\n        assertTrue(doc.exists());\r\n\r\n        assertEquals(eventName, doc.getString(\"eventName\"));\r\n        assertEquals(description, doc.getString(\"description\"));\r\n        assertEquals(organizerId, doc.getString(\"organizerId\"));\r\n        assertEquals(regStart, doc.get(\"registrationStart\"));\r\n        assertEquals(regEnd, doc.get(\"registrationEnd\"));\r\n\r\n        String eventId = doc.getString(\"eventId\");\r\n        assertNotNull(\"eventId should be stored\", eventId);\r\n        assertTrue(\"eventId should contain '#'\", eventId.contains(\"#\"));\r\n    }\r\n    @Test\r\n    public void addUserToWaitlist_createsSubdoc() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        //create a user\r\n        String userEmail = \"waitlist_user_\" + System.currentTimeMillis() + \"@example.com\";\r\n        String userName = \"Waitlist User\";\r\n        String userPhone = \"555-2222\";\r\n\r\n        Tasks.await(\r\n                dbm.createUser(userName, userEmail, userPhone),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // find the userId we just created\r\n        QuerySnapshot userQs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", userEmail)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        assertNotNull(userQs);\r\n        assertTrue(userQs.getDocuments().size() >= 1);\r\n        DocumentSnapshot userDoc = userQs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n        assertNotNull(userId);\r\n\r\n        // 2) create an event\r\n        String eventName = \"Waitlist Test Event \" + System.currentTimeMillis();\r\n        String description = \"Event to test waitlist\";\r\n        String organizerId = \"organizer#0001\";\r\n        String regStart = \"2025-11-01\";\r\n        String regEnd = \"2025-11-02\";\r\n\r\n        Tasks.await(\r\n                dbm.createEvent(eventName, description, organizerId, regStart, regEnd),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // find the eventId we just created\r\n        QuerySnapshot eventQs = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        assertNotNull(eventQs);\r\n        assertTrue(eventQs.getDocuments().size() >= 1);\r\n        DocumentSnapshot eventDoc = eventQs.getDocuments().get(0);\r\n        String eventId = eventDoc.getString(\"eventId\");\r\n        assertNotNull(eventId);\r\n\r\n        // 3) add user to waitlist\r\n        Tasks.await(\r\n                dbm.addUserToWaitlist(eventId, userId),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // 4) assert the subdoc exists\r\n        DocumentSnapshot wlDoc = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"waitlist\")\r\n                        .document(userId)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        assertNotNull(wlDoc);\r\n        assertTrue(\"waitlist doc should exist\", wlDoc.exists());\r\n        assertEquals(userId, wlDoc.getString(\"userId\"));\r\n    }\r\n\r\n    @Test\r\n    public void drawInvitees_movesRequestedNumber() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // 1) create event\r\n        String eventName = \"Sampling Event \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(\r\n                        eventName,\r\n                        \"sampling test\",\r\n                        \"organizer#0001\",\r\n                        \"2025-11-01\",\r\n                        \"2025-11-02\"\r\n                ),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // get eventId\r\n        QuerySnapshot eventQs = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot eventDoc = eventQs.getDocuments().get(0);\r\n        String eventId = eventDoc.getString(\"eventId\");\r\n        assertNotNull(eventId);\r\n\r\n        // 2) make 3 users and add them to waitlist\r\n        List<String> userIds = new ArrayList<>();\r\n        for (int i = 0; i < 3; i++) {\r\n            String email = \"wluser_\" + i + \"_\" + System.currentTimeMillis() + \"@example.com\";\r\n            Tasks.await(dbm.createUser(\"WL User \" + i, email, \"555-000\" + i), 10, TimeUnit.SECONDS);\r\n\r\n            QuerySnapshot userQs = Tasks.await(\r\n                    db.collection(\"users\")\r\n                            .whereEqualTo(\"email\", email)\r\n                            .get(),\r\n                    10, TimeUnit.SECONDS\r\n            );\r\n            DocumentSnapshot userDoc = userQs.getDocuments().get(0);\r\n            String userId = userDoc.getString(\"userId\");\r\n            assertNotNull(userId);\r\n            userIds.add(userId);\r\n\r\n            // add to waitlist\r\n            Tasks.await(dbm.addUserToWaitlist(eventId, userId), 10, TimeUnit.SECONDS);\r\n        }\r\n\r\n        // 3) promote 2 users from waitlist â†’ registrable\r\n        Tasks.await(dbm.drawInvitees(eventId, 2), 10, TimeUnit.SECONDS);\r\n\r\n        // 4) assert registrable has 2\r\n        QuerySnapshot registrableSnap = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registrable\")\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertNotNull(registrableSnap);\r\n        assertEquals(2, registrableSnap.size());\r\n\r\n        // 5) assert waitlist has 1 left\r\n        QuerySnapshot waitlistSnap = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"waitlist\")\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertNotNull(waitlistSnap);\r\n        assertEquals(1, waitlistSnap.size());\r\n    }\r\n\r\n    @Test\r\n    public void addUserToRegistered_movesFromRegistrable() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // 1) create event\r\n        String eventName = \"Register Flow \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(\r\n                        eventName,\r\n                        \"flow test\",\r\n                        \"organizer#0001\",\r\n                        \"2025-11-01\",\r\n                        \"2025-11-02\"\r\n                ),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        QuerySnapshot eventQs = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot eventDoc = eventQs.getDocuments().get(0);\r\n        String eventId = eventDoc.getString(\"eventId\");\r\n        assertNotNull(eventId);\r\n\r\n        // 2) create 1 user\r\n        String email = \"reg_user_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Reg User\", email, \"555-8888\"), 10, TimeUnit.SECONDS);\r\n\r\n        QuerySnapshot userQs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", email)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = userQs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n        assertNotNull(userId);\r\n\r\n        // 3) manually add to registrable (this simulates the user being invited)\r\n        Map<String, Object> regData = new HashMap<>();\r\n        regData.put(\"userId\", userId);\r\n        regData.put(\"invitedAt\", System.currentTimeMillis());\r\n\r\n        Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registrable\")\r\n                        .document(userId)\r\n                        .set(regData),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // 4) now move to registered using our helper\r\n        Tasks.await(dbm.addUserToRegistered(eventId, userId), 10, TimeUnit.SECONDS);\r\n\r\n        // 5) assert user is in registered\r\n        DocumentSnapshot registeredDoc = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registered\")\r\n                        .document(userId)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertNotNull(registeredDoc);\r\n        assertTrue(registeredDoc.exists());\r\n        assertEquals(userId, registeredDoc.getString(\"userId\"));\r\n\r\n        // 6) assert user is NOT in registrable anymore\r\n        DocumentSnapshot registrableDoc = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registrable\")\r\n                        .document(userId)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertNotNull(registrableDoc);\r\n        assertFalse(\"user should have been removed from registrable\", registrableDoc.exists());\r\n    }\r\n    @Test\r\n    public void deleteEvent_removesEventAndSubcollections() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // 1) create event\r\n        String eventName = \"Delete Me \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(\r\n                        eventName,\r\n                        \"to be deleted\",\r\n                        \"organizer#0001\",\r\n                        \"2025-11-01\",\r\n                        \"2025-11-02\"\r\n                ),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // fetch eventId\r\n        QuerySnapshot eventQs = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot eventDoc = eventQs.getDocuments().get(0);\r\n        String eventId = eventDoc.getString(\"eventId\");\r\n        assertNotNull(eventId);\r\n\r\n        // 2) create a user and put them in all 3 subcollections\r\n        String email = \"deleteme_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Delete User\", email, \"555-9999\"), 10, TimeUnit.SECONDS);\r\n\r\n        QuerySnapshot userQs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", email)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = userQs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n        assertNotNull(userId);\r\n\r\n        // add to waitlist\r\n        Tasks.await(dbm.addUserToWaitlist(eventId, userId), 10, TimeUnit.SECONDS);\r\n\r\n        // add to registrable (direct write)\r\n        Map<String, Object> regData = new HashMap<>();\r\n        regData.put(\"userId\", userId);\r\n        Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registrable\")\r\n                        .document(userId)\r\n                        .set(regData),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // add to registered (direct write)\r\n        Map<String, Object> regdData = new HashMap<>();\r\n        regdData.put(\"userId\", userId);\r\n        Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registered\")\r\n                        .document(userId)\r\n                        .set(regdData),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // 3) delete the event\r\n        Tasks.await(dbm.deleteEvent(eventId), 10, TimeUnit.SECONDS);\r\n\r\n        // 4) assert event gone\r\n        DocumentSnapshot afterDelete = Tasks.await(\r\n                db.collection(\"events\").document(eventId).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertFalse(\"event doc should be deleted\", afterDelete.exists());\r\n\r\n        // 5) assert subcollections empty (reads should return 0 docs)\r\n        QuerySnapshot wlAfter = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"waitlist\")\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertEquals(0, wlAfter.size());\r\n\r\n        QuerySnapshot regableAfter = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registrable\")\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertEquals(0, regableAfter.size());\r\n\r\n        QuerySnapshot regdAfter = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registered\")\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertEquals(0, regdAfter.size());\r\n    }\r\n    @Test\r\n    public void cancelWaitlist_removesUserFromWaitlist() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // create event\r\n        String eventName = \"Cancel WL \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(eventName, \"desc\", \"organizer#0001\", \"2025-11-01\", \"2025-11-02\"),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        QuerySnapshot evQs = Tasks.await(\r\n                db.collection(\"events\").whereEqualTo(\"eventName\", eventName).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        String eventId = evQs.getDocuments().get(0).getString(\"eventId\");\r\n\r\n        // create user\r\n        String email = \"wl_cancel_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"WL Cancel\", email, \"555-0000\"), 10, TimeUnit.SECONDS);\r\n        QuerySnapshot uQs = Tasks.await(\r\n                db.collection(\"users\").whereEqualTo(\"email\", email).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        String userId = uQs.getDocuments().get(0).getString(\"userId\");\r\n\r\n        // add to waitlist\r\n        Tasks.await(dbm.addUserToWaitlist(eventId, userId), 10, TimeUnit.SECONDS);\r\n\r\n        // cancel\r\n        Tasks.await(dbm.cancelWaitlist(eventId, userId), 10, TimeUnit.SECONDS);\r\n\r\n        // assert gone\r\n        DocumentSnapshot after = Tasks.await(\r\n                db.collection(\"events\").document(eventId)\r\n                        .collection(\"waitlist\").document(userId).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertFalse(after.exists());\r\n    }\r\n\r\n    @Test\r\n    public void cancelRegistrable_removesUserFromRegistrable() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String eventName = \"Cancel Regable \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(eventName, \"desc\", \"organizer#0001\", \"2025-11-01\", \"2025-11-02\"),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        QuerySnapshot evQs = Tasks.await(\r\n                db.collection(\"events\").whereEqualTo(\"eventName\", eventName).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        String eventId = evQs.getDocuments().get(0).getString(\"eventId\");\r\n\r\n        String email = \"regable_cancel_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Regable Cancel\", email, \"555-1111\"), 10, TimeUnit.SECONDS);\r\n        QuerySnapshot uQs = Tasks.await(\r\n                db.collection(\"users\").whereEqualTo(\"email\", email).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        String userId = uQs.getDocuments().get(0).getString(\"userId\");\r\n\r\n        // simulate \"registrable\"\r\n        Map<String, Object> regData = new HashMap<>();\r\n        regData.put(\"userId\", userId);\r\n        Tasks.await(\r\n                db.collection(\"events\").document(eventId)\r\n                        .collection(\"registrable\").document(userId)\r\n                        .set(regData),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // cancel\r\n        Tasks.await(dbm.cancelRegistrable(eventId, userId), 10, TimeUnit.SECONDS);\r\n\r\n        // assert gone\r\n        DocumentSnapshot after = Tasks.await(\r\n                db.collection(\"events\").document(eventId)\r\n                        .collection(\"registrable\").document(userId).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertFalse(after.exists());\r\n    }\r\n\r\n    @Test\r\n    public void cancelRegistered_removesUserFromRegistered() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String eventName = \"Cancel Registered \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(eventName, \"desc\", \"organizer#0001\", \"2025-11-01\", \"2025-11-02\"),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        QuerySnapshot evQs = Tasks.await(\r\n                db.collection(\"events\").whereEqualTo(\"eventName\", eventName).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        String eventId = evQs.getDocuments().get(0).getString(\"eventId\");\r\n\r\n        String email = \"regd_cancel_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Regd Cancel\", email, \"555-2222\"), 10, TimeUnit.SECONDS);\r\n        QuerySnapshot uQs = Tasks.await(\r\n                db.collection(\"users\").whereEqualTo(\"email\", email).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        String userId = uQs.getDocuments().get(0).getString(\"userId\");\r\n\r\n        // simulate \"registered\"\r\n        Map<String, Object> regdData = new HashMap<>();\r\n        regdData.put(\"userId\", userId);\r\n        Tasks.await(\r\n                db.collection(\"events\").document(eventId)\r\n                        .collection(\"registered\").document(userId)\r\n                        .set(regdData),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // cancel\r\n        Tasks.await(dbm.cancelRegistered(eventId, userId), 10, TimeUnit.SECONDS);\r\n\r\n        // assert gone\r\n        DocumentSnapshot after = Tasks.await(\r\n                db.collection(\"events\").document(eventId)\r\n                        .collection(\"registered\").document(userId).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertFalse(after.exists());\r\n    }\r\n    @Test\r\n    public void updateName_updatesUserNameField() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // 1) create user\r\n        String email = \"upname_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Original Name\", email, \"555-0000\"), 10, TimeUnit.SECONDS);\r\n\r\n        // 2) fetch userId\r\n        QuerySnapshot qs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", email)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = qs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n\r\n        // 3) update\r\n        Tasks.await(dbm.updateName(userId, \"New Name\"), 10, TimeUnit.SECONDS);\r\n\r\n        // 4) read back\r\n        DocumentSnapshot after = Tasks.await(\r\n                db.collection(\"users\").document(userId).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertEquals(\"New Name\", after.getString(\"name\"));\r\n    }\r\n\r\n    @Test\r\n    public void updateEmail_updatesUserEmailField() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String email = \"upemail_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Email User\", email, \"555-1111\"), 10, TimeUnit.SECONDS);\r\n\r\n        QuerySnapshot qs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", email)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = qs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n\r\n        String newEmail = \"updated_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.updateEmail(userId, newEmail), 10, TimeUnit.SECONDS);\r\n\r\n        DocumentSnapshot after = Tasks.await(\r\n                db.collection(\"users\").document(userId).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertEquals(newEmail, after.getString(\"email\"));\r\n    }\r\n\r\n    @Test\r\n    public void updatePhoneNumber_updatesUserPhoneField() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String email = \"upphone_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Phone User\", email, \"555-2222\"), 10, TimeUnit.SECONDS);\r\n\r\n        QuerySnapshot qs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", email)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = qs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n\r\n        String newPhone = \"780-555-4321\";\r\n        Tasks.await(dbm.updatePhoneNumber(userId, newPhone), 10, TimeUnit.SECONDS);\r\n\r\n        DocumentSnapshot after = Tasks.await(\r\n                db.collection(\"users\").document(userId).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertEquals(newPhone, after.getString(\"phone\"));\r\n    }\r\n    @Test\r\n    public void changeOrgPerms_updatesIsOrganizerField() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // create user\r\n        String email = \"orgperm_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Org Perm\", email, \"555-0000\"), 10, TimeUnit.SECONDS);\r\n\r\n        // get userId\r\n        QuerySnapshot qs = Tasks.await(\r\n                db.collection(\"users\").whereEqualTo(\"email\", email).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = qs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n\r\n        // change to false\r\n        Tasks.await(dbm.changeOrgPerms(userId, false), 10, TimeUnit.SECONDS);\r\n\r\n        // assert field updated\r\n        DocumentSnapshot after = Tasks.await(\r\n                db.collection(\"users\").document(userId).get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertEquals(false, after.getBoolean(\"isOrganizer\"));\r\n    }\r\n\r\n    @Test\r\n    public void getUserName_returnsCorrectName() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String email = \"getter_name_\" + System.currentTimeMillis() + \"@example.com\";\r\n\r\n        // create user\r\n        Tasks.await(\r\n                dbm.createUser(\"Test Name\", email, \"555-0000\"),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // find the userId we just created\r\n        QuerySnapshot qs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", email)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = qs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n\r\n        // call the getter\r\n        String name = Tasks.await(\r\n                dbm.getUserName(userId),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        assertEquals(\"Test Name\", name);\r\n    }\r\n    @Test\r\n    public void getUserEmail_returnsCorrectEmail() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String email = \"getter_email_\" + System.currentTimeMillis() + \"@example.com\";\r\n\r\n        Tasks.await(\r\n                dbm.createUser(\"Email User\", email, \"555-1111\"),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        QuerySnapshot qs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", email)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = qs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n\r\n        String fetchedEmail = Tasks.await(\r\n                dbm.getUserEmail(userId),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        assertEquals(email, fetchedEmail);\r\n    }\r\n\r\n    @Test\r\n    public void getUserPhone_returnsCorrectPhone() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String email = \"getter_phone_\" + System.currentTimeMillis() + \"@example.com\";\r\n        String phone = \"780-555-1234\";\r\n\r\n        Tasks.await(\r\n                dbm.createUser(\"Phone User\", email, phone),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        QuerySnapshot qs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", email)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = qs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n\r\n        String fetchedPhone = Tasks.await(\r\n                dbm.getUserPhone(userId),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        assertEquals(phone, fetchedPhone);\r\n    }\r\n\r\n    @Test\r\n    public void getIsOrganizer_updatesAfterChangeOrgPerms() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        String email = \"getter_org_change_\" + System.currentTimeMillis() + \"@example.com\";\r\n\r\n        // create user\r\n        Tasks.await(\r\n                dbm.createUser(\"Org Change User\", email, \"555-4444\"),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // retrieve the userId of the created user\r\n        QuerySnapshot qs = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", email)\r\n                        .get(),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        DocumentSnapshot userDoc = qs.getDocuments().get(0);\r\n        String userId = userDoc.getString(\"userId\");\r\n\r\n        // check initial isOrganizer value (should be true)\r\n        Boolean initial = Tasks.await(\r\n                dbm.getIsOrganizer(userId),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n        assertNotNull(\"isOrganizer should not be null\", initial);\r\n        assertTrue(\"isOrganizer should be true by default\", initial);\r\n\r\n        // change permission to false\r\n        Tasks.await(\r\n                dbm.changeOrgPerms(userId, false),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        // verify that it changed\r\n        Boolean afterChange = Tasks.await(\r\n                dbm.getIsOrganizer(userId),\r\n                10, TimeUnit.SECONDS\r\n        );\r\n\r\n        assertNotNull(\"isOrganizer after change should not be null\", afterChange);\r\n        assertFalse(\"isOrganizer should now be false after calling changeOrgPerms\", afterChange);\r\n    }\r\n    @Test\r\n    public void getEventDescription_returnsCorrectDescription() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // make an organizer first\r\n        String orgEmail = \"event_desc_org_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Event Org\", orgEmail, \"555-0000\"));\r\n        // get organizerId\r\n        DocumentSnapshot orgDoc = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", orgEmail)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String organizerId = orgDoc.getString(\"userId\");\r\n\r\n        String description = \"This is a test event description.\";\r\n        String eventName = \"Test Event \" + System.currentTimeMillis();\r\n\r\n        // create event\r\n        Tasks.await(\r\n                dbm.createEvent(\r\n                        eventName,\r\n                        description,\r\n                        organizerId,\r\n                        null,\r\n                        null\r\n                )\r\n        );\r\n\r\n        // find the event we just created by name\r\n        DocumentSnapshot eventDoc = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String eventId = eventDoc.getString(\"eventId\");\r\n\r\n        // now call our getter\r\n        String fetchedDesc = Tasks.await(\r\n                dbm.getEventDescription(eventId)\r\n        );\r\n\r\n        assertEquals(description, fetchedDesc);\r\n    }\r\n\r\n    @Test\r\n    public void getEventOrganizer_returnsOrganizerId() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // create organizer\r\n        String orgEmail = \"event_org_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Organizer Person\", orgEmail, \"555-1111\"));\r\n        DocumentSnapshot orgDoc = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", orgEmail)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String organizerId = orgDoc.getString(\"userId\");\r\n\r\n        // create event\r\n        String eventName = \"Org Event \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(\r\n                        eventName,\r\n                        \"org test\",\r\n                        organizerId,\r\n                        null,\r\n                        null\r\n                )\r\n        );\r\n\r\n        // fetch back the event to get its id\r\n        DocumentSnapshot eventDoc = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String eventId = eventDoc.getString(\"eventId\");\r\n\r\n        // call getter\r\n        String fetchedOrganizerId = Tasks.await(\r\n                dbm.getEventOrganizer(eventId)\r\n        );\r\n\r\n        assertEquals(organizerId, fetchedOrganizerId);\r\n    }\r\n\r\n    @Test\r\n    public void getEventRegistrationDates_returnWhatWeSaved() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // organizer\r\n        String orgEmail = \"event_dates_org_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Dates Org\", orgEmail, \"555-2222\"));\r\n        DocumentSnapshot orgDoc = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", orgEmail)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String organizerId = orgDoc.getString(\"userId\");\r\n\r\n        Date start = Timestamp.now();\r\n        // arbitrary end a minute later\r\n        Date end = new Timestamp(start.getSeconds() + 60, 0);\r\n\r\n        String eventName = \"Dates Event \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(\r\n                        eventName,\r\n                        \"event with dates\",\r\n                        organizerId,\r\n                        start,\r\n                        end\r\n                )\r\n        );\r\n\r\n        DocumentSnapshot eventDoc = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String eventId = eventDoc.getString(\"eventId\");\r\n\r\n        Object regStart = Tasks.await(dbm.getEventRegistrationStart(eventId));\r\n        Object regEnd = Tasks.await(dbm.getEventRegistrationEnd(eventId));\r\n\r\n        assertTrue(\"registrationStart should be a Timestamp\", regStart instanceof Timestamp);\r\n        assertTrue(\"registrationEnd should be a Timestamp\", regEnd instanceof Timestamp);\r\n\r\n        assertEquals(start, regStart);\r\n        assertEquals(end, regEnd);\r\n    }\r\n\r\n    @Test\r\n    public void getEventWaitlist_returnsAllUsers() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // organizer\r\n        String orgEmail = \"waitlist_org_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Waitlist Org\", orgEmail, \"555-3333\"));\r\n        DocumentSnapshot orgDoc = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", orgEmail)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String organizerId = orgDoc.getString(\"userId\");\r\n\r\n        // event\r\n        String eventName = \"Waitlist Event \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(eventName, \"wl test\", organizerId, null, null)\r\n        );\r\n        DocumentSnapshot eventDoc = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String eventId = eventDoc.getString(\"eventId\");\r\n\r\n        // make two entrants\r\n        String email1 = \"wl_user1_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Wl User 1\", email1, \"555-4001\"));\r\n        DocumentSnapshot u1 = Tasks.await(\r\n                db.collection(\"users\").whereEqualTo(\"email\", email1).get()\r\n        ).getDocuments().get(0);\r\n        String userId1 = u1.getString(\"userId\");\r\n\r\n        String email2 = \"wl_user2_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Wl User 2\", email2, \"555-4002\"));\r\n        DocumentSnapshot u2 = Tasks.await(\r\n                db.collection(\"users\").whereEqualTo(\"email\", email2).get()\r\n        ).getDocuments().get(0);\r\n        String userId2 = u2.getString(\"userId\");\r\n\r\n        // add both to waitlist\r\n        Tasks.await(dbm.addUserToWaitlist(eventId, userId1));\r\n        Tasks.await(dbm.addUserToWaitlist(eventId, userId2));\r\n\r\n        // now get waitlist\r\n        List<String> waitlist = Tasks.await(\r\n                dbm.getEventWaitlist(eventId)\r\n        );\r\n\r\n        assertTrue(waitlist.contains(userId1));\r\n        assertTrue(waitlist.contains(userId2));\r\n    }\r\n\r\n    @Test\r\n    public void getEventRegistered_returnsAllUsers() throws Exception {\r\n        DbManager dbm = DbManager.getInstance();\r\n        FirebaseFirestore db = dbm.getDb();\r\n\r\n        // organizer\r\n        String orgEmail = \"reg_org_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Reg Org\", orgEmail, \"555-5555\"));\r\n        DocumentSnapshot orgDoc = Tasks.await(\r\n                db.collection(\"users\")\r\n                        .whereEqualTo(\"email\", orgEmail)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String organizerId = orgDoc.getString(\"userId\");\r\n\r\n        // event\r\n        String eventName = \"Reg Event \" + System.currentTimeMillis();\r\n        Tasks.await(\r\n                dbm.createEvent(eventName, \"reg test\", organizerId, null, null)\r\n        );\r\n        DocumentSnapshot eventDoc = Tasks.await(\r\n                db.collection(\"events\")\r\n                        .whereEqualTo(\"eventName\", eventName)\r\n                        .get()\r\n        ).getDocuments().get(0);\r\n        String eventId = eventDoc.getString(\"eventId\");\r\n\r\n        // make two entrants\r\n        String email1 = \"reg_user1_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Reg User 1\", email1, \"555-6001\"));\r\n        DocumentSnapshot u1 = Tasks.await(\r\n                db.collection(\"users\").whereEqualTo(\"email\", email1).get()\r\n        ).getDocuments().get(0);\r\n        String userId1 = u1.getString(\"userId\");\r\n\r\n        String email2 = \"reg_user2_\" + System.currentTimeMillis() + \"@example.com\";\r\n        Tasks.await(dbm.createUser(\"Reg User 2\", email2, \"555-6002\"));\r\n        DocumentSnapshot u2 = Tasks.await(\r\n                db.collection(\"users\").whereEqualTo(\"email\", email2).get()\r\n        ).getDocuments().get(0);\r\n        String userId2 = u2.getString(\"userId\");\r\n\r\n        // add both to registered\r\n        Tasks.await(dbm.addUserToRegistered(eventId, userId1));\r\n        Tasks.await(dbm.addUserToRegistered(eventId, userId2));\r\n\r\n        // now get registered list\r\n        List<String> registered = Tasks.await(\r\n                dbm.getEventRegistered(eventId)\r\n        );\r\n\r\n        assertTrue(registered.contains(userId1));\r\n        assertTrue(registered.contains(userId2));\r\n    }\r\n\r\n    }
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/androidTest/java/com/example/magpie_wingman/DbManagerInstrumentedTest.java b/app/src/androidTest/java/com/example/magpie_wingman/DbManagerInstrumentedTest.java
--- a/app/src/androidTest/java/com/example/magpie_wingman/DbManagerInstrumentedTest.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/androidTest/java/com/example/magpie_wingman/DbManagerInstrumentedTest.java	(date 1764449277197)
@@ -30,6 +30,9 @@
 
 @RunWith(AndroidJUnit4.class)
 public class DbManagerInstrumentedTest {
+    private static final Double TEST_LAT = 53.5461;
+    private static final Double TEST_LNG = -113.4938;
+
 
     @Test
     public void dbManager_initializes() {
@@ -194,7 +197,7 @@
 
         // 3) add user to waitlist
         Tasks.await(
-                dbm.addUserToWaitlist(eventId, userId),
+                dbm.addUserToWaitlist(eventId, userId, TEST_LAT, TEST_LNG),
                 10, TimeUnit.SECONDS
         );
 
@@ -260,7 +263,7 @@
             userIds.add(userId);
 
             // add to waitlist
-            Tasks.await(dbm.addUserToWaitlist(eventId, userId), 10, TimeUnit.SECONDS);
+            Tasks.await(dbm.addUserToWaitlist(eventId, userId,TEST_LAT, TEST_LNG), 10, TimeUnit.SECONDS);
         }
 
         // 3) promote 2 users from waitlist â†’ registrable
@@ -417,7 +420,7 @@
         assertNotNull(userId);
 
         // add to waitlist
-        Tasks.await(dbm.addUserToWaitlist(eventId, userId), 10, TimeUnit.SECONDS);
+        Tasks.await(dbm.addUserToWaitlist(eventId, userId, TEST_LAT, TEST_LNG), 10, TimeUnit.SECONDS);
 
         // add to registrable (direct write)
         Map<String, Object> regData = new HashMap<>();
@@ -508,7 +511,7 @@
         String userId = uQs.getDocuments().get(0).getString("userId");
 
         // add to waitlist
-        Tasks.await(dbm.addUserToWaitlist(eventId, userId), 10, TimeUnit.SECONDS);
+        Tasks.await(dbm.addUserToWaitlist(eventId, userId, TEST_LAT, TEST_LNG), 10, TimeUnit.SECONDS);
 
         // cancel
         Tasks.await(dbm.cancelWaitlist(eventId, userId), 10, TimeUnit.SECONDS);
@@ -1039,8 +1042,8 @@
         String userId2 = u2.getString("userId");
 
         // add both to waitlist
-        Tasks.await(dbm.addUserToWaitlist(eventId, userId1));
-        Tasks.await(dbm.addUserToWaitlist(eventId, userId2));
+        Tasks.await(dbm.addUserToWaitlist(eventId, userId1, TEST_LAT, TEST_LNG));
+        Tasks.await(dbm.addUserToWaitlist(eventId, userId2, TEST_LAT, TEST_LNG));
 
         // now get waitlist
         List<String> waitlist = Tasks.await(
Index: app/src/main/java/com/example/magpie_wingman/entrant/DetailedEventDescriptionFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.entrant;\r\n\r\nimport android.os.Bundle;\r\nimport android.text.TextUtils;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.navigation.NavController;\r\nimport androidx.navigation.Navigation;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.example.magpie_wingman.MyApp;\r\nimport com.example.magpie_wingman.R;\r\nimport com.example.magpie_wingman.data.DbManager;\r\nimport com.example.magpie_wingman.data.model.Event;\r\nimport com.example.magpie_wingman.data.model.User;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.Date;\r\nimport java.util.Locale;\r\n\r\n/**\r\n * Fragment that displays the full details of a single event for entrant users.\r\n *\r\n *  Implemented functionality\r\n *  - Poster image only show when URL exists, otherwise hide\r\n *  - QR flow\r\n *  - Waitlist / invitation / registration logic\r\n */\r\npublic class DetailedEventDescriptionFragment extends Fragment {\r\n\r\n    // Argument keys used when constructing this fragment with a Bundle.\r\n    private static final String ARG_EVENT_ID          = \"eventId\";\r\n    private static final String ARG_EVENT_NAME        = \"eventName\";\r\n    private static final String ARG_EVENT_LOCATION    = \"eventLocation\";\r\n    private static final String ARG_EVENT_START_TIME  = \"eventStartTime\";\r\n    private static final String ARG_EVENT_DESCRIPTION = \"eventDescription\";\r\n    private static final String ARG_EVENT_POSTER_URL  = \"eventPosterURL\";\r\n\r\n    // Membership states for the current entrant\r\n    private enum MembershipState {\r\n        NONE,          // not in any list\r\n        WAITLIST,      // in waitlist\r\n        INVITED,       // in invited\r\n        REGISTRABLE,   // in registrable\r\n        REGISTERED     // in registered\r\n    }\r\n\r\n    // Event and user identifiers.\r\n    private String eventId;\r\n    private String eventPosterUrl;\r\n    private String entrantId;\r\n\r\n    // Basic event details passed through arguments.\r\n    private String eventName;\r\n    private String eventLocation;\r\n    private long   eventStartTimeMillis = -1L;\r\n    private String eventDescription;\r\n\r\n    // UI references.\r\n    private TextView titleText;\r\n    private TextView locationText;\r\n    private TextView dateText;\r\n    private TextView descriptionText;\r\n    private TextView textWaitingList;\r\n    private ImageView posterImage;\r\n    private Button   joinButton;\r\n\r\n    // Membership + waitlist info\r\n    private MembershipState membershipState = MembershipState.NONE;\r\n    private int waitlistCount = 0;\r\n\r\n    // Formatter used to show the event date and time.\r\n    private final SimpleDateFormat dateFormat =\r\n            new SimpleDateFormat(\"MMM dd - hh:mm a\", Locale.getDefault());\r\n\r\n    public DetailedEventDescriptionFragment() {\r\n        // Required empty constructor\r\n    }\r\n\r\n    /**\r\n     * Convenience factory method for creating a new instance of this fragment\r\n     * with the given event details bundled as arguments.\r\n     */\r\n    public static DetailedEventDescriptionFragment newInstance(String eventId,\r\n                                                               String eventName,\r\n                                                               String eventLocation,\r\n                                                               long eventStartTime,\r\n                                                               String description,\r\n                                                               @Nullable String posterUrl) {\r\n        DetailedEventDescriptionFragment fragment = new DetailedEventDescriptionFragment();\r\n        Bundle args = new Bundle();\r\n        args.putString(ARG_EVENT_ID, eventId);\r\n        args.putString(ARG_EVENT_NAME, eventName);\r\n        args.putString(ARG_EVENT_LOCATION, eventLocation);\r\n        args.putLong(ARG_EVENT_START_TIME, eventStartTime);\r\n        args.putString(ARG_EVENT_DESCRIPTION, description);\r\n        args.putString(ARG_EVENT_POSTER_URL, posterUrl);\r\n        fragment.setArguments(args);\r\n        return fragment;\r\n    }\r\n\r\n    @Override\r\n    public void onCreate(@Nullable Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n\r\n        // Read args if present (normal navigation).\r\n        Bundle args = getArguments();\r\n        if (args != null) {\r\n            eventId              = args.getString(ARG_EVENT_ID);\r\n            eventName            = args.getString(ARG_EVENT_NAME);\r\n            eventLocation        = args.getString(ARG_EVENT_LOCATION);\r\n            eventStartTimeMillis = args.getLong(ARG_EVENT_START_TIME, -1L);\r\n            eventDescription     = args.getString(ARG_EVENT_DESCRIPTION);\r\n            eventPosterUrl       = args.getString(ARG_EVENT_POSTER_URL);\r\n        }\r\n\r\n        // Current user (entrant)\r\n        User current = MyApp.getInstance().getCurrentUser();\r\n        if (current != null) {\r\n            entrantId = current.getUserId();\r\n        } else {\r\n            entrantId = \"test_user_id\";\r\n        }\r\n    }\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater,\r\n                             @Nullable ViewGroup container,\r\n                             @Nullable Bundle savedInstanceState) {\r\n        return inflater.inflate(R.layout.fragment_detailed_event_description, container, false);\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(@NonNull View v, @Nullable Bundle savedInstanceState) {\r\n        super.onViewCreated(v, savedInstanceState);\r\n\r\n        // Bind UI\r\n        ImageButton backButton = v.findViewById(R.id.button_back);\r\n        posterImage            = v.findViewById(R.id.image_event_poster);\r\n        titleText              = v.findViewById(R.id.text_event_title);\r\n        locationText           = v.findViewById(R.id.text_event_location);\r\n        dateText               = v.findViewById(R.id.text_event_date);\r\n        textWaitingList        = v.findViewById(R.id.text_waiting_list);\r\n        descriptionText        = v.findViewById(R.id.text_event_description);\r\n        joinButton             = v.findViewById(R.id.button_join_waitlist);\r\n\r\n        // Use whatever data we already have from arguments\r\n        bindStaticDetailsFromArgs();\r\n\r\n        // back navigation\r\n        backButton.setOnClickListener(view -> {\r\n            NavController navController = Navigation.findNavController(view);\r\n            navController.popBackStack();\r\n        });\r\n\r\n        // missing IDs\r\n        if (eventId == null || entrantId == null) {\r\n            joinButton.setEnabled(false);\r\n            Toast.makeText(\r\n                    requireContext(),\r\n                    \"Missing event or user information; cannot join.\",\r\n                    Toast.LENGTH_LONG\r\n            ).show();\r\n            return;\r\n        }\r\n\r\n        // fetch fresh details from Firestore by eventId\r\n        loadEventDetailsFromFirestore();\r\n\r\n        // load membership & waitlist info\r\n        loadMembershipStateAndCount();\r\n\r\n        // main button behavior\r\n        joinButton.setOnClickListener(v1 -> toggleJoinLeave());\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Initial binding from args\r\n    // -------------------------------------------------------------------------\r\n\r\n    private void bindStaticDetailsFromArgs() {\r\n        // if poster\r\n        if (!TextUtils.isEmpty(eventPosterUrl)) {\r\n            posterImage.setVisibility(View.VISIBLE);\r\n            Glide.with(this)\r\n                    .load(eventPosterUrl)\r\n                    .into(posterImage);\r\n        } else {\r\n            // No poster\r\n            posterImage.setVisibility(View.GONE);\r\n        }\r\n\r\n        // Title\r\n        titleText.setText(\r\n                !TextUtils.isEmpty(eventName) ? eventName : \"Event\"\r\n        );\r\n\r\n        // Location\r\n        locationText.setText(\r\n                !TextUtils.isEmpty(eventLocation) ? eventLocation : \"Location TBD\"\r\n        );\r\n\r\n        // Date/Time\r\n        if (eventStartTimeMillis > 0L) {\r\n            dateText.setText(dateFormat.format(new Date(eventStartTimeMillis)));\r\n        } else {\r\n            dateText.setText(\"Date TBD\");\r\n        }\r\n\r\n        // Description\r\n        if (!TextUtils.isEmpty(eventDescription)) {\r\n            descriptionText.setText(eventDescription);\r\n        }\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Firestore reload\r\n    // -------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Fetches fresh event details from Firestore using the eventId.\r\n     * This is important when we navigated here by QR and only had the ID.\r\n     */\r\n    private void loadEventDetailsFromFirestore() {\r\n        if (TextUtils.isEmpty(eventId)) return;\r\n\r\n        DbManager.getInstance()\r\n                .getDb()\r\n                .collection(\"events\")\r\n                .document(eventId)\r\n                .get()\r\n                .addOnSuccessListener(documentSnapshot -> {\r\n                    Event event = documentSnapshot.toObject(Event.class);\r\n                    if (event == null) return;\r\n\r\n                    // Update fields only if missing or generic placeholders\r\n                    if (TextUtils.isEmpty(eventName) ||\r\n                            \"Event\".contentEquals(titleText.getText())) {\r\n                        eventName = event.getEventName();\r\n                        if (!TextUtils.isEmpty(eventName)) {\r\n                            titleText.setText(eventName);\r\n                        }\r\n                    }\r\n\r\n                    if (TextUtils.isEmpty(eventLocation) ||\r\n                            \"Location TBD\".contentEquals(locationText.getText())) {\r\n                        eventLocation = event.getEventLocation();\r\n                        if (!TextUtils.isEmpty(eventLocation)) {\r\n                            locationText.setText(eventLocation);\r\n                        }\r\n                    }\r\n\r\n                    if (event.getEventStartTime() != null) {\r\n                        eventStartTimeMillis = event.getEventStartTime().getTime();\r\n                        dateText.setText(dateFormat.format(event.getEventStartTime()));\r\n                    }\r\n\r\n                    eventDescription = event.getDescription();\r\n                    if (!TextUtils.isEmpty(eventDescription)) {\r\n                        descriptionText.setText(eventDescription);\r\n                    }\r\n\r\n                    // Poster: if we didn't get one from args, use Firestore value\r\n                    if (TextUtils.isEmpty(eventPosterUrl)) {\r\n                        String fromDb = event.getEventPosterURL();\r\n                        if (!TextUtils.isEmpty(fromDb) && getContext() != null) {\r\n                            eventPosterUrl = fromDb;\r\n                            posterImage.setVisibility(View.VISIBLE);\r\n                            Glide.with(getContext())\r\n                                    .load(eventPosterUrl)\r\n                                    .into(posterImage);\r\n                        } else {\r\n                            // Still no URL â†’ keep it hidden\r\n                            posterImage.setVisibility(View.GONE);\r\n                        }\r\n                    }\r\n                });\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Membership + waitlist logic\r\n    // -------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Loads:\r\n     *  - which list the user is in (waitlist, invited, registrable, registered)\r\n     *  - the current waitlist count\r\n     */\r\n    private void loadMembershipStateAndCount() {\r\n        refreshMembershipState();\r\n\r\n        // Waitlist size for display\r\n        DbManager.getInstance()\r\n                .getEventWaitlist(eventId)\r\n                .addOnSuccessListener(users -> {\r\n                    waitlistCount = (users != null) ? users.size() : 0;\r\n                    renderWaitlistCount();\r\n                });\r\n    }\r\n\r\n    private void refreshMembershipState() {\r\n        if (TextUtils.isEmpty(eventId) || TextUtils.isEmpty(entrantId)) return;\r\n\r\n        FirebaseFirestore db = DbManager.getInstance().getDb();\r\n\r\n        // Highest priority: registered\r\n        db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"registered\")\r\n                .document(entrantId)\r\n                .get()\r\n                .addOnSuccessListener(regDoc -> {\r\n                    if (regDoc.exists()) {\r\n                        membershipState = MembershipState.REGISTERED;\r\n                        renderJoinButton();\r\n                    } else {\r\n                        // Next: registrable\r\n                        checkRegistrable(db);\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void checkRegistrable(FirebaseFirestore db) {\r\n        db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"registrable\")\r\n                .document(entrantId)\r\n                .get()\r\n                .addOnSuccessListener(regableDoc -> {\r\n                    if (regableDoc.exists()) {\r\n                        membershipState = MembershipState.REGISTRABLE;\r\n                        renderJoinButton();\r\n                    } else {\r\n                        // Next: invited\r\n                        checkInvited(db);\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void checkInvited(FirebaseFirestore db) {\r\n        db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"invited\")\r\n                .document(entrantId)\r\n                .get()\r\n                .addOnSuccessListener(invitedDoc -> {\r\n                    if (invitedDoc.exists()) {\r\n                        membershipState = MembershipState.INVITED;\r\n                        renderJoinButton();\r\n                    } else {\r\n                        // Finally: waitlist\r\n                        DbManager.getInstance()\r\n                                .isUserInWaitlist(eventId, entrantId)\r\n                                .addOnSuccessListener(isIn -> {\r\n                                    membershipState = Boolean.TRUE.equals(isIn)\r\n                                            ? MembershipState.WAITLIST\r\n                                            : MembershipState.NONE;\r\n                                    renderJoinButton();\r\n                                });\r\n                    }\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Main button behavior depending on membershipState:\r\n     *  - NONE        -> join waitlist\r\n     *  - WAITLIST    -> leave waitlist\r\n     *  - INVITED     -> accept invitation (invited -> registrable)\r\n     *  - REGISTRABLE -> register (registrable -> registered)\r\n     *  - REGISTERED  -> no-op\r\n     */\r\n    private void toggleJoinLeave() {\r\n        if (joinButton == null) return;\r\n        joinButton.setEnabled(false);\r\n\r\n        switch (membershipState) {\r\n            case NONE:\r\n                // Join waitlist\r\n                DbManager.getInstance()\r\n                        .addUserToWaitlist(eventId, entrantId)\r\n                        .addOnSuccessListener(v -> {\r\n                            membershipState = MembershipState.WAITLIST;\r\n                            waitlistCount++;\r\n                            renderJoinButton();\r\n                            renderWaitlistCount();\r\n                            Toast.makeText(requireContext(),\r\n                                    \"Joined waitlist\", Toast.LENGTH_SHORT).show();\r\n                            joinButton.setEnabled(true);\r\n                        })\r\n                        .addOnFailureListener(e -> joinButton.setEnabled(true));\r\n                break;\r\n\r\n            case WAITLIST:\r\n                // Leave waitlist\r\n                DbManager.getInstance()\r\n                        .cancelWaitlist(eventId, entrantId)\r\n                        .addOnSuccessListener(v -> {\r\n                            membershipState = MembershipState.NONE;\r\n                            if (waitlistCount > 0) waitlistCount--;\r\n                            renderJoinButton();\r\n                            renderWaitlistCount();\r\n                            Toast.makeText(requireContext(),\r\n                                    \"Left waitlist\", Toast.LENGTH_SHORT).show();\r\n                            joinButton.setEnabled(true);\r\n                        })\r\n                        .addOnFailureListener(e -> joinButton.setEnabled(true));\r\n                break;\r\n\r\n            case INVITED:\r\n                // Accept invitation: invited -> registrable\r\n                DbManager.getInstance()\r\n                        .moveUserFromInvitedToRegistrable(eventId, entrantId)\r\n                        .addOnSuccessListener(v -> {\r\n                            membershipState = MembershipState.REGISTRABLE;\r\n                            renderJoinButton();\r\n                            Toast.makeText(requireContext(),\r\n                                    \"Invitation accepted. You can now register.\",\r\n                                    Toast.LENGTH_SHORT).show();\r\n                            joinButton.setEnabled(true);\r\n                        })\r\n                        .addOnFailureListener(e -> {\r\n                            Toast.makeText(requireContext(),\r\n                                    \"Failed to accept invitation: \" + e.getMessage(),\r\n                                    Toast.LENGTH_LONG).show();\r\n                            joinButton.setEnabled(true);\r\n                        });\r\n                break;\r\n\r\n            case REGISTRABLE:\r\n                // Register: registrable -> registered\r\n                DbManager.getInstance()\r\n                        .addUserToRegistered(eventId, entrantId)\r\n                        .addOnSuccessListener(v -> {\r\n                            membershipState = MembershipState.REGISTERED;\r\n                            renderJoinButton();\r\n                            Toast.makeText(requireContext(),\r\n                                    \"You are now registered.\", Toast.LENGTH_SHORT).show();\r\n                            // keep disabled\r\n                        })\r\n                        .addOnFailureListener(e -> {\r\n                            Toast.makeText(requireContext(),\r\n                                    \"Failed to register: \" + e.getMessage(),\r\n                                    Toast.LENGTH_LONG).show();\r\n                            joinButton.setEnabled(true);\r\n                        });\r\n                break;\r\n\r\n            case REGISTERED:\r\n                // Nothing to do; already registered\r\n                Toast.makeText(requireContext(),\r\n                        \"You are already registered.\", Toast.LENGTH_SHORT).show();\r\n                joinButton.setEnabled(false);\r\n                break;\r\n        }\r\n    }\r\n\r\n    private void renderJoinButton() {\r\n        if (joinButton == null) return;\r\n\r\n        switch (membershipState) {\r\n            case NONE:\r\n                joinButton.setEnabled(true);\r\n                joinButton.setText(R.string.join_waitlist);\r\n                break;\r\n\r\n            case WAITLIST:\r\n                joinButton.setEnabled(true);\r\n                joinButton.setText(R.string.leave_waitlist);\r\n                break;\r\n\r\n            case INVITED:\r\n                joinButton.setEnabled(true);\r\n                joinButton.setText(\"Accept invitation\");\r\n                break;\r\n\r\n            case REGISTRABLE:\r\n                joinButton.setEnabled(true);\r\n                joinButton.setText(\"Register\");\r\n                break;\r\n\r\n            case REGISTERED:\r\n                joinButton.setEnabled(false);\r\n                joinButton.setText(\"Registered\");\r\n                break;\r\n        }\r\n    }\r\n\r\n    private void renderWaitlistCount() {\r\n        if (textWaitingList != null) {\r\n            textWaitingList.setText(\"waiting list: \" + waitlistCount);\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/entrant/DetailedEventDescriptionFragment.java b/app/src/main/java/com/example/magpie_wingman/entrant/DetailedEventDescriptionFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/entrant/DetailedEventDescriptionFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/entrant/DetailedEventDescriptionFragment.java	(date 1764449277201)
@@ -10,12 +10,16 @@
 import android.widget.ImageView;
 import android.widget.TextView;
 import android.widget.Toast;
+import android.Manifest;
+import android.content.pm.PackageManager;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.fragment.app.Fragment;
 import androidx.navigation.NavController;
 import androidx.navigation.Navigation;
+import androidx.core.app.ActivityCompat;
+import androidx.core.content.ContextCompat;
 
 import com.bumptech.glide.Glide;
 import com.example.magpie_wingman.MyApp;
@@ -24,10 +28,17 @@
 import com.example.magpie_wingman.data.model.Event;
 import com.example.magpie_wingman.data.model.User;
 import com.google.firebase.firestore.FirebaseFirestore;
+import android.location.Location;
+import com.google.android.gms.location.FusedLocationProviderClient;
+import com.google.android.gms.location.LocationServices;
+import com.google.android.gms.tasks.Task;
+import com.google.firebase.firestore.SetOptions;
 
 import java.text.SimpleDateFormat;
 import java.util.Date;
 import java.util.Locale;
+import java.util.HashMap;
+import java.util.Map;
 
 /**
  * Fragment that displays the full details of a single event for entrant users.
@@ -35,6 +46,7 @@
  *  Implemented functionality
  *  - Poster image only show when URL exists, otherwise hide
  *  - QR flow
+ *  - Location request for waitlist entries
  *  - Waitlist / invitation / registration logic
  */
 public class DetailedEventDescriptionFragment extends Fragment {
@@ -76,6 +88,10 @@
     private ImageView posterImage;
     private Button   joinButton;
 
+    // Location
+    private static final int REQ_LOCATION_PERMISSION = 1001;
+    private FusedLocationProviderClient fusedLocationClient;
+
     // Membership + waitlist info
     private MembershipState membershipState = MembershipState.NONE;
     private int waitlistCount = 0;
@@ -156,6 +172,8 @@
         descriptionText        = v.findViewById(R.id.text_event_description);
         joinButton             = v.findViewById(R.id.button_join_waitlist);
 
+        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireContext());
+
         // Use whatever data we already have from arguments
         bindStaticDetailsFromArgs();
 
@@ -387,19 +405,18 @@
 
         switch (membershipState) {
             case NONE:
-                // Join waitlist
-                DbManager.getInstance()
-                        .addUserToWaitlist(eventId, entrantId)
-                        .addOnSuccessListener(v -> {
-                            membershipState = MembershipState.WAITLIST;
-                            waitlistCount++;
-                            renderJoinButton();
-                            renderWaitlistCount();
-                            Toast.makeText(requireContext(),
-                                    "Joined waitlist", Toast.LENGTH_SHORT).show();
-                            joinButton.setEnabled(true);
-                        })
-                        .addOnFailureListener(e -> joinButton.setEnabled(true));
+                // Join waitlist with geo permission
+                DbManager.getInstance().getDb().collection("events").document(eventId).get().addOnSuccessListener(snapshot -> {
+                            Boolean geoRequired = snapshot.getBoolean("geolocationRequired");
+
+                            if (geoRequired != null && geoRequired) {
+                                //organizer needs geolocation
+                                captureLocationIfAllowed(); //will block if no permission/location
+                            } else {
+                                //no geolocation required
+                                performJoinWithLocation(null, null);
+                            }
+                        });
                 break;
 
             case WAITLIST:
@@ -502,4 +519,81 @@
             textWaitingList.setText("waiting list: " + waitlistCount);
         }
     }
+    private void captureLocationIfAllowed() {
+        //check permission
+        if (ContextCompat.checkSelfPermission(
+                requireContext(),
+                Manifest.permission.ACCESS_FINE_LOCATION
+        ) != PackageManager.PERMISSION_GRANTED) {
+
+            requestPermissions(
+                    new String[]{ Manifest.permission.ACCESS_FINE_LOCATION },
+                    REQ_LOCATION_PERMISSION
+            );
+            return;   // wait for userâ€™s answer
+        }
+        requestLocationAndJoin();
+    }
+    private void requestLocationAndJoin() {
+        if (fusedLocationClient == null) {
+            //join without location
+            performJoinWithLocation(null, null);
+            return;
+        }
+
+        if (ActivityCompat.checkSelfPermission(requireContext(), Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED
+                && ActivityCompat.checkSelfPermission(requireContext(), Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
+            return;
+        }
+
+        fusedLocationClient.getLastLocation()
+                .addOnSuccessListener(location -> {
+                    Double lat = null, lng = null;
+                    if (location != null) {
+                        lat = location.getLatitude();
+                        lng = location.getLongitude();
+                    }
+                    performJoinWithLocation(lat, lng);
+                })
+                .addOnFailureListener(e -> {
+                    //still allow joining without location for now
+                    performJoinWithLocation(null, null);
+                });
+    }
+
+    private void performJoinWithLocation(@Nullable Double lat, @Nullable Double lng) {
+        if (lat == null || lng == null) {
+            Toast.makeText(requireContext(),
+                    "Location required to join this event.",
+                    Toast.LENGTH_LONG).show();
+            joinButton.setEnabled(true);
+            return;
+        }
+
+        DbManager.getInstance()
+                .addUserToWaitlist(eventId, entrantId, lat, lng)
+                .addOnSuccessListener(v -> {
+                    membershipState = MembershipState.WAITLIST;
+                    waitlistCount++;
+                    renderJoinButton();
+                    renderWaitlistCount();
+                    Toast.makeText(requireContext(),
+                            "Joined waitlist", Toast.LENGTH_SHORT).show();
+                    joinButton.setEnabled(true);
+                })
+                .addOnFailureListener(e -> joinButton.setEnabled(true));
+    }
+
+    @Override
+    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
+        super.onRequestPermissionsResult(requestCode, permissions, grantResults);
+
+        if (requestCode == REQ_LOCATION_PERMISSION) {
+            if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
+                requestLocationAndJoin(); //permission granted
+            } else {
+                performJoinWithLocation(null, null); //permission denied, proceed with no location
+            }
+        }
+    }
 }
Index: app/src/main/res/navigation/nav_graph.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<navigation xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/nav_graph\"\r\n    app:startDestination=\"@id/splashFragment\">\r\n\r\n    <fragment\r\n        android:id=\"@+id/splashFragment\"\r\n        android:name=\"com.example.magpie_wingman.ui.login.SplashFragment\"\r\n        android:label=\"fragment_splash\"\r\n        tools:layout=\"@layout/fragment_splash\">\r\n\r\n        <action\r\n            android:id=\"@+id/action_splashFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n\r\n        <action\r\n            android:id=\"@+id/action_splashFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n    </fragment>\r\n\r\n    <fragment\r\n        android:id=\"@+id/FirstFragment\"\r\n        android:name=\"com.example.magpie_wingman.FirstFragment\"\r\n        android:label=\"@string/first_fragment_label\"\r\n        tools:layout=\"@layout/fragment_first\">\r\n\r\n        <action\r\n            android:id=\"@+id/action_FirstFragment_to_SecondFragment\"\r\n            app:destination=\"@id/SecondFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/SecondFragment\"\r\n        android:name=\"com.example.magpie_wingman.SecondFragment\"\r\n        android:label=\"@string/second_fragment_label\"\r\n        tools:layout=\"@layout/fragment_second\">\r\n\r\n        <action\r\n            android:id=\"@+id/action_SecondFragment_to_FirstFragment\"\r\n            app:destination=\"@id/FirstFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/loginFragment\"\r\n        android:name=\"com.example.magpie_wingman.ui.login.LoginFragment\"\r\n        android:label=\"fragment_login\"\r\n        tools:layout=\"@layout/fragment_login\" >\r\n        <action\r\n            android:id=\"@+id/action_loginFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n        <action\r\n            android:id=\"@+id/action_loginFragment_to_organizerLandingFragment2\"\r\n            app:destination=\"@id/organizerLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_loginFragment_to_adminLandingFragment22\"\r\n            app:destination=\"@id/adminLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_loginFragment_to_signUpFragment\"\r\n            app:destination=\"@id/signUpFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantLandingFragment3\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantLandingFragment\"\r\n        android:label=\"fragment_entrant_landing\"\r\n        tools:layout=\"@layout/fragment_entrant_landing\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantLandingFragment3_to_entrantEventSearchFilterFragment\"\r\n            app:destination=\"@id/entrantEventSearchFilterFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantLandingFragment3_to_entrantNotificationsFragment\"\r\n            app:destination=\"@id/entrantNotificationsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantLandingFragment3_to_entrantInvitationsFragment\"\r\n            app:destination=\"@id/entrantInvitationsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantLandingFragment3_to_entrantEventsFragment\"\r\n            app:destination=\"@id/entrantEventsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantLandingFragment3_to_entrantDetailsFragment\"\r\n            app:destination=\"@id/entrantDetailsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantLandingFragment3_to_detailedEventDescriptionFragment\"\r\n            app:destination=\"@id/detailedEventDescriptionFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantLandingFragment3_to_scanQRFragment\"\r\n            app:destination=\"@id/scanQRFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantLandingFragment3_to_entrantSettingsFragment\"\r\n            app:destination=\"@id/entrantSettingsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantLandingFramgnet3_to_entrantAboutUsFragment\"\r\n            app:destination=\"@id/entrantAboutUsFragment\"  />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerLandingFragment2\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerLandingFragment\"\r\n        android:label=\"fragment_organizer_landing\"\r\n        tools:layout=\"@layout/fragment_organizer_landing\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerLandingFragment2_to_organizerEditEventFragment\"\r\n            app:destination=\"@id/organizerEditEventFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerLandingFragment2_to_organizerNewEventFragment\"\r\n            app:destination=\"@id/organizerNewEventFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerLandingFragment2_to_organizerEventDetailsFragment\"\r\n            app:destination=\"@id/organizerEventDetailsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerLandingFragment2_to_organizerSettingsFragment\"\r\n            app:destination=\"@id/organizerSettingsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminLandingFragment2\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminLandingFragment\"\r\n        android:label=\"fragment_admin_landing\"\r\n        tools:layout=\"@layout/fragment_admin_landing\" >\r\n        <action\r\n            android:id=\"@+id/action_adminLandingFragment2_to_adminImagesFragment\"\r\n            app:destination=\"@id/adminImagesFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_adminLandingFragment2_to_adminNotificationLogFragment\"\r\n            app:destination=\"@id/adminNotificationLogFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_adminLandingFragment2_to_adminProfilesFragment\"\r\n            app:destination=\"@id/adminProfilesFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_adminLandingFragment2_to_adminEventsFragment\"\r\n            app:destination=\"@id/adminEventsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_adminLandingFragment2_to_adminSettingsFragment\"\r\n            app:destination=\"@id/adminSettingsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantEventSearchFilterFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantEventSearchFilterFragment\"\r\n        android:label=\"fragment_entrant_event_search_filter\"\r\n        tools:layout=\"@layout/fragment_entrant_event_search_filter\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantEventSearchFilterFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantNotificationsFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantNotificationsFragment\"\r\n        android:label=\"fragment_entrant_notifications\"\r\n        tools:layout=\"@layout/fragment_entrant_notifications\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantNotificationsFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantInvitationsFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantInvitationsFragment\"\r\n        android:label=\"fragment_entrant_invitations\"\r\n        tools:layout=\"@layout/fragment_entrant_invitations\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantInvitationsFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantInvitationsFragment_to_detailedEventDescriptionFragment\"\r\n            app:destination=\"@id/detailedEventDescriptionFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantEventsFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantEventsFragment\"\r\n        android:label=\"fragment_entrant_events\"\r\n        tools:layout=\"@layout/fragment_entrant_events\" >\r\n\r\n        <action\r\n            android:id=\"@+id/action_entrantEventsFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n\r\n        <action\r\n            android:id=\"@+id/action_entrantEventsFragment_to_detailedEventDescriptionFragment\"\r\n            app:destination=\"@id/detailedEventDescriptionFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantDetailsFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantDetailsFragment\"\r\n        android:label=\"fragment_entrant_details\"\r\n        tools:layout=\"@layout/fragment_entrant_details\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantDetailsFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantAboutUsFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantAboutUsFragment\"\r\n        android:label=\"fragment_entrant_about_us\"\r\n        tools:layout=\"@layout/fragment_entrant_about_us\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantAboutUsFragment_to_entrantSettingsFragment\"\r\n            app:destination=\"@id/entrantSettingsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerNewEventFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerNewEventFragment\"\r\n        android:label=\"fragment_organizer_new_event\"\r\n        tools:layout=\"@layout/fragment_organizer_new_event\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerNewEventFragment_to_organizerLandingFragment2\"\r\n            app:destination=\"@id/organizerLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerNewEventFragment_to_organizerEditNewEventInfoFragment\"\r\n            app:destination=\"@id/organizerEditNewEventInfoFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerEditEventFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerEditEventFragment\"\r\n        android:label=\"fragment_organizer_edit_event\"\r\n        tools:layout=\"@layout/fragment_organizer_edit_event\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerEditEventFragment_to_organizerLandingFragment2\"\r\n            app:destination=\"@id/organizerLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerEditEventFragment_to_organizerEditNewEventInfoFragment\"\r\n            app:destination=\"@id/organizerEditNewEventInfoFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerEditNewEventInfoFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerEditNewEventInfoFragment\"\r\n        android:label=\"fragment_organizer_edit_new_event_info\"\r\n        tools:layout=\"@layout/fragment_organizer_edit_new_event_info\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerEditNewEventInfoFragment_to_organizerNewEventFragment\"\r\n            app:destination=\"@id/organizerNewEventFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerEditNewEventInfoFragment_to_organizerEditEventFragment\"\r\n            app:destination=\"@id/organizerEditEventFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerEventDetailsFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerEventDetailsFragment\"\r\n        android:label=\"fragment_organizer_event_details\"\r\n        tools:layout=\"@layout/fragment_organizer_event_details\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerEventDetailsFragment_to_organizerLandingFragment2\"\r\n            app:destination=\"@id/organizerLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerEventDetailsFragment_to_organizerFinalizedListFragment\"\r\n            app:destination=\"@id/organizerFinalizedListFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerEventDetailsFragment_to_organizerNotifyFragment\"\r\n            app:destination=\"@id/organizerNotifyFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerEventDetailsFragment_to_organizerLotteryFragment\"\r\n            app:destination=\"@id/organizerLotteryFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerEventDetailsFragment_to_waitingListFragment\"\r\n            app:destination=\"@id/waitingListFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerEventDetailsFragment_to_selectedEntrantsListFragment\"\r\n            app:destination=\"@id/selectedEntrantsListFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerEventDetailsFragment_to_acceptedListFragment\"\r\n            app:destination=\"@id/acceptedListFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerEventDetailsFragment_to_cancelledListFragment\"\r\n            app:destination=\"@id/cancelledListFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerLotteryFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerLotteryFragment\"\r\n        android:label=\"fragment_organizer_lottery\"\r\n        tools:layout=\"@layout/fragment_organizer_lottery\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerLotteryFragment_to_organizerEventDetailsFragment\"\r\n            app:destination=\"@id/organizerEventDetailsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerNotifyFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerNotifyFragment\"\r\n        android:label=\"fragment_organizer_notify\"\r\n        tools:layout=\"@layout/fragment_organizer_notify\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerNotifyFragment_to_organizerEventDetailsFragment\"\r\n            app:destination=\"@id/organizerEventDetailsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerFinalizedListFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerFinalizedListFragment\"\r\n        android:label=\"fragment_organizer_finalized_list\"\r\n        tools:layout=\"@layout/fragment_organizer_finalized_list\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerFinalizedListFragment_to_organizerEventDetailsFragment\"\r\n            app:destination=\"@id/organizerEventDetailsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerGeolocationFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerGeolocationFragment\"\r\n        android:label=\"fragment_organizer_geolocation\"\r\n        tools:layout=\"@layout/fragment_organizer_geolocation\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerGeolocationFragment_to_waitingListFragment\"\r\n            app:destination=\"@id/waitingListFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerAboutUsFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerAboutUsFragment\"\r\n        android:label=\"fragment_organizer_about_us\"\r\n        tools:layout=\"@layout/fragment_organizer_about_us\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerAboutUsFragment_to_organizerSettingsFragment\"\r\n            app:destination=\"@id/organizerSettingsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminImagesFragment\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminImagesFragment\"\r\n        android:label=\"fragment_admin_images\"\r\n        tools:layout=\"@layout/fragment_admin_images\" >\r\n        <action\r\n            android:id=\"@+id/action_adminImagesFragment_to_adminLandingFragment2\"\r\n            app:destination=\"@id/adminLandingFragment2\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminNotificationLogFragment\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminNotificationLogFragment\"\r\n        android:label=\"fragment_admin_notification_log\"\r\n        tools:layout=\"@layout/fragment_admin_notification_log\" >\r\n        <action\r\n            android:id=\"@+id/action_adminNotificationLogFragment_to_adminLandingFragment2\"\r\n            app:destination=\"@id/adminLandingFragment2\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminProfilesFragment\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminProfilesFragment\"\r\n        android:label=\"Admin Profiles (Replace with search)\"\r\n        tools:layout=\"@layout/fragment_admin_profiles\" >\r\n        <action\r\n            android:id=\"@+id/action_adminProfilesFragment_to_adminLandingFragment2\"\r\n            app:destination=\"@id/adminLandingFragment2\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminEventsFragment\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminEventsFragment\"\r\n        android:label=\"fragment_admin_events\"\r\n        tools:layout=\"@layout/fragment_admin_events\" >\r\n        <action\r\n            android:id=\"@+id/action_adminEventsFragment_to_adminLandingFragment2\"\r\n            app:destination=\"@id/adminLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_adminEventsFragment_to_adminFilterEventSearchFragment\"\r\n            app:destination=\"@id/adminFilterEventSearchFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminFilterEventSearchFragment\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminFilterEventSearchFragment\"\r\n        android:label=\"fragment_admin_filter_event_search\"\r\n        tools:layout=\"@layout/fragment_admin_filter_event_search\" >\r\n        <action\r\n            android:id=\"@+id/action_adminFilterEventSearchFragment_to_adminEventsFragment\"\r\n            app:destination=\"@id/adminEventsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/detailedEventDescriptionFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.DetailedEventDescriptionFragment\"\r\n        android:label=\"fragment_detailed_event_description\"\r\n        tools:layout=\"@layout/fragment_detailed_event_description\" >\r\n\r\n        <action\r\n            android:id=\"@+id/action_detailedEventDescriptionFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n\r\n        <argument\r\n            android:name=\"eventPosterURL\"\r\n            app:argType=\"string\" />\r\n        <argument\r\n            android:name=\"eventId\"\r\n            app:argType=\"string\" />\r\n        <argument\r\n            android:name=\"eventName\"\r\n            app:argType=\"string\" />\r\n        <argument\r\n            android:name=\"eventDescription\"\r\n            app:argType=\"string\" />\r\n        <argument\r\n            android:name=\"eventLocation\"\r\n            app:argType=\"string\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/scanQRFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.ScanQRFragment\"\r\n        android:label=\"fragment_scan_q_r\"\r\n        tools:layout=\"@layout/fragment_scan_q_r\" >\r\n        <action\r\n            android:id=\"@+id/action_scanQRFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n        <action\r\n            android:id=\"@+id/action_scanQRFragment_to_detailedEventDescriptionFragment\"\r\n            app:destination=\"@id/detailedEventDescriptionFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/waitingListFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.WaitingListFragment\"\r\n        android:label=\"fragment_waiting_list\"\r\n        tools:layout=\"@layout/fragment_waiting_list\" >\r\n        <action\r\n            android:id=\"@+id/action_waitingListFragment_to_organizerEventDetailsFragment\"\r\n            app:destination=\"@id/organizerEventDetailsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_waitingListFragment_to_organizerGeolocationFragment\"\r\n            app:destination=\"@id/organizerGeolocationFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/selectedEntrantsListFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.SelectedEntrantsListFragment\"\r\n        android:label=\"Selected Entrants List\"\r\n        tools:layout=\"@layout/fragment_selected_entrants_list\">\r\n\r\n        <action\r\n            android:id=\"@+id/action_selectedEntrantsListFragment_to_organizerEventDetailsFragment\"\r\n            app:destination=\"@id/organizerEventDetailsFragment\" />\r\n\r\n        <argument\r\n            android:name=\"eventId\"\r\n            app:argType=\"string\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/acceptedListFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.AcceptedListFragment\"\r\n        android:label=\"fragment_accepted_list\"\r\n        tools:layout=\"@layout/fragment_accepted_list\" >\r\n        <action\r\n            android:id=\"@+id/action_acceptedListFragment_to_organizerEventDetailsFragment\"\r\n            app:destination=\"@id/organizerEventDetailsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/cancelledListFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.CancelledListFragment\"\r\n        android:label=\"fragment_cancelled_list\"\r\n        tools:layout=\"@layout/fragment_cancelled_list\" >\r\n        <action\r\n            android:id=\"@+id/action_cancelledListFragment_to_organizerEventDetailsFragment\"\r\n            app:destination=\"@id/organizerEventDetailsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/signUpFragment\"\r\n        android:name=\"com.example.magpie_wingman.ui.login.SignUpFragment\"\r\n        android:label=\"fragment_sign_up\"\r\n        tools:layout=\"@layout/fragment_sign_up\" >\r\n        <action\r\n            android:id=\"@+id/action_signUpFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantSettingsFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantSettingsFragment\"\r\n        android:label=\"fragment_entrant_settings\"\r\n        tools:layout=\"@layout/fragment_entrant_settings\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantSettingsFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantSettingsFragment_to_entrantAboutUsFragment\"\r\n            app:destination=\"@id/entrantAboutUsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantSettingsFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantSettingsFragment_to_entrantEditProfileFragment\"\r\n            app:destination=\"@id/entrantEditProfileFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantEditProfileFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantEditProfileFragment\"\r\n        android:label=\"fragment_entrant_edit_profile2\"\r\n        tools:layout=\"@layout/fragment_entrant_edit_profile\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantEditProfileFragment_to_entrantSettingsFragment\"\r\n            app:destination=\"@id/entrantSettingsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerSettingsFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerSettingsFragment\"\r\n        android:label=\"fragment_organizer_settings\"\r\n        tools:layout=\"@layout/fragment_organizer_settings\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerSettingsFragment_to_organizerLandingFragment2\"\r\n            app:destination=\"@id/organizerLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerSettingsFragment_to_organizerAboutUsFragment\"\r\n            app:destination=\"@id/organizerAboutUsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerSettingsFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerSettingsFragment_to_organizerEditProfileFragment2\"\r\n            app:destination=\"@id/organizerEditProfileFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerEditProfileFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerEditProfileFragment\"\r\n        android:label=\"fragment_organizer_edit_profile\"\r\n        tools:layout=\"@layout/fragment_organizer_edit_profile\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerEditProfileFragment_to_organizerSettingsFragment2\"\r\n            app:destination=\"@id/organizerSettingsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminSettingsFragment\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminSettingsFragment\"\r\n        android:label=\"fragment_admin_settings\"\r\n        tools:layout=\"@layout/fragment_admin_settings\" >\r\n        <action\r\n            android:id=\"@+id/action_adminSettingsFragment_to_adminLandingFragment2\"\r\n            app:destination=\"@id/adminLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_adminSettingsFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_adminSettingsFragment_to_adminEditProfileFragment\"\r\n            app:destination=\"@id/adminEditProfileFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminEditProfileFragment\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminEditProfileFragment\"\r\n        android:label=\"fragment_admin_edit_profile\"\r\n        tools:layout=\"@layout/fragment_admin_edit_profile\" >\r\n        <action\r\n            android:id=\"@+id/action_adminEditProfileFragment_to_adminSettingsFragment\"\r\n            app:destination=\"@id/adminSettingsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/signUpFragment\"\r\n        android:name=\"com.example.magpie_wingman.ui.login.SignUpFragment\"\r\n        android:label=\"fragment_sign_up\"\r\n        tools:layout=\"@layout/fragment_sign_up\" >\r\n        <action\r\n            android:id=\"@+id/action_signUpFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantSettingsFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantSettingsFragment\"\r\n        android:label=\"fragment_entrant_settings\"\r\n        tools:layout=\"@layout/fragment_entrant_settings\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantSettingsFragment_to_entrantLandingFragment3\"\r\n            app:destination=\"@id/entrantLandingFragment3\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantSettingsFragment_to_entrantAboutUsFragment\"\r\n            app:destination=\"@id/entrantAboutUsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantSettingsFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_entrantSettingsFragment_to_entrantEditProfileFragment\"\r\n            app:destination=\"@id/entrantEditProfileFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/entrantEditProfileFragment\"\r\n        android:name=\"com.example.magpie_wingman.entrant.EntrantEditProfileFragment\"\r\n        android:label=\"fragment_entrant_edit_profile2\"\r\n        tools:layout=\"@layout/fragment_entrant_edit_profile\" >\r\n        <action\r\n            android:id=\"@+id/action_entrantEditProfileFragment_to_entrantSettingsFragment\"\r\n            app:destination=\"@id/entrantSettingsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerSettingsFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerSettingsFragment\"\r\n        android:label=\"fragment_organizer_settings\"\r\n        tools:layout=\"@layout/fragment_organizer_settings\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerSettingsFragment_to_organizerLandingFragment2\"\r\n            app:destination=\"@id/organizerLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerSettingsFragment_to_organizerAboutUsFragment\"\r\n            app:destination=\"@id/organizerAboutUsFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerSettingsFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_organizerSettingsFragment_to_organizerEditProfileFragment2\"\r\n            app:destination=\"@id/organizerEditProfileFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/organizerEditProfileFragment\"\r\n        android:name=\"com.example.magpie_wingman.organizer.OrganizerEditProfileFragment\"\r\n        android:label=\"fragment_organizer_edit_profile\"\r\n        tools:layout=\"@layout/fragment_organizer_edit_profile\" >\r\n        <action\r\n            android:id=\"@+id/action_organizerEditProfileFragment_to_organizerSettingsFragment2\"\r\n            app:destination=\"@id/organizerSettingsFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminSettingsFragment\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminSettingsFragment\"\r\n        android:label=\"fragment_admin_settings\"\r\n        tools:layout=\"@layout/fragment_admin_settings\" >\r\n        <action\r\n            android:id=\"@+id/action_adminSettingsFragment_to_adminLandingFragment2\"\r\n            app:destination=\"@id/adminLandingFragment2\" />\r\n        <action\r\n            android:id=\"@+id/action_adminSettingsFragment_to_loginFragment\"\r\n            app:destination=\"@id/loginFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_adminSettingsFragment_to_adminEditProfileFragment\"\r\n            app:destination=\"@id/adminEditProfileFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/adminEditProfileFragment\"\r\n        android:name=\"com.example.magpie_wingman.admin.AdminEditProfileFragment\"\r\n        android:label=\"fragment_admin_edit_profile\"\r\n        tools:layout=\"@layout/fragment_admin_edit_profile\" >\r\n        <action\r\n            android:id=\"@+id/action_adminEditProfileFragment_to_adminSettingsFragment\"\r\n            app:destination=\"@id/adminSettingsFragment\" />\r\n    </fragment>\r\n</navigation>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/navigation/nav_graph.xml b/app/src/main/res/navigation/nav_graph.xml
--- a/app/src/main/res/navigation/nav_graph.xml	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/res/navigation/nav_graph.xml	(date 1764449277209)
@@ -257,6 +257,9 @@
         <action
             android:id="@+id/action_organizerEventDetailsFragment_to_cancelledListFragment"
             app:destination="@id/cancelledListFragment" />
+        <action
+            android:id="@+id/action_organizerEventDetailsFragment_to_organizerGeolocationFragment"
+            app:destination="@id/organizerGeolocationFragment" />
     </fragment>
     <fragment
         android:id="@+id/organizerLotteryFragment"
Index: app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEventDetailsFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.organizer;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.navigation.Navigation;\r\n\r\nimport com.example.magpie_wingman.R;\r\nimport com.example.magpie_wingman.data.DbManager;\r\nimport com.example.magpie_wingman.data.model.Event;\r\nimport com.google.zxing.BarcodeFormat;\r\nimport com.journeyapps.barcodescanner.BarcodeEncoder;\r\n\r\nimport java.io.InputStream;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.URL;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.Locale;\r\n\r\npublic class OrganizerEventDetailsFragment extends Fragment {\r\n\r\n    private String eventId;\r\n\r\n    private TextView titleView;\r\n    private TextView locationView;\r\n    private TextView dateView;\r\n    private TextView descriptionView;\r\n    private ImageView qrCodeButton;\r\n    private ImageView posterView;\r\n\r\n    private final SimpleDateFormat dateFormat =\r\n            new SimpleDateFormat(\"yyyy-MM-dd HH:mm\", Locale.getDefault());\r\n\r\n    public OrganizerEventDetailsFragment() { }\r\n\r\n    @Override\r\n    public void onCreate(@Nullable Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        if (getArguments() != null) {\r\n            eventId = getArguments().getString(\"eventId\");\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater,\r\n                             ViewGroup container,\r\n                             Bundle savedInstanceState) {\r\n        return inflater.inflate(R.layout.fragment_organizer_event_details, container, false);\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(@NonNull View view,\r\n                              @Nullable Bundle savedInstanceState) {\r\n        super.onViewCreated(view, savedInstanceState);\r\n\r\n        titleView       = view.findViewById(R.id.text_event_title);\r\n        locationView    = view.findViewById(R.id.text_event_location);\r\n        dateView        = view.findViewById(R.id.text_event_date_time);\r\n        descriptionView = view.findViewById(R.id.text_event_description);\r\n        qrCodeButton    = view.findViewById(R.id.image_qr);\r\n        posterView      = view.findViewById(R.id.image_event_poster);\r\n\r\n        ImageButton btnBack         = view.findViewById(R.id.button_back);\r\n        Button btnWaitlist          = view.findViewById(R.id.btn_waiting_list);\r\n        Button btnSelected          = view.findViewById(R.id.btn_selected_list);\r\n        Button btnAccepted          = view.findViewById(R.id.btn_accepted_list);\r\n        Button btnCancelled         = view.findViewById(R.id.btn_cancelled_list);\r\n        Button btnLottery           = view.findViewById(R.id.btn_lottery);\r\n        Button btnNotify            = view.findViewById(R.id.btn_notify);\r\n        Button btnCancelNonReg      = view.findViewById(R.id.btn_cancel_non_registered);\r\n        Button btnFinalize          = view.findViewById(R.id.btn_finalize);\r\n\r\n        if (eventId != null && !eventId.isEmpty()) {\r\n            loadEventDetails();\r\n        } else {\r\n            titleView.setText(\"Error: No Event ID Passed\");\r\n        }\r\n\r\n        btnBack.setOnClickListener(v -> Navigation.findNavController(view).navigateUp());\r\n\r\n        setupNavButton(view, btnWaitlist, R.id.action_organizerEventDetailsFragment_to_waitingListFragment);\r\n        setupNavButton(view, btnSelected, R.id.action_organizerEventDetailsFragment_to_selectedEntrantsListFragment);\r\n        setupNavButton(view, btnAccepted, R.id.action_organizerEventDetailsFragment_to_acceptedListFragment);\r\n        setupNavButton(view, btnCancelled, R.id.action_organizerEventDetailsFragment_to_cancelledListFragment);\r\n        setupNavButton(view, btnLottery, R.id.action_organizerEventDetailsFragment_to_organizerLotteryFragment);\r\n        setupNavButton(view, btnNotify, R.id.action_organizerEventDetailsFragment_to_organizerNotifyFragment);\r\n        setupNavButton(view, btnFinalize, R.id.action_organizerEventDetailsFragment_to_organizerFinalizedListFragment);\r\n\r\n        btnCancelNonReg.setOnClickListener(v -> confirmCancelNonRegistered());\r\n    }\r\n\r\n    private void loadEventDetails() {\r\n        DbManager.getInstance().getDb()\r\n                .collection(\"events\")\r\n                .document(eventId)\r\n                .get()\r\n                .addOnSuccessListener(documentSnapshot -> {\r\n                    Event event = documentSnapshot.toObject(Event.class);\r\n                    if (event == null) return;\r\n\r\n                    titleView.setText(event.getEventName());\r\n                    locationView.setText(\r\n                            event.getEventLocation() != null\r\n                                    ? event.getEventLocation()\r\n                                    : \"TBD\"\r\n                    );\r\n                    descriptionView.setText(event.getDescription());\r\n\r\n                    if (event.getEventStartTime() != null) {\r\n                        dateView.setText(dateFormat.format(event.getEventStartTime()));\r\n                    }\r\n\r\n                    // --- QR code handling ---\r\n                    String qrContent = event.getQrCodeHash();\r\n                    if (qrContent != null && !qrContent.isEmpty()) {\r\n                        qrCodeButton.setOnClickListener(v -> showQRDialog(qrContent));\r\n                    } else {\r\n                        qrCodeButton.setOnClickListener(v ->\r\n                                Toast.makeText(getContext(),\r\n                                        \"No QR Code generated\",\r\n                                        Toast.LENGTH_SHORT\r\n                                ).show()\r\n                        );\r\n                    }\r\n\r\n                    // --- Poster handling (no Glide/Picasso) ---\r\n                    String posterUrl = event.getEventPosterURL();\r\n                    if (posterUrl != null && !posterUrl.isEmpty()) {\r\n                        posterView.setImageResource(R.drawable.ic_image_placeholder);\r\n                        loadPosterImageAsync(posterUrl);\r\n                    } else {\r\n                        posterView.setImageResource(R.drawable.ic_broken_image);\r\n                    }\r\n                })\r\n                .addOnFailureListener(e ->\r\n                        Log.e(\"OrgEventDetails\", \"Failed to load event\", e)\r\n                );\r\n    }\r\n\r\n    /**\r\n     * Downloads the image from the given URL on a background thread and sets it\r\n     * into image_event_poster on the main thread.\r\n     */\r\n    private void loadPosterImageAsync(@NonNull String urlString) {\r\n        new Thread(() -> {\r\n            Bitmap bmp = null;\r\n            try {\r\n                URL url = new URL(urlString);\r\n                HttpURLConnection conn = (HttpURLConnection) url.openConnection();\r\n                conn.setDoInput(true);\r\n                conn.connect();\r\n                try (InputStream is = conn.getInputStream()) {\r\n                    bmp = BitmapFactory.decodeStream(is);\r\n                }\r\n            } catch (Exception e) {\r\n                Log.e(\"OrgEventDetails\", \"Poster load failed\", e);\r\n            }\r\n\r\n            final Bitmap finalBmp = bmp;\r\n            if (!isAdded()) return;\r\n\r\n            requireActivity().runOnUiThread(() -> {\r\n                if (finalBmp != null) {\r\n                    posterView.setImageBitmap(finalBmp);\r\n                } else {\r\n                    posterView.setImageResource(R.drawable.ic_broken_image);\r\n                }\r\n            });\r\n        }).start();\r\n    }\r\n\r\n    private void showQRDialog(@NonNull String content) {\r\n        try {\r\n            BarcodeEncoder barcodeEncoder = new BarcodeEncoder();\r\n            Bitmap bitmap = barcodeEncoder.encodeBitmap(content, BarcodeFormat.QR_CODE, 600, 600);\r\n\r\n            ImageView imageView = new ImageView(getContext());\r\n            imageView.setImageBitmap(bitmap);\r\n            imageView.setPadding(30, 30, 30, 30);\r\n\r\n            new AlertDialog.Builder(getContext())\r\n                    .setTitle(\"Event QR Code\")\r\n                    .setView(imageView)\r\n                    .setPositiveButton(\"Close\", null)\r\n                    .show();\r\n\r\n        } catch (Exception e) {\r\n            Toast.makeText(getContext(), \"Error generating QR\", Toast.LENGTH_SHORT).show();\r\n        }\r\n    }\r\n\r\n    private void setupNavButton(View root, Button button, int actionId) {\r\n        if (button == null) return;\r\n        button.setOnClickListener(v -> {\r\n            if (eventId == null) return;\r\n            Bundle bundle = new Bundle();\r\n            bundle.putString(\"eventId\", eventId);\r\n            Navigation.findNavController(root).navigate(actionId, bundle);\r\n        });\r\n    }\r\n\r\n    private void confirmCancelNonRegistered() {\r\n        new AlertDialog.Builder(requireContext())\r\n                .setTitle(\"Cancel non-registered entrants?\")\r\n                .setMessage(\"This will move all entrants who did not sign up to the Cancelled list.\")\r\n                .setPositiveButton(\"Yes\", (dialog, which) -> {\r\n                    DbManager.getInstance()\r\n                            .cancelNonRegisteredEntrants(eventId)\r\n                            .addOnSuccessListener(aVoid ->\r\n                                    Toast.makeText(requireContext(),\r\n                                            \"Non-registered entrants cancelled.\",\r\n                                            Toast.LENGTH_SHORT).show())\r\n                            .addOnFailureListener(e ->\r\n                                    Toast.makeText(requireContext(),\r\n                                            \"Failed: \" + e.getMessage(),\r\n                                            Toast.LENGTH_LONG).show());\r\n                })\r\n                .setNegativeButton(\"No\", null)\r\n                .show();\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEventDetailsFragment.java b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEventDetailsFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEventDetailsFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEventDetailsFragment.java	(date 1764449277204)
@@ -83,6 +83,7 @@
         Button btnNotify            = view.findViewById(R.id.btn_notify);
         Button btnCancelNonReg      = view.findViewById(R.id.btn_cancel_non_registered);
         Button btnFinalize          = view.findViewById(R.id.btn_finalize);
+        Button btnGeolocation       = view.findViewById(R.id.btn_geolocation);
 
         if (eventId != null && !eventId.isEmpty()) {
             loadEventDetails();
@@ -99,6 +100,7 @@
         setupNavButton(view, btnLottery, R.id.action_organizerEventDetailsFragment_to_organizerLotteryFragment);
         setupNavButton(view, btnNotify, R.id.action_organizerEventDetailsFragment_to_organizerNotifyFragment);
         setupNavButton(view, btnFinalize, R.id.action_organizerEventDetailsFragment_to_organizerFinalizedListFragment);
+        setupNavButton(view, btnGeolocation, R.id.action_organizerEventDetailsFragment_to_organizerGeolocationFragment);
 
         btnCancelNonReg.setOnClickListener(v -> confirmCancelNonRegistered());
     }
Index: app/src/main/java/com/example/magpie_wingman/data/DbManager.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.data;\r\n\r\nimport android.content.Context;\r\nimport android.provider.Settings;\r\n\r\nimport androidx.annotation.Nullable;\r\n\r\nimport com.example.magpie_wingman.data.model.Event;\r\nimport com.example.magpie_wingman.data.model.Notification;\r\nimport com.example.magpie_wingman.data.model.User;\r\nimport com.example.magpie_wingman.data.model.UserProfile;\r\nimport com.example.magpie_wingman.data.model.UserRole;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.gms.tasks.TaskCompletionSource;\r\nimport com.google.android.gms.tasks.Tasks;\r\nimport com.google.firebase.firestore.CollectionReference;\r\nimport com.google.firebase.firestore.DocumentReference;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.Query;\r\nimport com.google.firebase.firestore.QuerySnapshot;\r\nimport com.google.firebase.firestore.SetOptions;\r\nimport com.google.firebase.firestore.WriteBatch;\r\n\r\nimport java.security.SecureRandom;\r\nimport java.util.ArrayList;\r\nimport java.util.Collections;\r\nimport java.util.Date;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\nimport java.util.Map;\r\nimport java.util.concurrent.Executors;\r\nimport android.net.Uri;\r\n\r\nimport com.google.firebase.storage.FirebaseStorage;\r\nimport com.google.firebase.storage.StorageReference;\r\n\r\n/**\r\n * This utility class contains all of the \"Helper Methods\" that read from and write to the database\r\n * Helper method functionalities include:\r\n * -  Creating and deleting users/events\r\n * -  Moving users to waitlist -> registrable -> registered subcollections in an event's doc\r\n * -  Removing users from the above subcollections\r\n * -  Changing user's organizer perms\r\n * -  Getters and setters for user/events' info\r\n */\r\npublic class DbManager {\r\n\r\n    private static DbManager instance;\r\n\r\n    private final FirebaseFirestore db;\r\n    private final FirebaseStorage storage = FirebaseStorage.getInstance();\r\n    private final Context appContext;\r\n    private final SecureRandom random = new SecureRandom();\r\n\r\n    private DbManager(Context context) {\r\n        this.appContext = context.getApplicationContext();\r\n        this.db = FirebaseFirestore.getInstance();\r\n    }\r\n\r\n    public static synchronized void init(Context context) {\r\n        if (instance == null) {\r\n            instance = new DbManager(context);\r\n        }\r\n    }\r\n\r\n    public static synchronized DbManager getInstance() {\r\n        if (instance == null) {\r\n            throw new IllegalStateException(\"DbManager not initialized. Call DbManager.init(context) first.\");\r\n        }\r\n        return instance;\r\n    }\r\n\r\n    public FirebaseFirestore getDb() {\r\n        return db;\r\n    }\r\n\r\n    /**\r\n     * Generates a unique internal ID for user documents by using the first name and a randomized 4 digit integer\r\n     * @param name - the inputted name for the user.\r\n     * @return userID the document ID for the user's firebase document\r\n     */\r\n    public String generateUserId(String name) {\r\n        String cleanName = name.trim().replaceAll(\"\\\\s+\", \"\").toLowerCase(Locale.ROOT);\r\n\r\n        while (true) {\r\n            int suffix = 1000 + random.nextInt(9000);\r\n            String userId = cleanName + \"#\" + suffix;\r\n\r\n            try {\r\n                DocumentSnapshot doc = Tasks.await(\r\n                        db.collection(\"users\").document(userId).get()\r\n                );\r\n\r\n                if (!doc.exists()) {\r\n                    return userId;\r\n                }\r\n\r\n            } catch (Exception e) {\r\n                e.printStackTrace();\r\n                return userId;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new user document.\r\n     * The userId will be generated using generateUserID and will also act as the document ID\r\n     * NOTE 26 related problems are due to constructor changes in instrumented tests (not material to prod) will fix later\r\n     */\r\n    public Task<Void> createUser(String name, String email, String phone, String password) {\r\n        String userId = generateUserId(name);\r\n\r\n        Map<String, Object> user = new HashMap<>();\r\n        user.put(\"userId\", userId);\r\n        user.put(\"name\", name);\r\n        user.put(\"email\", email);\r\n        user.put(\"phone\", phone);\r\n        user.put(\"password\",password);\r\n        user.put(\"isOrganizer\", true);\r\n        user.put(\"deviceId\", Settings.Secure.getString(\r\n                appContext.getContentResolver(),\r\n                Settings.Secure.ANDROID_ID\r\n        ));\r\n\r\n        return db.collection(\"users\")\r\n                .document(userId)\r\n                .set(user, SetOptions.merge());\r\n\r\n    }\r\n\r\n    /**\r\n     * Creates a new event document in Firestore.\r\n     * The event ID is generated from the first word in the event name + random 4-digit number.\r\n     *\r\n     * @param eventName        the name of the event\r\n     * @param description      the event description\r\n     * @param organizerId      the userId of the organizer (to store reference)\r\n     * @param regStart         registration start date (String or Timestamp)\r\n     * @param regEnd           registration end date (String or Timestamp)\r\n     */\r\n    public Task<Void> createEvent(String eventName,\r\n                                  String description,\r\n                                  String organizerId,\r\n                                  Object regStart,\r\n                                  Object regEnd) {\r\n\r\n        String eventId;\r\n        DocumentSnapshot doc;\r\n\r\n        while (true) {\r\n            String firstWord = eventName.trim().split(\"\\\\s+\")[0].toLowerCase(Locale.ROOT);\r\n            int suffix = 1000 + random.nextInt(9000);\r\n            eventId = firstWord + \"#\" + suffix;\r\n\r\n            try {\r\n                doc = Tasks.await(db.collection(\"events\").document(eventId).get());\r\n                if (!doc.exists()) break; // no collision, proceed\r\n            } catch (Exception e) {\r\n                e.printStackTrace(); //if there's a collision it will show in the stack trace and retry a new number\r\n                continue;\r\n            }\r\n        }\r\n\r\n        Map<String, Object> event = new HashMap<>();\r\n        event.put(\"eventId\", eventId);\r\n        event.put(\"eventName\", eventName);\r\n        event.put(\"description\", description);\r\n        event.put(\"organizerId\", organizerId);\r\n        event.put(\"registrationStart\", regStart);\r\n        event.put(\"registrationEnd\", regEnd);\r\n\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .set(event, SetOptions.merge());\r\n    }\r\n    public Task<Void> deleteEntrant(String userId) {\r\n        TaskCompletionSource<Void> tcs = new TaskCompletionSource<>();\r\n\r\n        Executors.newSingleThreadExecutor().execute(() -> {\r\n            try {\r\n                // Get all events\r\n                QuerySnapshot eventsSnap = Tasks.await(db.collection(\"events\").get());\r\n\r\n                WriteBatch batch = db.batch();\r\n\r\n                for (DocumentSnapshot ev : eventsSnap.getDocuments()) {\r\n                    com.google.firebase.firestore.DocumentReference evRef = ev.getReference();\r\n\r\n                    // waitlist\r\n                    QuerySnapshot wl = Tasks.await(\r\n                            evRef.collection(\"waitlist\").whereEqualTo(\"userId\", userId).get()\r\n                    );\r\n                    for (DocumentSnapshot d : wl.getDocuments()) {\r\n                        batch.delete(d.getReference());\r\n                    }\r\n\r\n                    // invited\r\n                    QuerySnapshot inv = Tasks.await(\r\n                            evRef.collection(\"invited\").whereEqualTo(\"userId\", userId).get()\r\n                    );\r\n                    for (DocumentSnapshot d : inv.getDocuments()) {\r\n                        batch.delete(d.getReference());\r\n                    }\r\n\r\n                    // registrable\r\n                    QuerySnapshot rg = Tasks.await(\r\n                            evRef.collection(\"registrable\").whereEqualTo(\"userId\", userId).get()\r\n                    );\r\n                    for (DocumentSnapshot d : rg.getDocuments()) {\r\n                        batch.delete(d.getReference());\r\n                    }\r\n\r\n                    // registered\r\n                    QuerySnapshot rd = Tasks.await(\r\n                            evRef.collection(\"registered\").whereEqualTo(\"userId\", userId).get()\r\n                    );\r\n                    for (DocumentSnapshot d : rd.getDocuments()) {\r\n                        batch.delete(d.getReference());\r\n                    }\r\n\r\n                    // cancelled\r\n                    QuerySnapshot cd = Tasks.await(\r\n                            evRef.collection(\"cancelled\").whereEqualTo(\"userId\", userId).get()\r\n                    );\r\n                    for (DocumentSnapshot d : cd.getDocuments()) {\r\n                        batch.delete(d.getReference());\r\n                    }\r\n                }\r\n\r\n                // Finally delete the user doc\r\n                batch.delete(db.collection(\"users\").document(userId));\r\n\r\n                // Commit once\r\n                Tasks.await(batch.commit());\r\n                tcs.setResult(null);\r\n            } catch (Exception e) {\r\n                tcs.setException(e);\r\n            }\r\n        });\r\n\r\n        return tcs.getTask();\r\n    }\r\n\r\n    public Task<Void> deleteOrganizer(String organizerId) {\r\n        TaskCompletionSource<Void> tcs = new TaskCompletionSource<>();\r\n\r\n        Executors.newSingleThreadExecutor().execute(() -> {\r\n            try {\r\n                QuerySnapshot organizerEvents = Tasks.await(\r\n                        db.collection(\"events\")\r\n                                .whereEqualTo(\"organizerId\", organizerId)\r\n                                .get()\r\n                );\r\n\r\n                List<Task<Void>> deletes = new ArrayList<>();\r\n                for (DocumentSnapshot d : organizerEvents.getDocuments()) {\r\n                    deletes.add(deleteEvent(d.getId()));\r\n                }\r\n\r\n                Tasks.await(Tasks.whenAll(deletes));\r\n                Tasks.await(deleteEntrant(organizerId));\r\n\r\n                tcs.setResult(null);\r\n            } catch (Exception e) {\r\n                tcs.setException(e);\r\n            }\r\n        });\r\n\r\n        return tcs.getTask();\r\n    }\r\n\r\n    public Task<Void> revokeOrganizerAndDeleteEvents(String organizerId) {\r\n        TaskCompletionSource<Void> tcs = new TaskCompletionSource<>();\r\n\r\n        Executors.newSingleThreadExecutor().execute(() -> {\r\n            try {\r\n                // Revoke organizer role\r\n                Tasks.await(changeOrgPerms(organizerId, false));\r\n\r\n                // Find all events they own\r\n                QuerySnapshot organizerEvents = Tasks.await(\r\n                        db.collection(\"events\")\r\n                                .whereEqualTo(\"organizerId\", organizerId)\r\n                                .get()\r\n                );\r\n\r\n                // Delete each event\r\n                List<Task<Void>> deletes = new ArrayList<>();\r\n                for (DocumentSnapshot d : organizerEvents.getDocuments()) {\r\n                    deletes.add(deleteEvent(d.getId()));\r\n                }\r\n                Tasks.await(Tasks.whenAll(deletes));\r\n\r\n                tcs.setResult(null);\r\n            } catch (Exception e) {\r\n                tcs.setException(e);\r\n            }\r\n        });\r\n\r\n        return tcs.getTask();\r\n    }\r\n\r\n    public Task<List<UserProfile>> fetchProfiles(@Nullable UserRole roleFilter) {\r\n        TaskCompletionSource<List<UserProfile>> tcs = new TaskCompletionSource<>();\r\n\r\n        Executors.newSingleThreadExecutor().execute(() -> {\r\n            try {\r\n                Query q = db.collection(\"users\");\r\n                if (roleFilter == UserRole.ORGANIZER) {\r\n                    q = q.whereEqualTo(\"isOrganizer\", true);\r\n                } else if (roleFilter == UserRole.ENTRANT) {\r\n                    q = q.whereEqualTo(\"isOrganizer\", false);\r\n                }\r\n\r\n                QuerySnapshot snap = Tasks.await(q.get());\r\n\r\n                List<UserProfile> out = new ArrayList<>();\r\n                for (DocumentSnapshot d : snap.getDocuments()) {\r\n                    String userId = d.getId();\r\n                    String name = d.getString(\"name\");\r\n                    String image = d.getString(\"profileImageUrl\");\r\n                    Boolean isOrg = d.getBoolean(\"isOrganizer\");\r\n\r\n                    UserRole role = (isOrg != null && isOrg)\r\n                            ? UserRole.ORGANIZER\r\n                            : UserRole.ENTRANT;\r\n\r\n                    if (roleFilter == null || role == roleFilter) {out.add(new UserProfile(userId,\r\n                            name, role));\r\n                    }\r\n                }\r\n\r\n                tcs.setResult(out);\r\n            } catch (Exception e) {\r\n                tcs.setException(e);\r\n            }\r\n        });\r\n        return tcs.getTask();\r\n    }\r\n    /**\r\n     * Deletes a user profile based on their role.\r\n     *\r\n     * @param userId the Firestore document id of the user\r\n     * @param role   the user's current role\r\n     * @return a Task that completes when all writes are finished or fails with the underlying exception\r\n     */\r\n    public Task<Void> deleteProfile(String userId, com.example.magpie_wingman.data.model.UserRole role) {\r\n        if (role == com.example.magpie_wingman.data.model.UserRole.ORGANIZER) {\r\n            return deleteOrganizer(userId);\r\n        }\r\n        return deleteEntrant(userId);\r\n    }\r\n\r\n    /**\r\n     * Helper function that checks if user is in a waitlist\r\n     * @param eventId eventId of the event waitlist to check\r\n     * @param userId userId of the user to check\r\n     * @return\r\n     */\r\n    public Task<Boolean> isUserInWaitlist(String eventId, String userId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"waitlist\")\r\n                .document(userId)\r\n                .get()\r\n                .continueWith(task ->\r\n                        task.isSuccessful() && task.getResult() != null && task.getResult().exists());\r\n    }\r\n\r\n\r\n\r\n\r\n    /**\r\n     * Deletes an event document and its subcollections\r\n     * (\"waitlist\", \"registrable\", \"registered\") from Firestore.\r\n     *\r\n     * @param eventId The ID of the event to delete.\r\n     * @return A Task that completes when the delete finishes. Result is {@code null} if success.)\r\n     */\r\n    /**\r\n     * Deletes an event document and its subcollections\r\n     * (\"waitlist\", \"registrable\", \"registered\") from Firestore.\r\n     *\r\n     * @param eventId The ID of the event to delete.\r\n     * @return A Task that completes when the delete finishes. Result is {@code null} if success.)\r\n     */\r\n    public Task<Void> deleteEvent(String eventId) {\r\n        TaskCompletionSource<Void> tcs = new TaskCompletionSource<>(); //I create a custom task for methods that require multiple firestore tasks.\r\n\r\n        Executors.newSingleThreadExecutor().execute(() -> { //since we await here we want to create a background thread to avoid freezing UI\r\n            try {\r\n                // reference to the event doc to delete\r\n                DocumentReference eventRef = db.collection(\"events\").document(eventId);\r\n\r\n                // get subcollections' docs\r\n                QuerySnapshot waitlistSnap = Tasks.await( //we await to make sure we have all of the references to the subcollection before deleting everything\r\n                        eventRef.collection(\"waitlist\").get()\r\n                );\r\n                QuerySnapshot invitedSnap = Tasks.await(\r\n                        eventRef.collection(\"invited\").get()\r\n                );\r\n                QuerySnapshot registrableSnap = Tasks.await(\r\n                        eventRef.collection(\"registrable\").get()\r\n                );\r\n                QuerySnapshot registeredSnap = Tasks.await(\r\n                        eventRef.collection(\"registered\").get()\r\n                );\r\n                QuerySnapshot cancelledSnap = Tasks.await(\r\n                        eventRef.collection(\"cancelled\").get()\r\n                );\r\n\r\n                WriteBatch batch = db.batch();\r\n\r\n                // delete all user docs\r\n                for (DocumentSnapshot doc : waitlistSnap.getDocuments()) {\r\n                    batch.delete(doc.getReference());\r\n                }\r\n\r\n                for (DocumentSnapshot doc : invitedSnap.getDocuments()) {\r\n                    batch.delete(doc.getReference());\r\n                }\r\n\r\n                for (DocumentSnapshot doc : registrableSnap.getDocuments()) {\r\n                    batch.delete(doc.getReference());\r\n                }\r\n\r\n                for (DocumentSnapshot doc : registeredSnap.getDocuments()) {\r\n                    batch.delete(doc.getReference());\r\n                }\r\n\r\n                for (DocumentSnapshot doc : cancelledSnap.getDocuments()) {\r\n                    batch.delete(doc.getReference());\r\n                }\r\n\r\n                // now we can delete the actual event doc\r\n                batch.delete(eventRef);\r\n\r\n                // commit and wait until it's done\r\n                Tasks.await(batch.commit());\r\n\r\n                //if success set result to null (success)\r\n                tcs.setResult(null);\r\n            } catch (Exception e) {\r\n                tcs.setException(e); //exception handling\r\n            }\r\n        });\r\n\r\n        return tcs.getTask();\r\n    }\r\n//---------------------------------------------------------------------------------------------------------------------------\r\n//                                              Entrant List flow methods\r\n//---------------------------------------------------------------------------------------------------------------------------\r\n    /**\r\n     * Adds a userID document to the event document's waitlist subcollection (creates one if it doesn't exist yet)\r\n     * @param eventId - ID of event doc in question\r\n     * @param userId - ID of the user\r\n     * @return\r\n     */\r\n    public Task<Void> addUserToWaitlist(String eventId, String userId) {\r\n        Map<String, Object> data = new HashMap<>();\r\n        data.put(\"userId\", userId);\r\n        data.put(\"addedAt\", System.currentTimeMillis());  // simple timestamp\r\n\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"waitlist\")\r\n                .document(userId)\r\n                .set(data, SetOptions.merge());\r\n    }\r\n\r\n\r\n    /**\r\n     * Randomly selects count users from an event's waitlist and moves them\r\n     * to the \"invited\" subcollection in Firestore.\r\n     *\r\n     * @param eventId The ID of the event to update.\r\n     * @param count   The number of users to switch from waitlist to registrable.\r\n     * @return A google.android.gms.tasks.Task that completes when all Firestore\r\n     *         reads and writes are finished (result is null on success).\r\n     */\r\n    public Task<Void> drawInvitees(String eventId, int count) {\r\n        //create an empty task for this as its more complex. Will tell callers if and when it succeeds.\r\n        TaskCompletionSource<Void> tcs = new TaskCompletionSource<>();\r\n\r\n        // create a background thread so this doesn't freeze the UI (has an await).\r\n        Executors.newSingleThreadExecutor().execute(() -> {\r\n            try {\r\n                //query the waitlist subcollection\r\n                QuerySnapshot waitlistSnap = Tasks.await(\r\n                        db.collection(\"events\")\r\n                                .document(eventId)\r\n                                .collection(\"waitlist\")\r\n                                .get()\r\n                );\r\n\r\n                List<DocumentSnapshot> waitlistDocs = waitlistSnap.getDocuments(); //list of waitlist user documents\r\n\r\n                if (waitlistDocs.isEmpty() || count <= 0) {\r\n                    tcs.setResult(null);\r\n                    return;\r\n                }\r\n\r\n                // randomize order of the waitlist users\r\n                Collections.shuffle(waitlistDocs, random);\r\n\r\n                // select first x users\r\n                int actualCount = Math.min(count, waitlistDocs.size());\r\n\r\n                //Use batch to reduce number of read/writes\r\n                WriteBatch batch = db.batch();\r\n\r\n                for (int i = 0; i < actualCount; i++) {\r\n                    DocumentSnapshot userDoc = waitlistDocs.get(i);\r\n                    String userId = userDoc.getId();\r\n\r\n                    DocumentReference waitlistRef = db.collection(\"events\")\r\n                            .document(eventId)\r\n                            .collection(\"waitlist\")\r\n                            .document(userId);\r\n\r\n                    // winners now go into \"invited\" first\r\n                    DocumentReference invitedRef = db.collection(\"events\")\r\n                            .document(eventId)\r\n                            .collection(\"invited\")\r\n                            .document(userId);\r\n\r\n                    Map<String, Object> regData = new HashMap<>();\r\n                    regData.put(\"userId\", userId);\r\n                    regData.put(\"invitedAt\", System.currentTimeMillis());\r\n\r\n                    batch.set(invitedRef, regData, SetOptions.merge());\r\n                    batch.delete(waitlistRef);\r\n                }\r\n\r\n                // commit the changes in a batch. We await before returning the task\r\n                Tasks.await(batch.commit());\r\n\r\n                // If no exceptions, set the task result to success (null)\r\n                tcs.setResult(null);\r\n\r\n                // If not, set the result to the exception.\r\n            } catch (Exception e) {\r\n                tcs.setException(e);\r\n            }\r\n        });\r\n        //return the task result to the caller\r\n        return tcs.getTask();\r\n    }\r\n    /**\r\n     * Moves a user from the \"invited\" subcollection to \"registrable\"\r\n     * when they accept an invitation.\r\n     *\r\n     * @param eventId The event to update.\r\n     * @param userId  The user accepting the invitation.\r\n     * @return A Task that completes when the move finishes.\r\n     */\r\n    public Task<Void> moveUserFromInvitedToRegistrable(String eventId, String userId) {\r\n\r\n        WriteBatch batch = db.batch();\r\n\r\n        com.google.firebase.firestore.DocumentReference invitedRef =\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"invited\")\r\n                        .document(userId);\r\n\r\n        com.google.firebase.firestore.DocumentReference registrableRef =\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registrable\")\r\n                        .document(userId);\r\n\r\n        Map<String, Object> data = new HashMap<>();\r\n        data.put(\"userId\", userId);\r\n        data.put(\"acceptedAt\", System.currentTimeMillis());\r\n\r\n        batch.set(registrableRef, data, SetOptions.merge());\r\n        batch.delete(invitedRef);\r\n\r\n        return batch.commit();\r\n    }\r\n    public Task<Void> addUserToRegistered(String eventId, String userId) {\r\n\r\n        com.google.firebase.firestore.WriteBatch batch = db.batch();\r\n\r\n        // source doc (registrable)\r\n        com.google.firebase.firestore.DocumentReference registrableRef =\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registrable\")\r\n                        .document(userId);\r\n\r\n        // target doc (registered)\r\n        com.google.firebase.firestore.DocumentReference registeredRef =\r\n                db.collection(\"events\")\r\n                        .document(eventId)\r\n                        .collection(\"registered\")\r\n                        .document(userId);\r\n\r\n        // copy minimal data\r\n        Map<String, Object> data = new HashMap<>();\r\n        data.put(\"userId\", userId);\r\n        data.put(\"movedAt\", System.currentTimeMillis());\r\n\r\n        // write to registered\r\n        batch.set(registeredRef, data, SetOptions.merge());\r\n        // delete from registrable\r\n        batch.delete(registrableRef);\r\n\r\n        return batch.commit();\r\n    }\r\n\r\n//----------------------------------------------------------------------------------------------------------------------\r\n//                                                Cancels\r\n//----------------------------------------------------------------------------------------------------------------------\r\n    /**\r\n     * Removes the given user from the waitlist of the given event.\r\n     *\r\n     * @param eventId The event to update.\r\n     * @param userId  The user to remove.\r\n     * @return A Task that completes when the delete finishes.\r\n     */\r\n    public Task<Void> cancelWaitlist(String eventId, String userId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"waitlist\")\r\n                .document(userId)\r\n                .delete();\r\n    }\r\n\r\n\r\n    /**\r\n     * Removes the given user from the invited subcollection of the given event,\r\n     * moving them into the \"cancelled\" subcollection.\r\n     *\r\n     * @param eventId The event to update.\r\n     * @param userId  The user to remove.\r\n     * @return A Task that completes when the move finishes.\r\n     */\r\n    public Task<Void> cancelInvited(String eventId, String userId) {\r\n        WriteBatch batch = db.batch();\r\n\r\n        DocumentReference invitedRef = db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"invited\")\r\n                .document(userId);\r\n\r\n        DocumentReference cancelledRef = db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"cancelled\")\r\n                .document(userId);\r\n\r\n        Map<String, Object> data = new HashMap<>();\r\n        data.put(\"userId\", userId);\r\n        data.put(\"cancelledAt\", System.currentTimeMillis());\r\n        data.put(\"fromStatus\", \"invited\");\r\n\r\n        batch.set(cancelledRef, data, SetOptions.merge());\r\n        batch.delete(invitedRef);\r\n\r\n        return batch.commit();\r\n    }\r\n    /**\r\n     * Removes the given user from the registrable of the given event.\r\n     *\r\n     * @param eventId The event to update.\r\n     * @param userId  The user to remove.\r\n     * @return A Task that completes when the delete finishes.\r\n     */\r\n    public Task<Void> cancelRegistrable(String eventId, String userId) {\r\n        WriteBatch batch = db.batch();\r\n\r\n        DocumentReference registrableRef = db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"registrable\")\r\n                .document(userId);\r\n\r\n        DocumentReference cancelledRef = db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"cancelled\")\r\n                .document(userId);\r\n\r\n        Map<String, Object> data = new HashMap<>();\r\n        data.put(\"userId\", userId);\r\n        data.put(\"cancelledAt\", System.currentTimeMillis());\r\n        data.put(\"fromStatus\", \"registrable\");\r\n\r\n        batch.set(cancelledRef, data, SetOptions.merge());\r\n        batch.delete(registrableRef);\r\n\r\n        return batch.commit();\r\n    }\r\n    /**\r\n     * Removes the given user from the registered subcollection of the given event.\r\n     *\r\n     * @param eventId The event to update.\r\n     * @param userId  The user to remove.\r\n     * @return A Task that completes when the delete finishes.\r\n     */\r\n    public Task<Void> cancelRegistered(String eventId, String userId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"registered\")\r\n                .document(userId)\r\n                .delete();\r\n    }\r\n    /**\r\n     * Updates the user's display name.\r\n     *\r\n     * @param userId  ID of the user document to update.\r\n     * @param newName New name to set.\r\n     * @return Task that completes when the update finishes.\r\n     */\r\n    public Task<Void> updateName(String userId, String newName) {\r\n        return db.collection(\"users\")\r\n                .document(userId)\r\n                .update(\"name\", newName);\r\n    }\r\n\r\n    /**\r\n     * Updates the user's email address.\r\n     *\r\n     * @param userId   ID of the user document to update.\r\n     * @param newEmail New email to set.\r\n     * @return Task that completes when the update finishes.\r\n     */\r\n    public Task<Void> updateEmail(String userId, String newEmail) {\r\n        return db.collection(\"users\")\r\n                .document(userId)\r\n                .update(\"email\", newEmail);\r\n    }\r\n\r\n    /**\r\n     * Updates the user's phone number.\r\n     *\r\n     * @param userId     ID of the user document to update.\r\n     * @param newPhone   New phone number to set.\r\n     * @return Task that completes when the update finishes.\r\n     */\r\n    public Task<Void> updatePhoneNumber(String userId, String newPhone) {\r\n        return db.collection(\"users\")\r\n                .document(userId)\r\n                .update(\"phone\", newPhone);\r\n    }\r\n\r\n    /**\r\n     * Changes a user's organizer permissions.\r\n     *\r\n     * @param userId      The ID of the user to update.\r\n     * @param isOrganizer True to grant organizer permissions; false to revoke them.\r\n     * @return A Task that completes when the update finishes.\r\n     */\r\n    public Task<Void> changeOrgPerms(String userId, boolean isOrganizer) {\r\n        return db.collection(\"users\")\r\n                .document(userId)\r\n                .update(\"isOrganizer\", isOrganizer);\r\n    }\r\n\r\n    /**\r\n     * Gets the user's name from Firestore.\r\n     *\r\n     * @param userId ID of the user document.\r\n     * @return Task resolving to the user's name.\r\n     */\r\n    public Task<String> getUserName(String userId) {\r\n        return db.collection(\"users\").document(userId)\r\n                .get()\r\n                .continueWith(task -> task.getResult().getString(\"name\"));\r\n    }\r\n\r\n    /**\r\n     * Gets the user's email from Firestore.\r\n     *\r\n     * @param userId ID of the user document.\r\n     * @return Task resolving to the user's email.\r\n     */\r\n    public Task<String> getUserEmail(String userId) {\r\n        return db.collection(\"users\").document(userId)\r\n                .get()\r\n                .continueWith(task -> task.getResult().getString(\"email\"));\r\n    }\r\n\r\n    /**\r\n     * Gets whether the user is an organizer.\r\n     *\r\n     * @param userId ID of the user document.\r\n     * @return Task resolving to true if organizer, false otherwise.\r\n     */\r\n    public Task<Boolean> getIsOrganizer(String userId) {\r\n        return db.collection(\"users\").document(userId)\r\n                .get()\r\n                .continueWith(task -> task.getResult().getBoolean(\"isOrganizer\"));\r\n    }\r\n\r\n    /**\r\n     * Gets the user's phone number.\r\n     *\r\n     * @param userId ID of the user document.\r\n     * @return Task resolving to the user's phone number.\r\n     */\r\n    public Task<String> getUserPhone(String userId) {\r\n        return db.collection(\"users\").document(userId)\r\n                .get()\r\n                .continueWith(task -> task.getResult().getString(\"phone\"));\r\n    }\r\n\r\n    /**\r\n     * Gets the device ID stored for the user.\r\n     *\r\n     * @param userId ID of the user document.\r\n     * @return Task resolving to the user's device ID.\r\n     */\r\n    public Task<String> getUserDeviceId(String userId) {\r\n        return db.collection(\"users\").document(userId)\r\n                .get()\r\n                .continueWith(task -> task.getResult().getString(\"deviceId\"));\r\n    }\r\n    /**\r\n     * Gets the organizer ID associated with a given event.\r\n     *\r\n     * @param eventId The unique identifier of the event.\r\n     * @return A Task that resolves to the organizer's user ID as a String,\r\n     *         or null if the event does not exist or the field is missing.\r\n     */\r\n    public Task<String> getEventOrganizer(String eventId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .get()\r\n                .continueWith(task -> {\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return null;\r\n                    }\r\n                    return task.getResult().getString(\"organizerId\");\r\n                });\r\n    }\r\n\r\n\r\n    /**\r\n     * Gets the description of a given event.\r\n     *\r\n     * @param eventId The unique identifier of the event.\r\n     * @return A Task that resolves to the event's description as a String,\r\n     *         or null if the event does not exist or the field is missing.\r\n     */\r\n    public Task<String> getEventDescription(String eventId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .get()\r\n                .continueWith(task -> {\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return null;\r\n                    }\r\n                    return task.getResult().getString(\"description\");\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Retrieves the registration period start value for a given event.\r\n     *\r\n     * @param eventId The unique identifier of the event.\r\n     * @return A Task that resolves to the registration start Object,\r\n     *         or null if the event does not exist or the field is missing.\r\n     */\r\n    public Task<Object> getEventRegistrationStart(String eventId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .get()\r\n                .continueWith(task -> {\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return null;\r\n                    }\r\n                    // you saved regStart as Object, so return as-is\r\n                    return task.getResult().get(\"registrationStart\");\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Retrieves the registration period end value for a given event.\r\n\r\n     * @param eventId The unique identifier of the event.\r\n     * @return A Task that resolves to the registration end Object,\r\n     *         or null if the event does not exist or the field is missing.\r\n     */\r\n    public Task<Object> getEventRegistrationEnd(String eventId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .get()\r\n                .continueWith(task -> {\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return null;\r\n                    }\r\n                    return task.getResult().get(\"registrationEnd\");\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Retrieves all user IDs currently on the waitlist for a given event.\r\n     *\r\n     * @param eventId The unique identifier of the event.\r\n     * @return A Task that resolves to a List of user IDs (Strings)\r\n     *         representing users in the \"waitlist\" subcollection.\r\n     *         Returns an empty list if the event or subcollection is missing.\r\n     */\r\n    public Task<List<String>> getEventWaitlist(String eventId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"waitlist\")\r\n                .get()\r\n                .continueWith(task -> {\r\n                    List<String> users = new ArrayList<>();\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return users;\r\n                    }\r\n                    for (DocumentSnapshot doc : task.getResult().getDocuments()) {\r\n                        users.add(doc.getId());\r\n                    }\r\n                    return users;\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Retrieves all user IDs currently marked as invited for a given event.\r\n     *\r\n     * @param eventId The unique identifier of the event.\r\n     * @return A Task that resolves to a List of user IDs (Strings)\r\n     *         representing users in the \"invited\" subcollection.\r\n     *         Returns an empty list if the event or subcollection is missing.\r\n     */\r\n    public Task<List<String>> getEventInvited(String eventId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"invited\")\r\n                .get()\r\n                .continueWith(task -> {\r\n                    List<String> users = new ArrayList<>();\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return users;\r\n                    }\r\n                    for (DocumentSnapshot doc : task.getResult().getDocuments()) {\r\n                        users.add(doc.getId());\r\n                    }\r\n                    return users;\r\n                });\r\n    }\r\n    /**\r\n     * Retrieves all user IDs currently marked as registrable for a given event.\r\n     *\r\n     * @param eventId The unique identifier of the event.\r\n     * @return A Task that resolves to a List of user IDs (Strings)\r\n     *         representing users in the \"registrable\" subcollection.\r\n     *         Returns an empty list if the event or subcollection is missing.\r\n     */\r\n    public Task<List<String>> getEventRegistrable(String eventId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"registrable\")\r\n                .get()\r\n                .continueWith(task -> {\r\n                    List<String> users = new ArrayList<>();\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return users;\r\n                    }\r\n                    for (DocumentSnapshot doc : task.getResult().getDocuments()) {\r\n                        users.add(doc.getId());\r\n                    }\r\n                    return users;\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Retrieves all user IDs currently registered for a given event.\r\n     *\r\n     * @param eventId The unique identifier of the event.\r\n     * @return A Task that resolves to a List of user IDs (Strings)\r\n     *         representing users in the \"registered\" subcollection.\r\n     *         Returns an empty list if the event or subcollection is missing.\r\n     */\r\n    public Task<List<String>> getEventRegistered(String eventId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"registered\")\r\n                .get()\r\n                .continueWith(task -> {\r\n                    List<String> users = new ArrayList<>();\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return users;\r\n                    }\r\n                    for (DocumentSnapshot doc : task.getResult().getDocuments()) {\r\n                        users.add(doc.getId());\r\n                    }\r\n                    return users;\r\n                });\r\n    }\r\n\r\n    public Task<QuerySnapshot> getEventsByOrganizer(String organizerId) {\r\n        return db.collection(\"events\")\r\n                .whereEqualTo(\"organizerId\", organizerId)\r\n                .get();\r\n    }\r\n\r\n    /**\r\n     * Updates the user's password.\r\n     *\r\n     * @param userId     ID of the user document to update.\r\n     * @param newPassword   New password.\r\n     * @return Task that completes when the update finishes.\r\n     */\r\n    public Task <Void> updatePassword(String userId, String newPassword) {\r\n        return db.collection(\"users\")\r\n                .document(userId)\r\n                .update(\"password\", newPassword);\r\n    }\r\n\r\n    /**\r\n     * Adds/Updates user's date of birth.\r\n     *\r\n     * @param userId     ID of the user document to update.\r\n     * @param newDOB   New phone number to set.\r\n     * @return Task that completes when the update finishes.\r\n     */\r\n\r\n    public Task<Void> updateDOB(String userId, Date newDOB) {\r\n        return db.collection(\"users\")\r\n                .document(userId)\r\n                .update(\"dateOfBirth\", newDOB);\r\n    }\r\n\r\n    public Task<String> findUserByDeviceId(String deviceId) {\r\n        return db.collection(\"users\")\r\n                .whereEqualTo(\"deviceId\", deviceId)\r\n                .whereEqualTo(\"rememberMe\", true)   // only consider rememberme users\r\n                .limit(1)\r\n                .get()\r\n                .continueWith(task -> {\r\n                    if (!task.isSuccessful() || task.getResult() == null || task.getResult().isEmpty()) {\r\n                        return null; // No remembered user on this device\r\n                    }\r\n                    return task.getResult().getDocuments().get(0).getId(); // Return userId\r\n                });\r\n    }\r\n\r\n\r\n    /**\r\n     * Logs in a user by email + password.\r\n     *\r\n     * Firestore schema assumptions:\r\n     *  - Collection: \"users\"\r\n     *  - Fields: \"email\" (String), \"password\" (String), plus whatever else your User model has.\r\n     *\r\n     * @param email    User's email address.\r\n     * @param password User's password (plain-text for this assignment).\r\n     * @return Task resolving to the matching User on success, or failing with an Exception on error.\r\n     */\r\n    public Task<User> loginWithEmailAndPassword(String email, String password) {\r\n        return db.collection(\"users\")\r\n                .whereEqualTo(\"email\", email)\r\n                .limit(1)\r\n                .get()\r\n                .continueWith(task -> {\r\n                    if (!task.isSuccessful()) {\r\n                        throw task.getException() != null\r\n                                ? task.getException()\r\n                                : new Exception(\"Login query failed\");\r\n                    }\r\n\r\n                    QuerySnapshot snap = task.getResult();\r\n                    if (snap == null || snap.isEmpty()) {\r\n                        throw new Exception(\"Invalid email or password\");\r\n                    }\r\n\r\n                    DocumentSnapshot doc = snap.getDocuments().get(0);\r\n\r\n                    // Check password directly from the document\r\n                    String storedPassword = doc.getString(\"password\");\r\n                    if (storedPassword == null || !storedPassword.equals(password)) {\r\n                        throw new Exception(\"Invalid email or password\");\r\n                    }\r\n\r\n                    // Build a proper User with the correct, immutable userId\r\n                    return User.from(doc);\r\n                });\r\n    }\r\n\r\n    public com.google.android.gms.tasks.Task<Boolean> isEmailInUse(String email) {\r\n        return db.collection(\"users\")\r\n                .whereEqualTo(\"email\", email)\r\n                .limit(1)\r\n                .get()\r\n                .continueWith(task -> {\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        // Treat failure as \"not in use\" for now, but you can tighten this if you want\r\n                        return false;\r\n                    }\r\n                    return !task.getResult().isEmpty();\r\n                });\r\n    }\r\n\r\n    public com.google.android.gms.tasks.Task<Void> updateDOBByEmail(String email, java.util.Date newDOB) {\r\n        return db.collection(\"users\")\r\n                .whereEqualTo(\"email\", email)\r\n                .limit(1)\r\n                .get()\r\n                .continueWithTask(task -> {\r\n                    if (!task.isSuccessful() || task.getResult() == null || task.getResult().isEmpty()) {\r\n                        // No user found or error; you can also choose to throw here instead\r\n                        return com.google.android.gms.tasks.Tasks.forResult(null);\r\n                    }\r\n\r\n                    String userId = task.getResult().getDocuments().get(0).getId();\r\n                    return updateDOB(userId, newDOB);\r\n                });\r\n    }\r\n\r\n    public Task<Void> updateRememberMe(String userId, boolean rememberMe) {\r\n        return db.collection(\"users\")\r\n                .document(userId)\r\n                .update(\"rememberMe\", rememberMe);\r\n    }\r\n\r\n    /**\r\n     * Fetches all events from the \"events\" collection as Event models\r\n     * for use in entrant lists.\r\n     */\r\n    public Task<List<Event>> getAllEvents() {\r\n        return db.collection(\"events\")\r\n                .get()\r\n                .continueWith(task -> {\r\n                    List<Event> results = new ArrayList<>();\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return results;\r\n                    }\r\n\r\n                    for (DocumentSnapshot doc : task.getResult().getDocuments()) {\r\n                        // Let Firestore populate the Event\r\n                        Event e = doc.toObject(Event.class);\r\n                        if (e == null) continue;\r\n\r\n                        // Ensure eventId is set even if it's not stored as a field\r\n                        if (e.getEventId() == null || e.getEventId().isEmpty()) {\r\n                            e.setEventId(doc.getId());\r\n                        }\r\n\r\n                        results.add(e);\r\n                    }\r\n                    return results;\r\n                });\r\n    }\r\n\r\n    public Task<String> uploadEventPoster(String eventId, Uri localUri) {\r\n        StorageReference ref = storage\r\n                .getReference()\r\n                .child(\"event_posters/\" + eventId + \".jpg\");\r\n\r\n        return ref.putFile(localUri)\r\n                .continueWithTask(task -> {\r\n                    if (!task.isSuccessful()) {\r\n                        throw task.getException();\r\n                    }\r\n                    return ref.getDownloadUrl();\r\n                })\r\n                .continueWithTask(task -> {\r\n                    Uri downloadUri = task.getResult();\r\n                    return db.collection(\"events\")\r\n                            .document(eventId)\r\n                            .update(\"eventPosterURL\", downloadUri.toString())\r\n                            .continueWith(t -> downloadUri.toString());\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Removes the poster associated with an event.\r\n     * <p>\r\n     * Behaviour:\r\n     * <ul>\r\n     *     <li>If {@code posterUrl} is a Firebase Storage URL, the underlying file is deleted.</li>\r\n     *     <li>Regardless of storage delete success, the {@code eventPosterURL} field\r\n     *         in the event document is cleared (set to null).</li>\r\n     * </ul>\r\n     *\r\n     * @param eventId   ID of the event document in the \"events\" collection.\r\n     * @param posterUrl The current poster URL, or {@code null} / empty if missing.\r\n     * @return A Task that completes when the field is cleared (and storage delete attempted).\r\n     */\r\n    public Task<Void> removeEventPoster(String eventId, @Nullable String posterUrl) {\r\n        TaskCompletionSource<Void> tcs = new TaskCompletionSource<>();\r\n\r\n        // Helper to just clear the Firestore field\r\n        Runnable clearField = () -> db.collection(\"events\")\r\n                .document(eventId)\r\n                .update(\"eventPosterURL\", null)\r\n                .addOnSuccessListener(unused -> tcs.setResult(null))\r\n                .addOnFailureListener(tcs::setException);\r\n\r\n        // No URL? Just clear the field.\r\n        if (posterUrl == null || posterUrl.isEmpty()) {\r\n            clearField.run();\r\n            return tcs.getTask();\r\n        }\r\n\r\n        StorageReference ref;\r\n        try {\r\n            ref = storage.getReferenceFromUrl(posterUrl);\r\n        } catch (IllegalArgumentException e) {\r\n            // Not a Firebase Storage URL; just clear the field.\r\n            clearField.run();\r\n            return tcs.getTask();\r\n        }\r\n\r\n        // Try deleting the file; regardless of success, clear the field.\r\n        ref.delete()\r\n                .addOnSuccessListener(unused -> clearField.run())\r\n                .addOnFailureListener(e -> clearField.run());\r\n\r\n        return tcs.getTask();\r\n    }\r\n\r\n    /**\r\n     * Fetches all notifications sent to entrants, across all users.\r\n     *\r\n     * Notifications live under:\r\n     *   users/{userId}/notifications/{notificationId}\r\n     *\r\n     * Uses a collection group query on \"notifications\".\r\n     */\r\n    public Task<java.util.List<Notification>> getAllNotifications() {\r\n        return db.collectionGroup(\"notifications\")\r\n//                .orderBy(\"timestamp\", Query.Direction.DESCENDING)\r\n                .get()\r\n                .continueWith(task -> {\r\n                    if (!task.isSuccessful()) {\r\n                        // surface the real error to the caller\r\n                        throw task.getException() != null\r\n                                ? task.getException()\r\n                                : new Exception(\"Failed to fetch notifications\");\r\n                    }\r\n\r\n                    java.util.List<Notification> out = new java.util.ArrayList<>();\r\n                    if (task.getResult() == null) {\r\n                        return out;\r\n                    }\r\n\r\n                    for (DocumentSnapshot d : task.getResult().getDocuments()) {\r\n                        out.add(Notification.from(d));\r\n                    }\r\n                    return out;\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Cancels all entrants who did not sign up (US 02.06.04):\r\n     * - Moves all docs from \"waitlist\" and \"registrable\" into \"cancelled\"\r\n     * - Removes them from those subcollections.\r\n     *\r\n     * @param eventId the event to update.\r\n     * @return Task that completes when all writes are done.\r\n     */\r\n    public Task<Void> cancelNonRegisteredEntrants(String eventId) {\r\n        FirebaseFirestore db = getDb();\r\n        DocumentReference eventRef = db.collection(\"events\").document(eventId);\r\n\r\n        CollectionReference waitlistRef   = eventRef.collection(\"waitlist\");\r\n        CollectionReference registrableRef= eventRef.collection(\"registrable\");\r\n        CollectionReference cancelledRef  = eventRef.collection(\"cancelled\");\r\n\r\n        Task<QuerySnapshot> wTask = waitlistRef.get();\r\n        Task<QuerySnapshot> rTask = registrableRef.get();\r\n\r\n        return Tasks.whenAllSuccess(wTask, rTask)\r\n                .onSuccessTask(list -> {\r\n                    List<Task<Void>> writes = new ArrayList<>();\r\n\r\n                    QuerySnapshot waitlist = wTask.getResult();\r\n                    QuerySnapshot registrable = rTask.getResult();\r\n\r\n                    if (waitlist != null) {\r\n                        for (DocumentSnapshot d : waitlist.getDocuments()) {\r\n                            writes.add(cancelledRef.document(d.getId()).set(d.getData()));\r\n                            writes.add(waitlistRef.document(d.getId()).delete());\r\n                        }\r\n                    }\r\n                    if (registrable != null) {\r\n                        for (DocumentSnapshot d : registrable.getDocuments()) {\r\n                            writes.add(cancelledRef.document(d.getId()).set(d.getData()));\r\n                            writes.add(registrableRef.document(d.getId()).delete());\r\n                        }\r\n                    }\r\n\r\n                    return Tasks.whenAll(writes);\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Retrieves all user IDs currently in the \"cancelled\" subcollection of a given event.\r\n     *\r\n     * @param eventId The unique identifier of the event.\r\n     * @return A Task that resolves to a List of user IDs (Strings)\r\n     *         representing users in the \"cancelled\" subcollection.\r\n     */\r\n    public Task<List<String>> getEventCancelled(String eventId) {\r\n        return db.collection(\"events\")\r\n                .document(eventId)\r\n                .collection(\"cancelled\")\r\n                .get()\r\n                .continueWith(task -> {\r\n                    List<String> users = new ArrayList<>();\r\n                    if (!task.isSuccessful() || task.getResult() == null) {\r\n                        return users;\r\n                    }\r\n                    for (DocumentSnapshot doc : task.getResult().getDocuments()) {\r\n                        users.add(doc.getId());\r\n                    }\r\n                    return users;\r\n                });\r\n    }\r\n\r\n\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/data/DbManager.java b/app/src/main/java/com/example/magpie_wingman/data/DbManager.java
--- a/app/src/main/java/com/example/magpie_wingman/data/DbManager.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/data/DbManager.java	(date 1764449277199)
@@ -30,6 +30,7 @@
 import java.util.List;
 import java.util.Locale;
 import java.util.Map;
+import java.util.concurrent.Executor;
 import java.util.concurrent.Executors;
 import android.net.Uri;
 
@@ -454,14 +455,21 @@
 //---------------------------------------------------------------------------------------------------------------------------
     /**
      * Adds a userID document to the event document's waitlist subcollection (creates one if it doesn't exist yet)
+     * If lat/lng are provided for location they will be stored as well
      * @param eventId - ID of event doc in question
      * @param userId - ID of the user
+     * @param lat - optional lat
+     * @param lng - optional lng
      * @return
      */
-    public Task<Void> addUserToWaitlist(String eventId, String userId) {
+    public Task<Void> addUserToWaitlist(String eventId, String userId, @Nullable Double lat, @Nullable Double lng) {
         Map<String, Object> data = new HashMap<>();
         data.put("userId", userId);
         data.put("addedAt", System.currentTimeMillis());  // simple timestamp
+        if (lat != null && lng != null) {
+            data.put("latitude", lat);
+            data.put("longitude", lng);
+        }
 
         return db.collection("events")
                 .document(eventId)
@@ -1316,5 +1324,90 @@
     }
 
 
+    /**
+     * Returns all events that the given user has signed up for
+     * used in Entrant Event Fragment
+     *
+     * @param User ID of the entrant user
+     * @return Task resolving to a List of Event models.
+     */
+    public Task<List<Event>> getEntrantEventHistory(String userId)  {
+        TaskCompletionSource<List<Event>> tcs = new TaskCompletionSource<>();
+        Executors.newSingleThreadExecutor().execute(() ->{
+            try {
+                // Get all events once
+                QuerySnapshot eventsSnap = Tasks.await(db.collection("events").get());
+
+                List<Event> history = new ArrayList<>();
+
+                for (DocumentSnapshot ev : eventsSnap.getDocuments()) {
+                    DocumentReference evRef = ev.getReference();
+
+                    boolean hasRegistration = false;
+
+                    // Check waitlist
+                    QuerySnapshot wl = Tasks.await(evRef.collection("waitlist")
+                                            .whereEqualTo("userId", userId)
+                                            .get()
+                            );
+                    if (!wl.isEmpty()) {
+                        hasRegistration = true;
+                    } else {
+                        // Check registrable
+                        QuerySnapshot rg =
+                                Tasks.await(
+                                        evRef.collection("registrable")
+                                                .whereEqualTo("userId", userId)
+                                                .get()
+                                );
+                        if (!rg.isEmpty()) {
+                            hasRegistration = true;
+                        } else {
+                            // Check registered
+                            QuerySnapshot rd =
+                                    Tasks.await(evRef.collection("registered")
+                                                    .whereEqualTo("userId", userId)
+                                                    .get()
+                                    );
+                            if (!rd.isEmpty()) {
+                                hasRegistration = true;
+                            }
+                        }
+                    }
+
+                    if (hasRegistration) {
+                        Event e = ev.toObject(Event.class);
+                        if (e != null) {
+                            // Ensure eventId is set even if it isn't a field in the doc
+                            if (e.getEventId() == null || e.getEventId().isEmpty()) {
+                                e.setEventId(ev.getId());
+                            }
+                            history.add(e);
+                        }
+                    }
+                }
+
+                tcs.setResult(history);
+            } catch (Exception e) {
+                tcs.setException(e);
+            }
+        });
+
+        return tcs.getTask();
+    }
+
+    public Task<Void> updateNotificationPrefs(String userId,
+                                              @Nullable Boolean notifAdmin,
+                                              @Nullable Boolean notifOrg) {
+        Map<String, Object> updates = new HashMap<>();
+        if (notifAdmin != null) {
+            updates.put("notifAdmin", notifAdmin);
+        }
+        if (notifOrg != null) {
+            updates.put("notifOrganizer", notifOrg);
+        }
+        return db.collection("users").document(userId).update(updates);
+    }
+
 }
 
Index: app/src/main/res/layout/fragment_organizer_event_details.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<ScrollView\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"#0B0B18\"\r\n    tools:context=\".organizer.OrganizerEventDetailsFragment\">\r\n\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"vertical\">\r\n\r\n        <!-- HEADER -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"56dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:gravity=\"center_vertical\"\r\n            android:background=\"@android:color/white\"\r\n            android:paddingHorizontal=\"12dp\">\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/button_back\"\r\n                android:layout_width=\"28dp\"\r\n                android:layout_height=\"28dp\"\r\n                android:src=\"@drawable/ic_arrow_back\"\r\n                android:background=\"@android:color/transparent\"\r\n                android:contentDescription=\"Back\"\r\n                app:tint=\"#000000\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/image_logo\"\r\n                android:layout_width=\"28dp\"\r\n                android:layout_height=\"28dp\"\r\n                android:layout_marginStart=\"8dp\"\r\n                android:src=\"@drawable/wingman_logo\"\r\n                android:contentDescription=\"Logo\"/>\r\n\r\n            <TextView\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginStart=\"8dp\"\r\n                android:text=\"Event Details\"\r\n                android:textSize=\"18sp\"\r\n                android:textStyle=\"bold\"\r\n                android:textColor=\"#000000\"/>\r\n        </LinearLayout>\r\n\r\n        <!-- EVENT SUMMARY CARD -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:background=\"@drawable/rounded_white\"\r\n            android:orientation=\"horizontal\"\r\n            android:padding=\"12dp\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:layout_marginHorizontal=\"16dp\"\r\n            android:gravity=\"center_vertical\">\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:orientation=\"vertical\">\r\n\r\n                <TextView\r\n                    android:id=\"@+id/text_event_title\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"Title\"\r\n                    android:textStyle=\"bold\"\r\n                    android:textSize=\"16sp\"\r\n                    android:textColor=\"#000000\"/>\r\n\r\n                <TextView\r\n                    android:id=\"@+id/text_event_location\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"Location\"\r\n                    android:textSize=\"14sp\"\r\n                    android:textColor=\"#000000\"/>\r\n\r\n                <TextView\r\n                    android:id=\"@+id/text_event_date_time\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"Date - Time\"\r\n                    android:textSize=\"12sp\"\r\n                    android:textColor=\"#000000\"/>\r\n\r\n                <TextView\r\n                    android:id=\"@+id/text_event_description\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"Description: Lorem ipsum dolor sit amet...\"\r\n                    android:textSize=\"13sp\"\r\n                    android:layout_marginTop=\"4dp\"\r\n                    android:textColor=\"#000000\"/>\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"vertical\"\r\n                android:gravity=\"center\">\r\n\r\n                <ImageView\r\n                    android:id=\"@+id/image_qr\"\r\n                    android:layout_width=\"48dp\"\r\n                    android:layout_height=\"48dp\"\r\n                    android:src=\"@drawable/ic_qr_code\"\r\n                    android:contentDescription=\"QR Code\"\r\n                    android:tint=\"#000000\"\r\n                    android:layout_marginBottom=\"8dp\"/>\r\n\r\n                <ImageView\r\n                    android:id=\"@+id/image_event_poster\"\r\n                    android:layout_width=\"48dp\"\r\n                    android:layout_height=\"48dp\"\r\n                    android:src=\"@android:drawable/ic_menu_gallery\"\r\n                    android:scaleType=\"centerCrop\"\r\n                    android:contentDescription=\"Poster\"/>\r\n            </LinearLayout>\r\n        </LinearLayout>\r\n\r\n        <!-- BLUE NAVIGATION BUTTONS -->\r\n        <Button\r\n            android:id=\"@+id/btn_waiting_list\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"Waiting List\"\r\n            android:textSize=\"16sp\"\r\n            android:textColor=\"#FFFFFF\"\r\n            android:backgroundTint=\"#3A5BFF\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:layout_marginHorizontal=\"16dp\"/>\r\n\r\n        <Button\r\n            android:id=\"@+id/btn_selected_list\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"Invited Entrants List\"\r\n            android:textSize=\"16sp\"\r\n            android:textColor=\"#FFFFFF\"\r\n            android:backgroundTint=\"#3A5BFF\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:layout_marginHorizontal=\"16dp\"/>\r\n\r\n        <Button\r\n            android:id=\"@+id/btn_accepted_list\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"Signed-up Entrants List\"\r\n            android:textSize=\"16sp\"\r\n            android:textColor=\"#FFFFFF\"\r\n            android:backgroundTint=\"#3A5BFF\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:layout_marginHorizontal=\"16dp\"/>\r\n\r\n        <Button\r\n            android:id=\"@+id/btn_cancelled_list\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"Cancelled List\"\r\n            android:textSize=\"16sp\"\r\n            android:textColor=\"#FFFFFF\"\r\n            android:backgroundTint=\"#3A5BFF\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:layout_marginHorizontal=\"16dp\"/>\r\n\r\n        <!-- LOTTERY / NOTIFY / CANCEL ROW -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"horizontal\"\r\n            android:layout_marginTop=\"12dp\"\r\n            android:gravity=\"center\"\r\n            android:layout_marginHorizontal=\"16dp\">\r\n\r\n            <Button\r\n                android:id=\"@+id/btn_lottery\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Lottery\"\r\n                android:textColor=\"#FFFFFF\"\r\n                android:backgroundTint=\"#3A5BFF\"/>\r\n\r\n            <Button\r\n                android:id=\"@+id/btn_notify\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Notify\"\r\n                android:textColor=\"#000000\"\r\n                android:backgroundTint=\"#FFD600\"\r\n                android:layout_marginHorizontal=\"8dp\"/>\r\n\r\n            <Button\r\n                android:id=\"@+id/btn_cancel_non_registered\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"Cancel\"\r\n                android:textColor=\"#FFFFFF\"\r\n                android:backgroundTint=\"#E53935\"/>\r\n        </LinearLayout>\r\n\r\n        <!-- FINALIZE ON ITS OWN LINE -->\r\n        <Button\r\n            android:id=\"@+id/btn_finalize\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"Finalize\"\r\n            android:textColor=\"#FFFFFF\"\r\n            android:backgroundTint=\"#3A5BFF\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:layout_marginHorizontal=\"16dp\"/>\r\n\r\n        <!-- bottom spacing -->\r\n        <View\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"24dp\"/>\r\n    </LinearLayout>\r\n</ScrollView>\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/fragment_organizer_event_details.xml b/app/src/main/res/layout/fragment_organizer_event_details.xml
--- a/app/src/main/res/layout/fragment_organizer_event_details.xml	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/res/layout/fragment_organizer_event_details.xml	(date 1764449277207)
@@ -160,6 +160,7 @@
             android:layout_marginTop="8dp"
             android:layout_marginHorizontal="16dp"/>
 
+
         <Button
             android:id="@+id/btn_cancelled_list"
             android:layout_width="match_parent"
@@ -171,6 +172,17 @@
             android:layout_marginTop="8dp"
             android:layout_marginHorizontal="16dp"/>
 
+        <Button
+            android:id="@+id/btn_geolocation"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:text="Entrant Location Map"
+            android:textSize="16sp"
+            android:textColor="#FFFFFF"
+            android:backgroundTint="#3A5BFF"
+            android:layout_marginTop="8dp"
+            android:layout_marginHorizontal="16dp"/>
+
         <!-- LOTTERY / NOTIFY / CANCEL ROW -->
         <LinearLayout
             android:layout_width="match_parent"
Index: app/src/main/java/com/example/magpie_wingman/entrant/EntrantEditProfileFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.entrant;\r\n\r\nimport android.app.DatePickerDialog;\r\nimport android.os.Bundle;\r\nimport android.text.TextUtils;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageButton;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.example.magpie_wingman.MyApp;\r\nimport com.example.magpie_wingman.R;\r\nimport com.example.magpie_wingman.data.DbManager;\r\nimport com.example.magpie_wingman.data.model.User;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.gms.tasks.Tasks;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\n\r\nimport java.text.ParseException;\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.Date;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\n\r\npublic class EntrantEditProfileFragment extends Fragment {\r\n\r\n    private EditText firstNameEt, lastNameEt, emailEt, dobEt, phoneEt, passwordEt;\r\n    private Button btnEntrant, btnOrganizer, btnUpdate;\r\n\r\n    // Tracks which role is currently selected\r\n    private boolean isOrganizerSelected = false;\r\n\r\n    private final SimpleDateFormat dobFmt = new SimpleDateFormat(\"dd/MM/yyyy\", Locale.getDefault());\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n        return inflater.inflate(R.layout.fragment_entrant_edit_profile, container, false);\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(View v, @Nullable Bundle savedInstanceState) {\r\n        super.onViewCreated(v, savedInstanceState);\r\n\r\n        // Header back button\r\n        ImageButton backBtn = v.findViewById(R.id.button_back);\r\n        if (backBtn != null) {\r\n            backBtn.setOnClickListener(_v ->\r\n                    requireActivity().getOnBackPressedDispatcher().onBackPressed()\r\n            );\r\n        }\r\n\r\n        // Inputs\r\n        firstNameEt  = v.findViewById(R.id.edit_first_name);\r\n        lastNameEt   = v.findViewById(R.id.edit_last_name);\r\n        emailEt      = v.findViewById(R.id.edit_email);\r\n        dobEt        = v.findViewById(R.id.edit_dob);\r\n        phoneEt      = v.findViewById(R.id.edit_phone);\r\n        passwordEt   = v.findViewById(R.id.edit_password);\r\n\r\n        // Role buttons\r\n//        btnEntrant   = v.findViewById(R.id.button_entrant);\r\n//        btnOrganizer = v.findViewById(R.id.button_organizer);\r\n\r\n        // Update button\r\n        btnUpdate    = v.findViewById(R.id.button_update);\r\n\r\n        // Date picker\r\n        if (dobEt != null) {\r\n            dobEt.setOnClickListener(_v -> showDatePicker());\r\n        }\r\n\r\n        // Role button click listeners\r\n        if (btnEntrant != null) {\r\n            btnEntrant.setOnClickListener(_v -> setRole(false));\r\n        }\r\n        if (btnOrganizer != null) {\r\n            btnOrganizer.setOnClickListener(_v -> setRole(true));\r\n        }\r\n\r\n        // Retrieve current logged-in user\r\n        User current = MyApp.getInstance().getCurrentUser();\r\n        String userId = current.getUserId();\r\n        loadUser(userId);\r\n    }\r\n\r\n    // Loads profile data\r\n    private void loadUser(String userId) {\r\n        DbManager dbm = DbManager.getInstance();\r\n\r\n        dbm.getUserName(userId).addOnSuccessListener(name -> {\r\n            String safe = name != null ? name.trim() : \"\";\r\n            String[] split = splitName(safe);\r\n            firstNameEt.setText(split[0]);\r\n            lastNameEt.setText(split[1]);\r\n        });\r\n\r\n        dbm.getUserEmail(userId).addOnSuccessListener(email -> {\r\n            if (email != null) emailEt.setText(email);\r\n        });\r\n\r\n        dbm.getUserPhone(userId).addOnSuccessListener(phone -> {\r\n            if (phone != null) phoneEt.setText(phone);\r\n        });\r\n\r\n        dbm.getIsOrganizer(userId).addOnSuccessListener(isOrg -> {\r\n            // default to Entrant if null\r\n            boolean organizer = isOrg != null && isOrg;\r\n            setRole(organizer);\r\n        });\r\n\r\n        // Load DOB\r\n        dbm.getDb()\r\n                .collection(\"users\").document(userId)\r\n                .get()\r\n                .addOnSuccessListener((DocumentSnapshot doc) -> {\r\n                    if (doc != null && doc.exists()) {\r\n                        Date dob = doc.getDate(\"dateOfBirth\");\r\n                        if (dob != null) {\r\n                            dobEt.setText(dobFmt.format(dob));\r\n                        }\r\n                    }\r\n                })\r\n                .addOnFailureListener(e ->\r\n                        Toast.makeText(requireContext(), \"Failed to load DOB: \" + e.getMessage(), Toast.LENGTH_SHORT).show()\r\n                );\r\n\r\n        // Save updates\r\n        btnUpdate.setOnClickListener(_v -> {\r\n            String first = text(firstNameEt);\r\n            String last  = text(lastNameEt);\r\n            String fullName = buildFullName(first, last);\r\n\r\n            String email = text(emailEt);\r\n            String phone = text(phoneEt);\r\n            String newPassword = text(passwordEt);\r\n            boolean isOrganizer = isOrganizerSelected;\r\n\r\n            if (TextUtils.isEmpty(first)) {\r\n                firstNameEt.setError(\"First name required\");\r\n                return;\r\n            }\r\n            if (TextUtils.isEmpty(email) || !email.contains(\"@\")) {\r\n                emailEt.setError(\"Valid email required\");\r\n                return;\r\n            }\r\n\r\n            String dobStr = text(dobEt);\r\n            Date dobDate = null;\r\n            if (!TextUtils.isEmpty(dobStr)) {\r\n                try {\r\n                    dobFmt.setLenient(false);\r\n                    dobDate = dobFmt.parse(dobStr);\r\n                } catch (ParseException e) {\r\n                    dobEt.setError(\"Use format dd/MM/yyyy\");\r\n                    return;\r\n                }\r\n            }\r\n\r\n            btnUpdate.setEnabled(false);\r\n\r\n            List<Task<?>> ops = new ArrayList<>();\r\n            ops.add(dbm.updateName(userId, fullName));\r\n            ops.add(dbm.updateEmail(userId, email));\r\n            ops.add(dbm.updatePhoneNumber(userId, phone));\r\n            ops.add(dbm.changeOrgPerms(userId, isOrganizer));\r\n\r\n            if (dobDate != null) {\r\n                ops.add(dbm.updateDOB(userId, dobDate));\r\n            }\r\n\r\n            if (!TextUtils.isEmpty(newPassword)) {\r\n                ops.add(dbm.updatePassword(userId, newPassword));\r\n            }\r\n\r\n            Tasks.whenAllComplete(ops).addOnCompleteListener(t -> {\r\n                btnUpdate.setEnabled(true);\r\n\r\n                // Show first failure if any\r\n                for (Task<?> each : ops) {\r\n                    if (!each.isSuccessful()) {\r\n                        Exception e = each.getException();\r\n                        Toast.makeText(requireContext(),\r\n                                \"Update failed: \" + (e != null ? e.getMessage() : \"unknown error\"),\r\n                                Toast.LENGTH_LONG).show();\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                passwordEt.setText(\"\");     // Clear password field after successful update\r\n                Toast.makeText(requireContext(), \"Profile updated.\", Toast.LENGTH_SHORT).show();\r\n                requireActivity().getOnBackPressedDispatcher().onBackPressed();\r\n            });\r\n        });\r\n    }\r\n\r\n    private void showDatePicker() {\r\n        Calendar c = Calendar.getInstance();\r\n\r\n        // If birthdate existed, open picker on that date\r\n        String existing = text(dobEt);\r\n        if (!TextUtils.isEmpty(existing)) {\r\n            try {\r\n                dobFmt.setLenient(false);\r\n                Date parsed = dobFmt.parse(existing);\r\n                if (parsed != null) c.setTime(parsed);\r\n            } catch (ParseException ignored) {}\r\n        }\r\n\r\n        DatePickerDialog dlg = new DatePickerDialog(\r\n                requireContext(),\r\n                (view, year, month, dayOfMonth) -> {\r\n                    String dd = String.format(Locale.getDefault(), \"%02d\", dayOfMonth);\r\n                    String mm = String.format(Locale.getDefault(), \"%02d\", month + 1);\r\n                    dobEt.setText(dd + \"/\" + mm + \"/\" + year);  // dd/MM/yyyy\r\n                },\r\n                c.get(Calendar.YEAR),\r\n                c.get(Calendar.MONTH),\r\n                c.get(Calendar.DAY_OF_MONTH)\r\n        );\r\n        dlg.show();\r\n    }\r\n\r\n    private void setRole(boolean organizer) {\r\n        isOrganizerSelected = organizer;\r\n\r\n        if (btnEntrant == null || btnOrganizer == null) return;\r\n\r\n        if (organizer) {\r\n            btnOrganizer.setBackgroundResource(R.drawable.blue_button_bg);\r\n            btnEntrant.setBackgroundResource(R.drawable.white_button_bg);\r\n        } else {\r\n            btnEntrant.setBackgroundResource(R.drawable.blue_button_bg);\r\n            btnOrganizer.setBackgroundResource(R.drawable.white_button_bg);\r\n        }\r\n    }\r\n\r\n    private static String text(EditText et) {\r\n        if (et == null || et.getText() == null) return \"\";\r\n        return et.getText().toString().trim();\r\n    }\r\n\r\n    private static String[] splitName(String full) {\r\n        if (TextUtils.isEmpty(full)) return new String[]{\"\", \"\"};\r\n        int lastSpace = full.lastIndexOf(' ');\r\n        if (lastSpace <= 0) return new String[]{full, \"\"};\r\n        return new String[]{full.substring(0, lastSpace), full.substring(lastSpace + 1)};\r\n    }\r\n\r\n    private static String buildFullName(String first, String last) {\r\n        return (first + \" \" + (TextUtils.isEmpty(last) ? \"\" : last)).trim().replaceAll(\"\\\\s+\", \" \");\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/entrant/EntrantEditProfileFragment.java b/app/src/main/java/com/example/magpie_wingman/entrant/EntrantEditProfileFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/entrant/EntrantEditProfileFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/entrant/EntrantEditProfileFragment.java	(date 1764449277202)
@@ -33,10 +33,7 @@
 public class EntrantEditProfileFragment extends Fragment {
 
     private EditText firstNameEt, lastNameEt, emailEt, dobEt, phoneEt, passwordEt;
-    private Button btnEntrant, btnOrganizer, btnUpdate;
-
-    // Tracks which role is currently selected
-    private boolean isOrganizerSelected = false;
+    private Button btnUpdate;
 
     private final SimpleDateFormat dobFmt = new SimpleDateFormat("dd/MM/yyyy", Locale.getDefault());
 
@@ -66,10 +63,6 @@
         phoneEt      = v.findViewById(R.id.edit_phone);
         passwordEt   = v.findViewById(R.id.edit_password);
 
-        // Role buttons
-//        btnEntrant   = v.findViewById(R.id.button_entrant);
-//        btnOrganizer = v.findViewById(R.id.button_organizer);
-
         // Update button
         btnUpdate    = v.findViewById(R.id.button_update);
 
@@ -78,14 +71,6 @@
             dobEt.setOnClickListener(_v -> showDatePicker());
         }
 
-        // Role button click listeners
-        if (btnEntrant != null) {
-            btnEntrant.setOnClickListener(_v -> setRole(false));
-        }
-        if (btnOrganizer != null) {
-            btnOrganizer.setOnClickListener(_v -> setRole(true));
-        }
-
         // Retrieve current logged-in user
         User current = MyApp.getInstance().getCurrentUser();
         String userId = current.getUserId();
@@ -111,12 +96,6 @@
             if (phone != null) phoneEt.setText(phone);
         });
 
-        dbm.getIsOrganizer(userId).addOnSuccessListener(isOrg -> {
-            // default to Entrant if null
-            boolean organizer = isOrg != null && isOrg;
-            setRole(organizer);
-        });
-
         // Load DOB
         dbm.getDb()
                 .collection("users").document(userId)
@@ -142,7 +121,6 @@
             String email = text(emailEt);
             String phone = text(phoneEt);
             String newPassword = text(passwordEt);
-            boolean isOrganizer = isOrganizerSelected;
 
             if (TextUtils.isEmpty(first)) {
                 firstNameEt.setError("First name required");
@@ -171,7 +149,6 @@
             ops.add(dbm.updateName(userId, fullName));
             ops.add(dbm.updateEmail(userId, email));
             ops.add(dbm.updatePhoneNumber(userId, phone));
-            ops.add(dbm.changeOrgPerms(userId, isOrganizer));
 
             if (dobDate != null) {
                 ops.add(dbm.updateDOB(userId, dobDate));
@@ -229,20 +206,6 @@
         dlg.show();
     }
 
-    private void setRole(boolean organizer) {
-        isOrganizerSelected = organizer;
-
-        if (btnEntrant == null || btnOrganizer == null) return;
-
-        if (organizer) {
-            btnOrganizer.setBackgroundResource(R.drawable.blue_button_bg);
-            btnEntrant.setBackgroundResource(R.drawable.white_button_bg);
-        } else {
-            btnEntrant.setBackgroundResource(R.drawable.blue_button_bg);
-            btnOrganizer.setBackgroundResource(R.drawable.white_button_bg);
-        }
-    }
-
     private static String text(EditText et) {
         if (et == null || et.getText() == null) return "";
         return et.getText().toString().trim();
Index: app/src/main/java/com/example/magpie_wingman/entrant/EntrantLandingFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.entrant;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.os.Bundle;\r\nimport android.text.Editable;\r\nimport android.text.TextWatcher;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.navigation.NavController;\r\nimport androidx.navigation.Navigation;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.example.magpie_wingman.MyApp;\r\nimport com.example.magpie_wingman.R;\r\nimport com.example.magpie_wingman.data.DbManager;\r\nimport com.example.magpie_wingman.data.model.Event;\r\nimport com.example.magpie_wingman.data.model.User;\r\nimport com.google.firebase.Timestamp;\r\nimport com.google.firebase.firestore.CollectionReference;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.QueryDocumentSnapshot;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.Date;\r\nimport java.util.List;\r\n\r\n/**\r\n * Entrant home screen.\r\n *\r\n * <p>This fragment is the landing page for entrant users. It shows:\r\n * <ul>\r\n * <li>A search bar and top icons (filter, info, settings)</li>\r\n * <li>A list of all events that the entrant can browse</li>\r\n * <li>Bottom navigation buttons (invitations, scan QR, events, notifications)</li>\r\n * </ul>\r\n *\r\n * <p>The list itself does <b>not</b> perform join/leave. Instead:\r\n * <ul>\r\n * <li>Each row has a \"Join / Leave\" button whose appearance reflects the user's status.</li>\r\n * <li>Clicking that button opens the event details screen, where the user can actually\r\n * join or leave the waitlist.</li>\r\n * </ul>\r\n */\r\npublic class EntrantLandingFragment extends Fragment {\r\n\r\n    // -------------------------------------------------------------------------\r\n    // UI references\r\n    // -------------------------------------------------------------------------\r\n\r\n    private EditText   searchBar; // Changed from TextView to EditText for US 01.01.04\r\n    private ImageView  btnFilter;\r\n    private ImageView  btnInfo;\r\n    private ImageView  btnSettings;\r\n    private RecyclerView eventsRecycler;\r\n    private Button     btnInvitations;\r\n    private Button     btnScanQr;\r\n    private Button     btnEventsPrimary;\r\n    private Button     btnNotifications;\r\n\r\n    // Two lists: Master (All Data from DB) vs Display (Filtered View)\r\n    private final List<Event> masterEventList = new ArrayList<>();\r\n    private final List<Event> eventList = new ArrayList<>();\r\n\r\n    private EventAdapter adapter;\r\n\r\n    // Currently logged-in entrant's id (from MyApp)\r\n    @Nullable\r\n    private String entrantId;\r\n\r\n    // Filter State\r\n    private boolean filterAvailableOnly = false;\r\n\r\n    public EntrantLandingFragment() {\r\n        // Required empty public constructor\r\n    }\r\n\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater,\r\n                             @Nullable ViewGroup container,\r\n                             @Nullable Bundle savedInstanceState) {\r\n        // Inflate the layout described in fragment_entrant_landing.xml\r\n        return inflater.inflate(R.layout.fragment_entrant_landing, container, false);\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(@NonNull View v, @Nullable Bundle savedInstanceState) {\r\n        super.onViewCreated(v, savedInstanceState);\r\n\r\n        // Bind views from XML\r\n        searchBar        = v.findViewById(R.id.search_bar);\r\n        btnFilter        = v.findViewById(R.id.btn_filter);\r\n        btnInfo          = v.findViewById(R.id.btn_info);\r\n        btnSettings      = v.findViewById(R.id.btn_settings);\r\n        eventsRecycler   = v.findViewById(R.id.recycler_view_events);\r\n        btnInvitations   = v.findViewById(R.id.btn_invitations);\r\n        btnScanQr        = v.findViewById(R.id.btn_scan_qr);\r\n        btnEventsPrimary = v.findViewById(R.id.btn_events);\r\n        btnNotifications = v.findViewById(R.id.btn_notification);\r\n\r\n        // NavController for all navigation actions\r\n        NavController navController = Navigation.findNavController(v);\r\n\r\n        // Set up click listeners for top and bottom bars\r\n        setupChromeClickListeners(navController);\r\n\r\n        // Resolve the currently logged-in entrant from MyApp\r\n        User currentUser = MyApp.getInstance().getCurrentUser();\r\n        if (currentUser != null) {\r\n            entrantId = currentUser.getUserId();\r\n        } else {\r\n            // --- CRASH FIX ---\r\n            // If testing without full login, use a dummy ID so the Adapter doesn't crash on Join\r\n            entrantId = \"test_user_id\";\r\n        }\r\n\r\n        // Configure the events RecyclerView and load data from Firestore\r\n        setupEventsListForEntrant(entrantId);\r\n\r\n        // --- Search & Filter Logic (US 01.01.04) ---\r\n        searchBar.addTextChangedListener(new TextWatcher() {\r\n            @Override public void beforeTextChanged(CharSequence s, int start, int count, int after) {}\r\n            @Override public void onTextChanged(CharSequence s, int start, int before, int count) {\r\n                applyFilters();\r\n            }\r\n            @Override public void afterTextChanged(Editable s) {}\r\n        });\r\n\r\n        btnFilter.setOnClickListener(x -> showFilterDialog());\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // UI chrome wiring (top bar + bottom bar)\r\n    // -------------------------------------------------------------------------\r\n\r\n    private void setupChromeClickListeners(@NonNull NavController navController) {\r\n        btnInfo.setOnClickListener(x ->\r\n                navController.navigate(\r\n                        R.id.action_entrantLandingFragment3_to_entrantDetailsFragment));\r\n\r\n        btnSettings.setOnClickListener(x ->\r\n                navController.navigate(\r\n                        R.id.action_entrantLandingFragment3_to_entrantSettingsFragment));\r\n\r\n        // Bottom bar actions\r\n        btnInvitations.setOnClickListener(x ->\r\n                navController.navigate(\r\n                        R.id.action_entrantLandingFragment3_to_entrantInvitationsFragment));\r\n\r\n        btnScanQr.setOnClickListener(x ->\r\n                navController.navigate(\r\n                        R.id.action_entrantLandingFragment3_to_scanQRFragment));\r\n\r\n        btnEventsPrimary.setOnClickListener(x ->\r\n                navController.navigate(\r\n                        R.id.action_entrantLandingFragment3_to_entrantEventsFragment));\r\n\r\n        btnNotifications.setOnClickListener(x ->\r\n                navController.navigate(\r\n                        R.id.action_entrantLandingFragment3_to_entrantNotificationsFragment));\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Event list wiring\r\n    // -------------------------------------------------------------------------\r\n\r\n    private void setupEventsListForEntrant(@Nullable String entrantId) {\r\n        // Use a simple vertical list layout manager\r\n        eventsRecycler.setLayoutManager(new LinearLayoutManager(requireContext()));\r\n        eventsRecycler.setHasFixedSize(true);\r\n        eventList.clear();\r\n\r\n        String userIdForAdapter = (entrantId != null) ? entrantId : \"test_user_id\";\r\n\r\n        adapter = new EventAdapter(\r\n                eventList,\r\n                userIdForAdapter,\r\n                this::openEventDetails\r\n        );\r\n        eventsRecycler.setAdapter(adapter);\r\n\r\n        loadEvents();\r\n    }\r\n\r\n    private void openEventDetails(@NonNull Event event) {\r\n        Bundle args = new Bundle();\r\n        args.putString(\"eventId\", event.getEventId());\r\n        String name = event.getEventName();\r\n        args.putString(\"eventName\", name != null ? name : \"\");\r\n\r\n        String location = event.getEventLocation();\r\n        args.putString(\"eventLocation\", location != null ? location : \"\");\r\n\r\n        Date start = event.getEventStartTime();\r\n        if (start != null) {\r\n            args.putLong(\"eventStartTime\", start.getTime());\r\n        }\r\n\r\n        String desc = event.getDescription();\r\n        args.putString(\"eventDescription\", desc != null ? desc : \"\");\r\n        String picUrl = event.getEventPosterURL();\r\n        args.putString(\"eventPosterURL\", picUrl != null ? picUrl : \"\");\r\n\r\n        NavController navController = Navigation.findNavController(requireView());\r\n        navController.navigate(\r\n                R.id.action_entrantLandingFragment3_to_detailedEventDescriptionFragment,\r\n                args\r\n        );\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Helper\r\n    // -------------------------------------------------------------------------\r\n\r\n    private void loadEvents() {\r\n        FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n        CollectionReference eventsRef = db.collection(\"events\");\r\n\r\n        Timestamp queryNow = Timestamp.now();\r\n\r\n        eventsRef\r\n                .whereGreaterThanOrEqualTo(\"registrationEnd\", queryNow)\r\n                .orderBy(\"registrationEnd\")\r\n                .addSnapshotListener((snapshot, error) -> {\r\n                    if (error != null) {\r\n                        Toast.makeText(getContext(),\r\n                                \"Failed to load events\", Toast.LENGTH_SHORT).show();\r\n                        return;\r\n                    }\r\n\r\n                    masterEventList.clear();\r\n                    Timestamp now = Timestamp.now();\r\n\r\n                    if (snapshot != null) {\r\n                        for (QueryDocumentSnapshot doc : snapshot) {\r\n                            Timestamp regStart = doc.getTimestamp(\"registrationStart\");\r\n                            if (regStart != null && regStart.compareTo(now) > 0) {\r\n                                continue; // skip\r\n                            }\r\n\r\n                            Event event = doc.toObject(Event.class);\r\n                            masterEventList.add(event);\r\n                        }\r\n                    }\r\n\r\n                    // Now rebuild the filtered list & refresh the adapter\r\n                    applyFilters();\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Filters the master list based on search text AND availability toggle.\r\n     * Populates 'eventList' and notifies adapter.\r\n     */\r\n    private void applyFilters() {\r\n        eventList.clear();\r\n        String query = \"\";\r\n        if (searchBar != null && searchBar.getText() != null) {\r\n            query = searchBar.getText().toString().toLowerCase().trim();\r\n        }\r\n\r\n        for (Event event : masterEventList) {\r\n            boolean matchesSearch = false;\r\n            boolean matchesFilter = true;\r\n\r\n            // 1. Text Search\r\n            if (query.isEmpty()) {\r\n                matchesSearch = true;\r\n            } else {\r\n                if (event.getEventName() != null && event.getEventName().toLowerCase().contains(query)) {\r\n                    matchesSearch = true;\r\n                } else if (event.getDescription() != null && event.getDescription().toLowerCase().contains(query)) {\r\n                    matchesSearch = true;\r\n                }\r\n            }\r\n\r\n            // 2. Availability Filter (Limit)\r\n            if (filterAvailableOnly) {\r\n                // If limit > 0 and waitlist >= limit, hide it\r\n                if (event.getWaitingListLimit() > 0 && event.getWaitlistCount() >= event.getWaitingListLimit()) {\r\n                    matchesFilter = false;\r\n                }\r\n            }\r\n\r\n            if (matchesSearch && matchesFilter) {\r\n                eventList.add(event);\r\n            }\r\n        }\r\n        if (adapter != null) {\r\n            adapter.notifyDataSetChanged();\r\n        }\r\n    }\r\n\r\n    private void showFilterDialog() {\r\n        String[] options = {\"Show Only Available Events (Not Full)\"};\r\n        boolean[] checkedItems = {filterAvailableOnly};\r\n\r\n        new AlertDialog.Builder(getContext())\r\n                .setTitle(\"Filter Events\")\r\n                .setMultiChoiceItems(options, checkedItems, (dialog, which, isChecked) -> {\r\n                    if (which == 0) filterAvailableOnly = isChecked;\r\n                })\r\n                .setPositiveButton(\"Apply\", (dialog, which) -> {\r\n                    applyFilters();\r\n                    String status = filterAvailableOnly ? \"Showing available only\" : \"Showing all events\";\r\n                    Toast.makeText(getContext(), status, Toast.LENGTH_SHORT).show();\r\n                })\r\n                .setNegativeButton(\"Cancel\", null)\r\n                .show();\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/entrant/EntrantLandingFragment.java b/app/src/main/java/com/example/magpie_wingman/entrant/EntrantLandingFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/entrant/EntrantLandingFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/entrant/EntrantLandingFragment.java	(date 1764449277202)
@@ -74,7 +74,6 @@
     private EventAdapter adapter;
 
     // Currently logged-in entrant's id (from MyApp)
-    @Nullable
     private String entrantId;
 
     // Filter State
@@ -115,13 +114,8 @@
 
         // Resolve the currently logged-in entrant from MyApp
         User currentUser = MyApp.getInstance().getCurrentUser();
-        if (currentUser != null) {
-            entrantId = currentUser.getUserId();
-        } else {
-            // --- CRASH FIX ---
-            // If testing without full login, use a dummy ID so the Adapter doesn't crash on Join
-            entrantId = "test_user_id";
-        }
+        entrantId = currentUser.getUserId();
+
 
         // Configure the events RecyclerView and load data from Firestore
         setupEventsListForEntrant(entrantId);
Index: app/src/main/java/com/example/magpie_wingman/data/NotificationFunction.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.data;\r\n\r\nimport androidx.annotation.Nullable;\r\n\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.gms.tasks.TaskCompletionSource;\r\nimport com.google.android.gms.tasks.Tasks;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\nimport com.google.firebase.firestore.QuerySnapshot;\r\nimport com.google.firebase.firestore.WriteBatch;\r\n\r\nimport java.util.List;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\nimport java.util.concurrent.ExecutorService;\r\nimport java.util.concurrent.Executors;\r\n\r\npublic class NotificationFunction {\r\n    private FirebaseFirestore db;\r\n    private final ExecutorService executor = Executors.newSingleThreadExecutor();\r\n\r\n    public NotificationFunction() {\r\n        this(FirebaseFirestore.getInstance());\r\n    }\r\n    public NotificationFunction(@Nullable FirebaseFirestore firestore) {\r\n        this.db = firestore;\r\n    }\r\n    /**\r\n     * sends a notification to all users in a given event subcollection e.g. waitlist / registrable / cancelled (not done yet)\r\n     *\r\n     * @param eventId event ID\r\n     * @param subcollectionName waitlist / registrable / cancelled\r\n     * @param message  message to send\r\n     * @return Task<Void>\r\n     */\r\n    public Task<Void> notifyEntrants(String eventId, String subcollectionName, String message) {\r\n        TaskCompletionSource<Void> tcs = new TaskCompletionSource<>();\r\n\r\n        if (db == null) {\r\n            System.out.println(\"Skipping Firestore in test mode\");\r\n            tcs.setResult(null);\r\n            return tcs.getTask();\r\n        }\r\n        executor.execute(() -> {\r\n            try {\r\n                QuerySnapshot query = Tasks.await(\r\n                        db.collection(\"events\")\r\n                                .document(eventId)\r\n                                .collection(subcollectionName)\r\n                                .get()\r\n                );\r\n                List<DocumentSnapshot> docs = query.getDocuments();\r\n                WriteBatch batch = db.batch();\r\n                long now = System.currentTimeMillis();\r\n\r\n                for (DocumentSnapshot doc : docs) {\r\n                    String userId = doc.getId();\r\n\r\n                    Map<String, Object> notif = new HashMap<>();\r\n                    notif.put(\"message\", message);\r\n                    notif.put(\"timestamp\", now);\r\n                    notif.put(\"eventId\", eventId);\r\n                    notif.put(\"read\", false);\r\n\r\n                    batch.set(\r\n                            db.collection(\"users\")\r\n                                    .document(userId)\r\n                                    .collection(\"notifications\")\r\n                                    .document(),\r\n                            notif\r\n                    );\r\n                }\r\n                Tasks.await(batch.commit());\r\n                tcs.setResult(null);\r\n            } catch (Exception e) {\r\n                tcs.setException(e);\r\n            }\r\n        });\r\n        return tcs.getTask();\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/data/NotificationFunction.java b/app/src/main/java/com/example/magpie_wingman/data/NotificationFunction.java
--- a/app/src/main/java/com/example/magpie_wingman/data/NotificationFunction.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/data/NotificationFunction.java	(date 1764449277200)
@@ -57,6 +57,21 @@
                 for (DocumentSnapshot doc : docs) {
                     String userId = doc.getId();
 
+                    // Look up this user's notification preference
+                    DocumentSnapshot userSnap = Tasks.await(
+                            db.collection("users")
+                                    .document(userId)
+                                    .get()
+                    );
+
+                    Boolean notifOrg = userSnap.getBoolean("notifOrganizer");
+
+                    // Treat null as "on" so existing users still get notifications
+                    if (notifOrg != null && !notifOrg) {
+                        // User has opted out of organizer notifications
+                        continue;
+                    }
+
                     Map<String, Object> notif = new HashMap<>();
                     notif.put("message", message);
                     notif.put("timestamp", now);
Index: app/src/main/res/layout/fragment_organizer_new_event.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><ScrollView\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"#0B0B18\"\r\n    tools:context=\".organizer.OrganizerNewEventFragment\">\r\n\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"vertical\">\r\n\r\n        <!-- HEADER BAR -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"56dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:gravity=\"center_vertical\"\r\n            android:background=\"@android:color/white\"\r\n            android:paddingHorizontal=\"12dp\">\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/button_back\"\r\n                android:layout_width=\"28dp\"\r\n                android:layout_height=\"28dp\"\r\n                android:background=\"@android:color/transparent\"\r\n                android:src=\"@drawable/ic_arrow_back\"\r\n                android:contentDescription=\"Back\"\r\n                app:tint=\"#000000\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/image_logo\"\r\n                android:layout_width=\"28dp\"\r\n                android:layout_height=\"28dp\"\r\n                android:src=\"@drawable/wingman_logo\"\r\n                android:contentDescription=\"Logo\"\r\n                android:layout_marginStart=\"8dp\" />\r\n\r\n            <TextView\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"New Event\"\r\n                android:textColor=\"#000000\"\r\n                android:textStyle=\"bold\"\r\n                android:textSize=\"18sp\"\r\n                android:layout_marginStart=\"8dp\" />\r\n\r\n            <!-- Spacer pushes info button to the right -->\r\n            <View\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\" />\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/button_info\"\r\n                android:layout_width=\"28dp\"\r\n                android:layout_height=\"28dp\"\r\n                android:background=\"@android:color/transparent\"\r\n                android:contentDescription=\"Info\"\r\n                android:src=\"@drawable/ic_info\"\r\n                android:gravity=\"end\"\r\n                app:tint=\"#000000\" />\r\n        </LinearLayout>\r\n\r\n        <!-- EVENT TITLE -->\r\n        <EditText\r\n            android:id=\"@+id/edit_event_title\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:hint=\"Title\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:background=\"@drawable/edittext_white\"\r\n            android:padding=\"12dp\"\r\n            android:textColor=\"#000000\"\r\n            android:textColorHint=\"#888888\" />\r\n\r\n        <!-- LIMIT AND OPTIONS -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:weightSum=\"3\">\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_limit\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"8dp\"\r\n                android:hint=\"Limit\"\r\n                android:inputType=\"number\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <CheckBox\r\n                android:id=\"@+id/checkbox_geo\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"GEO\"\r\n                android:textColor=\"#FFFFFF\"\r\n                android:buttonTint=\"#2E5BFF\"\r\n                android:gravity=\"center\" />\r\n\r\n            <CheckBox\r\n                android:id=\"@+id/checkbox_qr\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"QR\"\r\n                android:textColor=\"#FFFFFF\"\r\n                android:buttonTint=\"#2E5BFF\"\r\n                android:gravity=\"center\" />\r\n        </LinearLayout>\r\n\r\n        <!-- POSTER UPLOAD -->\r\n        <Button\r\n            android:id=\"@+id/button_upload_poster\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"150dp\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:text=\"+ Upload Poster\"\r\n            android:textColor=\"#000000\"\r\n            android:background=\"@drawable/edittext_white\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <!-- LOCATION INPUTS -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:weightSum=\"3\">\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_address\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:hint=\"Address\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_city\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:hint=\"City\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_province\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:hint=\"Province\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n        </LinearLayout>\r\n\r\n        <!-- DESCRIPTION -->\r\n        <EditText\r\n            android:id=\"@+id/edit_description\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"100dp\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:hint=\"Description\"\r\n            android:gravity=\"top\"\r\n            android:background=\"@drawable/edittext_white\"\r\n            android:padding=\"12dp\"\r\n            android:textColor=\"#000000\" />\r\n\r\n        <!-- DATE & TIME -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"horizontal\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:weightSum=\"2\">\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_date\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:hint=\"Event Date\"\r\n                android:drawableStart=\"@drawable/ic_calendar\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_time\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:hint=\"Event Time\"\r\n                android:drawableStart=\"@drawable/ic_clock\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n        </LinearLayout>\r\n\r\n        <!-- REGISTRATION DATES -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:weightSum=\"2\">\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_registration_start\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:hint=\"Registration Start\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_registration_end\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:hint=\"Registration End\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n        </LinearLayout>\r\n\r\n        <!-- FILTER ICONS -->\r\n        <TextView\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:text=\"Select Filters\"\r\n            android:textColor=\"#FFFFFF\"\r\n            android:textSize=\"16sp\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:gravity=\"center\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:orientation=\"horizontal\">\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_sports\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Sports\" />\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_music\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Music\" />\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_art\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Art\" />\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_food\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Food\" />\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_more\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Other\" />\r\n        </LinearLayout>\r\n\r\n        <!-- BUTTONS -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"horizontal\"\r\n            android:gravity=\"center\"\r\n            android:layout_marginTop=\"16dp\">\r\n\r\n            <Button\r\n                android:id=\"@+id/button_reset\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"48dp\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"8dp\"\r\n                android:text=\"RESET\"\r\n                android:textStyle=\"bold\"\r\n                android:textColor=\"#000000\"\r\n                android:background=\"@drawable/white_button_bg\" />\r\n\r\n            <Button\r\n                android:id=\"@+id/button_create\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"48dp\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"CREATE\"\r\n                android:textStyle=\"bold\"\r\n                android:textColor=\"@android:color/white\"\r\n                android:background=\"@drawable/blue_button_bg\"\r\n                android:backgroundTint=\"@null\" />\r\n        </LinearLayout>\r\n    </LinearLayout>\r\n</ScrollView>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/fragment_organizer_new_event.xml b/app/src/main/res/layout/fragment_organizer_new_event.xml
--- a/app/src/main/res/layout/fragment_organizer_new_event.xml	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/res/layout/fragment_organizer_new_event.xml	(date 1764449277208)
@@ -12,7 +12,6 @@
         android:layout_height="wrap_content"
         android:orientation="vertical">
 
-        <!-- HEADER BAR -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="56dp"
@@ -47,7 +46,6 @@
                 android:textSize="18sp"
                 android:layout_marginStart="8dp" />
 
-            <!-- Spacer pushes info button to the right -->
             <View
                 android:layout_width="0dp"
                 android:layout_height="wrap_content"
@@ -64,7 +62,6 @@
                 app:tint="#000000" />
         </LinearLayout>
 
-        <!-- EVENT TITLE -->
         <EditText
             android:id="@+id/edit_event_title"
             android:layout_width="match_parent"
@@ -76,13 +73,23 @@
             android:textColor="#000000"
             android:textColorHint="#888888" />
 
-        <!-- LIMIT AND OPTIONS -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:layout_marginTop="8dp"
-            android:orientation="horizontal"
-            android:weightSum="3">
+            android:orientation="horizontal">
+
+            <EditText
+                android:id="@+id/edit_capacity"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1"
+                android:layout_marginEnd="8dp"
+                android:hint="Max Capacity"
+                android:inputType="number"
+                android:background="@drawable/edittext_white"
+                android:padding="12dp"
+                android:textColor="#000000" />
 
             <EditText
                 android:id="@+id/edit_limit"
@@ -90,34 +97,37 @@
                 android:layout_height="wrap_content"
                 android:layout_weight="1"
                 android:layout_marginEnd="8dp"
-                android:hint="Limit"
+                android:hint="Waitlist Limit"
                 android:inputType="number"
                 android:background="@drawable/edittext_white"
                 android:padding="12dp"
                 android:textColor="#000000" />
+        </LinearLayout>
+
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="8dp"
+            android:orientation="horizontal">
 
             <CheckBox
                 android:id="@+id/checkbox_geo"
-                android:layout_width="0dp"
+                android:layout_width="wrap_content"
                 android:layout_height="wrap_content"
-                android:layout_weight="1"
-                android:text="GEO"
+                android:text="Geo-Location"
                 android:textColor="#FFFFFF"
                 android:buttonTint="#2E5BFF"
-                android:gravity="center" />
+                android:layout_marginEnd="16dp"/>
 
             <CheckBox
                 android:id="@+id/checkbox_qr"
-                android:layout_width="0dp"
+                android:layout_width="wrap_content"
                 android:layout_height="wrap_content"
-                android:layout_weight="1"
-                android:text="QR"
+                android:text="Generate QR"
                 android:textColor="#FFFFFF"
-                android:buttonTint="#2E5BFF"
-                android:gravity="center" />
+                android:buttonTint="#2E5BFF"/>
         </LinearLayout>
 
-        <!-- POSTER UPLOAD -->
         <Button
             android:id="@+id/button_upload_poster"
             android:layout_width="match_parent"
@@ -128,7 +138,6 @@
             android:background="@drawable/edittext_white"
             android:textStyle="bold" />
 
-        <!-- LOCATION INPUTS -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
@@ -169,7 +178,6 @@
                 android:textColor="#000000" />
         </LinearLayout>
 
-        <!-- DESCRIPTION -->
         <EditText
             android:id="@+id/edit_description"
             android:layout_width="match_parent"
@@ -181,7 +189,6 @@
             android:padding="12dp"
             android:textColor="#000000" />
 
-        <!-- DATE & TIME -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
@@ -213,7 +220,6 @@
                 android:textColor="#000000" />
         </LinearLayout>
 
-        <!-- REGISTRATION DATES -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
@@ -242,7 +248,6 @@
                 android:textColor="#000000" />
         </LinearLayout>
 
-        <!-- FILTER ICONS -->
         <TextView
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
@@ -300,7 +305,6 @@
                 android:contentDescription="Other" />
         </LinearLayout>
 
-        <!-- BUTTONS -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
Index: app/build.gradle.kts
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>plugins {\r\n    alias(libs.plugins.android.application)\r\n    alias(libs.plugins.google.android.libraries.mapsplatform.secrets.gradle.plugin)\r\n    id(\"com.google.gms.google-services\")\r\n}\r\n\r\nandroid {\r\n    namespace = \"com.example.magpie_wingman\"\r\n    compileSdk {\r\n        version = release(36)\r\n    }\r\n\r\n    defaultConfig {\r\n        applicationId = \"com.example.magpie_wingman\"\r\n        minSdk = 24\r\n        targetSdk = 36\r\n        versionCode = 1\r\n        versionName = \"1.0\"\r\n\r\n        testInstrumentationRunner = \"androidx.test.runner.AndroidJUnitRunner\"\r\n    }\r\n\r\n    buildTypes {\r\n        release {\r\n            isMinifyEnabled = false\r\n            proguardFiles(\r\n                getDefaultProguardFile(\"proguard-android-optimize.txt\"),\r\n                \"proguard-rules.pro\"\r\n            )\r\n        }\r\n    }\r\n    compileOptions {\r\n        sourceCompatibility = JavaVersion.VERSION_11\r\n        targetCompatibility = JavaVersion.VERSION_11\r\n    }\r\n    buildFeatures {\r\n        viewBinding = true\r\n    }\r\n}\r\n\r\ndependencies {\r\n    implementation(\"com.google.android.material:material:1.10.0\")\r\n    implementation(libs.appcompat)\r\n    implementation(libs.material)\r\n    implementation(\"com.google.android.material:material:1.12.0\")\r\n    implementation(\"androidx.cardview:cardview:1.0.0\")\r\n    implementation(\"com.journeyapps:zxing-android-embedded:4.3.0\")\r\n    implementation(\"com.google.zxing:core:3.4.1\")\r\n    implementation(libs.constraintlayout)\r\n    implementation(libs.navigation.fragment)\r\n    implementation(libs.navigation.ui)\r\n    implementation(libs.annotation)\r\n    implementation(libs.lifecycle.livedata.ktx)\r\n    implementation(libs.lifecycle.viewmodel.ktx)\r\n    implementation(libs.legacy.support.v4)\r\n    implementation(libs.preference)\r\n    implementation(libs.play.services.maps)\r\n    implementation(libs.firebase.common)\r\n    implementation(libs.firebase.firestore)\r\n    implementation(\"com.google.firebase:firebase-storage:20.3.0\")\r\n    testImplementation(\"junit:junit:4.13.2\")\r\n    androidTestImplementation(\"androidx.test.ext:junit:1.1.5\")\r\n    androidTestImplementation(\"androidx.test.espresso:espresso-core:3.5.1\")\r\n    implementation(platform(\"com.google.firebase:firebase-bom:34.3.0\"))\r\n    implementation(\"com.google.firebase:firebase-firestore\")\r\n    implementation (\"com.github.bumptech.glide:glide:4.16.0\")\r\n    annotationProcessor (\"com.github.bumptech.glide:compiler:4.16.0\")\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/build.gradle.kts b/app/build.gradle.kts
--- a/app/build.gradle.kts	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/build.gradle.kts	(date 1764449277196)
@@ -65,4 +65,5 @@
     implementation("com.google.firebase:firebase-firestore")
     implementation ("com.github.bumptech.glide:glide:4.16.0")
     annotationProcessor ("com.github.bumptech.glide:compiler:4.16.0")
+    implementation("com.google.android.gms:play-services-location:21.0.1")
 }
\ No newline at end of file
Index: app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEditEventFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.organizer;\r\n\r\nimport android.app.DatePickerDialog;\r\nimport android.app.TimePickerDialog;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.text.TextUtils;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.CheckBox;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.result.ActivityResultLauncher;\r\nimport androidx.activity.result.contract.ActivityResultContracts;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.navigation.Navigation;\r\n\r\nimport com.example.magpie_wingman.R;\r\nimport com.example.magpie_wingman.data.DbManager;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.Timestamp;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.SetOptions;\r\n\r\nimport java.text.SimpleDateFormat;\r\nimport java.util.Calendar;\r\nimport java.util.Date;\r\nimport java.util.Locale;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\n/**\r\n * Allows an organizer to edit an existing event.\r\n *\r\n * Expects \"eventId\" in the fragment arguments bundle.\r\n * Loads the event from Firestore, pre-fills the form, and saves updates back.\r\n */\r\npublic class OrganizerEditEventFragment extends Fragment {\r\n\r\n    // UI components (must match your XML ids)\r\n    private EditText eventTitleField;\r\n    private EditText eventLimitField;\r\n    private CheckBox geoCheckBox;\r\n    private CheckBox qrCheckBox;\r\n    private Button uploadPosterButton;\r\n\r\n    private EditText eventAddressField;\r\n    private EditText eventCityField;\r\n    private EditText eventProvinceField;\r\n    private EditText eventDescriptionField;\r\n\r\n    private EditText eventDateField;\r\n    private EditText eventTimeField;\r\n    private EditText regStartDateField;\r\n    private EditText regEndDateField;\r\n\r\n    private Button resetButton;\r\n    private Button saveButton;\r\n\r\n    // Date/time handling\r\n    private final Calendar eventCalendar = Calendar.getInstance();\r\n    private final Calendar regStartCalendar = Calendar.getInstance();\r\n    private final Calendar regEndCalendar = Calendar.getInstance();\r\n    private final SimpleDateFormat dateFmt =\r\n            new SimpleDateFormat(\"yyyy-MM-dd\", Locale.getDefault());\r\n    private final SimpleDateFormat timeFmt =\r\n            new SimpleDateFormat(\"HH:mm\", Locale.getDefault());\r\n\r\n    // Poster\r\n    private Uri posterImageUri;           // new selected image (if any)\r\n    private String existingPosterUrl;     // existing URL from Firestore (for info only)\r\n    private ActivityResultLauncher<String> pickImageLauncher;\r\n\r\n    // Event id to edit\r\n    private String eventId;\r\n\r\n    public OrganizerEditEventFragment() {\r\n        // Required empty public constructor\r\n    }\r\n\r\n    @Override\r\n    public void onCreate(@Nullable Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n\r\n        // image picker for replacing poster\r\n        pickImageLauncher = registerForActivityResult(\r\n                new ActivityResultContracts.GetContent(),\r\n                uri -> {\r\n                    if (uri != null) {\r\n                        posterImageUri = uri;\r\n                        if (uploadPosterButton != null) {\r\n                            uploadPosterButton.setText(\"Poster selected\");\r\n                        }\r\n                    }\r\n                }\r\n        );\r\n    }\r\n\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, ViewGroup container,\r\n                             Bundle savedInstanceState) {\r\n        return inflater.inflate(R.layout.fragment_organizer_edit_event, container, false);\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(@NonNull View view,\r\n                              @Nullable Bundle savedInstanceState) {\r\n        super.onViewCreated(view, savedInstanceState);\r\n\r\n        // --- Header buttons ---\r\n        ImageButton backBtn = view.findViewById(R.id.button_back);\r\n        backBtn.setOnClickListener(v -> Navigation.findNavController(view).navigateUp());\r\n\r\n        ImageButton infoBtn = view.findViewById(R.id.button_info);\r\n        if (infoBtn != null) {\r\n            infoBtn.setOnClickListener(v ->\r\n                    Toast.makeText(getContext(),\r\n                            \"Edit your event details and tap SAVE.\",\r\n                            Toast.LENGTH_SHORT).show()\r\n            );\r\n        }\r\n\r\n        // --- Bind all views ---\r\n        eventTitleField      = view.findViewById(R.id.edit_event_title);\r\n        eventLimitField      = view.findViewById(R.id.edit_limit);\r\n        geoCheckBox          = view.findViewById(R.id.checkbox_geo);\r\n        qrCheckBox           = view.findViewById(R.id.checkbox_qr);\r\n        uploadPosterButton   = view.findViewById(R.id.button_upload_poster);\r\n\r\n        eventAddressField    = view.findViewById(R.id.edit_address);\r\n        eventCityField       = view.findViewById(R.id.edit_city);\r\n        eventProvinceField   = view.findViewById(R.id.edit_province);\r\n        eventDescriptionField= view.findViewById(R.id.edit_description);\r\n\r\n        eventDateField       = view.findViewById(R.id.edit_date);\r\n        eventTimeField       = view.findViewById(R.id.edit_time);\r\n        regStartDateField    = view.findViewById(R.id.edit_registration_start);\r\n        regEndDateField      = view.findViewById(R.id.edit_registration_end);\r\n\r\n        resetButton          = view.findViewById(R.id.button_reset);\r\n        saveButton           = view.findViewById(R.id.button_create);\r\n\r\n        // Change label from CREATE -> SAVE for this screen\r\n        saveButton.setText(\"SAVE\");\r\n\r\n        // Date/time pickers\r\n        setupPickers();\r\n\r\n        // Poster picker\r\n        uploadPosterButton.setOnClickListener(v -> pickImageLauncher.launch(\"image/*\"));\r\n\r\n        // Get eventId from arguments\r\n        if (getArguments() != null) {\r\n            eventId = getArguments().getString(\"eventId\");\r\n        }\r\n\r\n        if (TextUtils.isEmpty(eventId)) {\r\n            Toast.makeText(getContext(),\r\n                    \"Missing eventId for editing\",\r\n                    Toast.LENGTH_LONG).show();\r\n            Navigation.findNavController(view).navigateUp();\r\n            return;\r\n        }\r\n\r\n        // Load event and prefill fields\r\n        loadEvent(eventId);\r\n\r\n        // Buttons\r\n        resetButton.setOnClickListener(v -> loadEvent(eventId));   // reload from Firestore\r\n        saveButton.setOnClickListener(v -> saveChanges());\r\n    }\r\n\r\n    /**\r\n     * Loads the event document from Firestore and fills the form.\r\n     */\r\n    private void loadEvent(String eventId) {\r\n        DbManager.getInstance().getDb()\r\n                .collection(\"events\")\r\n                .document(eventId)\r\n                .get()\r\n                .addOnSuccessListener(this::applyEventSnapshot)\r\n                .addOnFailureListener(e -> {\r\n                    if (getContext() != null) {\r\n                        Toast.makeText(getContext(),\r\n                                \"Failed to load event: \" + e.getMessage(),\r\n                                Toast.LENGTH_LONG).show();\r\n                    }\r\n                });\r\n    }\r\n\r\n    /**\r\n     * Apply Firestore snapshot into UI fields + calendars.\r\n     */\r\n    private void applyEventSnapshot(DocumentSnapshot doc) {\r\n        if (!doc.exists()) {\r\n            if (getContext() != null) {\r\n                Toast.makeText(getContext(),\r\n                        \"Event not found.\",\r\n                        Toast.LENGTH_LONG).show();\r\n            }\r\n            return;\r\n        }\r\n\r\n        String title       = doc.getString(\"eventName\");\r\n        String description = doc.getString(\"description\");\r\n        String location    = doc.getString(\"eventLocation\");\r\n        Long   capacity    = doc.getLong(\"eventCapacity\");\r\n        Long   waitLimit   = doc.getLong(\"waitingListLimit\");\r\n        String qrHash      = doc.getString(\"qrCodeHash\");\r\n        existingPosterUrl  = doc.getString(\"eventPosterURL\");\r\n\r\n        // Title\r\n        if (title != null) eventTitleField.setText(title);\r\n        else eventTitleField.setText(\"\");\r\n\r\n        // Description\r\n        if (description != null) eventDescriptionField.setText(description);\r\n        else eventDescriptionField.setText(\"\");\r\n\r\n        // Capacity / waitlist limit\r\n        if (waitLimit != null) {\r\n            eventLimitField.setText(String.valueOf(waitLimit));\r\n        } else {\r\n            eventLimitField.setText(\"\");\r\n        }\r\n\r\n        // Location: we originally stored \"address, city\". Try to split.\r\n        if (location != null) {\r\n            String addr = location;\r\n            String city = \"\";\r\n            int comma = location.indexOf(',');\r\n            if (comma >= 0) {\r\n                addr = location.substring(0, comma).trim();\r\n                city = location.substring(comma + 1).trim();\r\n            }\r\n            eventAddressField.setText(addr);\r\n            eventCityField.setText(city);\r\n        } else {\r\n            eventAddressField.setText(\"\");\r\n            eventCityField.setText(\"\");\r\n        }\r\n        // Province wasn't stored separately; leave empty\r\n        eventProvinceField.setText(\"\");\r\n\r\n        // QR checkbox\r\n        qrCheckBox.setChecked(qrHash != null && !qrHash.isEmpty());\r\n\r\n        // Poster button text\r\n        if (existingPosterUrl != null && !existingPosterUrl.isEmpty()) {\r\n            uploadPosterButton.setText(\"Change poster\");\r\n        } else {\r\n            uploadPosterButton.setText(\"+ Upload Poster\");\r\n        }\r\n\r\n        // Event start time\r\n        Object startObj = doc.get(\"eventStartTime\");\r\n        Date startDate = null;\r\n        if (startObj instanceof Timestamp) {\r\n            startDate = ((Timestamp) startObj).toDate();\r\n        } else if (startObj instanceof Date) {\r\n            startDate = (Date) startObj;\r\n        }\r\n        if (startDate != null) {\r\n            eventCalendar.setTime(startDate);\r\n            eventDateField.setText(dateFmt.format(startDate));\r\n            eventTimeField.setText(timeFmt.format(startDate));\r\n        } else {\r\n            eventDateField.setText(\"\");\r\n            eventTimeField.setText(\"\");\r\n        }\r\n\r\n        // Registration start\r\n        Object rsObj = doc.get(\"registrationStart\");\r\n        Date rsDate = null;\r\n        if (rsObj instanceof Timestamp) {\r\n            rsDate = ((Timestamp) rsObj).toDate();\r\n        } else if (rsObj instanceof Date) {\r\n            rsDate = (Date) rsObj;\r\n        }\r\n        if (rsDate != null) {\r\n            regStartCalendar.setTime(rsDate);\r\n            regStartDateField.setText(dateFmt.format(rsDate));\r\n        } else {\r\n            regStartDateField.setText(\"\");\r\n        }\r\n\r\n        // Registration end\r\n        Object reObj = doc.get(\"registrationEnd\");\r\n        Date reDate = null;\r\n        if (reObj instanceof Timestamp) {\r\n            reDate = ((Timestamp) reObj).toDate();\r\n        } else if (reObj instanceof Date) {\r\n            reDate = (Date) reObj;\r\n        }\r\n        if (reDate != null) {\r\n            regEndCalendar.setTime(reDate);\r\n            regEndDateField.setText(dateFmt.format(reDate));\r\n        } else {\r\n            regEndDateField.setText(\"\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Saves edited values back into the same event document.\r\n     */\r\n    private void saveChanges() {\r\n        if (TextUtils.isEmpty(eventId)) return;\r\n\r\n        String title = eventTitleField.getText().toString().trim();\r\n        if (title.isEmpty()) {\r\n            Toast.makeText(getContext(),\r\n                    \"Title is required\",\r\n                    Toast.LENGTH_SHORT).show();\r\n            return;\r\n        }\r\n\r\n        String desc = eventDescriptionField.getText().toString().trim();\r\n        String limitStr = eventLimitField.getText().toString().trim();\r\n        int waitlistLimit = limitStr.isEmpty() ? 0 : Integer.parseInt(limitStr);\r\n\r\n        String address = eventAddressField.getText().toString().trim();\r\n        String city = eventCityField.getText().toString().trim();\r\n        String province = eventProvinceField.getText().toString().trim();\r\n\r\n        String combinedLocation;\r\n        if (!city.isEmpty()) {\r\n            combinedLocation = address + \", \" + city;\r\n        } else {\r\n            combinedLocation = address;\r\n        }\r\n        // Province not yet stored in schema; you can append if desired:\r\n        // if (!province.isEmpty()) combinedLocation += \", \" + province;\r\n\r\n        // Use an arbitrary capacity for now (schema already uses eventCapacity = 100 in create)\r\n        // If you later add a capacity field to the UI, wire it in here.\r\n        int capacity = 100;\r\n\r\n        saveButton.setEnabled(false);\r\n        saveButton.setText(\"Saving...\");\r\n\r\n        Map<String, Object> updates = new HashMap<>();\r\n        updates.put(\"eventName\", title);\r\n        updates.put(\"description\", desc);\r\n        updates.put(\"eventLocation\", combinedLocation);\r\n        updates.put(\"eventCapacity\", capacity);\r\n        updates.put(\"waitingListLimit\", waitlistLimit);\r\n        updates.put(\"eventStartTime\", eventCalendar.getTime());\r\n        updates.put(\"registrationStart\", regStartCalendar.getTime());\r\n        updates.put(\"registrationEnd\", regEndCalendar.getTime());\r\n\r\n        if (qrCheckBox.isChecked()) {\r\n            updates.put(\"qrCodeHash\", eventId);\r\n        } else {\r\n            // remove QR or set null; here we clear it\r\n            updates.put(\"qrCodeHash\", null);\r\n        }\r\n\r\n        Task<Void> updateTask = DbManager.getInstance()\r\n                .getDb()\r\n                .collection(\"events\")\r\n                .document(eventId)\r\n                .set(updates, SetOptions.merge());\r\n\r\n        updateTask\r\n                .addOnSuccessListener(aVoid -> {\r\n                    // If a new poster was chosen, upload it\r\n                    if (posterImageUri != null) {\r\n                        DbManager.getInstance().uploadEventPoster(eventId, posterImageUri);\r\n                    }\r\n\r\n                    if (getContext() != null) {\r\n                        Toast.makeText(getContext(),\r\n                                \"Event updated\",\r\n                                Toast.LENGTH_SHORT).show();\r\n                    }\r\n                    if (getView() != null) {\r\n                        Navigation.findNavController(getView()).navigateUp();\r\n                    }\r\n                })\r\n                .addOnFailureListener(e -> {\r\n                    if (getContext() != null) {\r\n                        Toast.makeText(getContext(),\r\n                                \"Failed to save changes: \" + e.getMessage(),\r\n                                Toast.LENGTH_LONG).show();\r\n                    }\r\n                    saveButton.setEnabled(true);\r\n                    saveButton.setText(\"SAVE\");\r\n                });\r\n    }\r\n\r\n    // ------------------------------------------------------------\r\n    // Date/time pickers + helpers\r\n    // ------------------------------------------------------------\r\n\r\n    private void setupPickers() {\r\n        makeReadOnly(eventDateField);\r\n        makeReadOnly(eventTimeField);\r\n        makeReadOnly(regStartDateField);\r\n        makeReadOnly(regEndDateField);\r\n\r\n        eventDateField.setOnClickListener(v -> showDate(eventCalendar, eventDateField));\r\n        eventTimeField.setOnClickListener(v -> showTime(eventCalendar, eventTimeField));\r\n        regStartDateField.setOnClickListener(v -> showDate(regStartCalendar, regStartDateField));\r\n        regEndDateField.setOnClickListener(v -> showDate(regEndCalendar, regEndDateField));\r\n    }\r\n\r\n    private void makeReadOnly(EditText et) {\r\n        et.setFocusable(false);\r\n        et.setClickable(true);\r\n    }\r\n\r\n    private void showDate(Calendar cal, EditText et) {\r\n        new DatePickerDialog(getContext(), (picker, y, m, d) -> {\r\n            cal.set(Calendar.YEAR, y);\r\n            cal.set(Calendar.MONTH, m);\r\n            cal.set(Calendar.DAY_OF_MONTH, d);\r\n            et.setText(dateFmt.format(cal.getTime()));\r\n        }, cal.get(Calendar.YEAR),\r\n                cal.get(Calendar.MONTH),\r\n                cal.get(Calendar.DAY_OF_MONTH)).show();\r\n    }\r\n\r\n    private void showTime(Calendar cal, EditText et) {\r\n        new TimePickerDialog(getContext(), (picker, h, min) -> {\r\n            cal.set(Calendar.HOUR_OF_DAY, h);\r\n            cal.set(Calendar.MINUTE, min);\r\n            et.setText(timeFmt.format(cal.getTime()));\r\n        }, cal.get(Calendar.HOUR_OF_DAY),\r\n                cal.get(Calendar.MINUTE),\r\n                true).show();\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEditEventFragment.java b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEditEventFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEditEventFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerEditEventFragment.java	(date 1764449277203)
@@ -12,7 +12,6 @@
 import android.widget.CheckBox;
 import android.widget.EditText;
 import android.widget.ImageButton;
-import android.widget.ImageView;
 import android.widget.Toast;
 
 import androidx.activity.result.ActivityResultLauncher;
@@ -38,15 +37,14 @@
 
 /**
  * Allows an organizer to edit an existing event.
- *
- * Expects "eventId" in the fragment arguments bundle.
- * Loads the event from Firestore, pre-fills the form, and saves updates back.
+ * Handles loading data, updating fields (including Capacity/Limit), and saving changes.
  */
 public class OrganizerEditEventFragment extends Fragment {
 
-    // UI components (must match your XML ids)
+    // UI components
     private EditText eventTitleField;
-    private EditText eventLimitField;
+    private EditText eventLimitField;    // Waitlist Limit
+    private EditText eventCapacityField; // Max Attendees (Capacity)
     private CheckBox geoCheckBox;
     private CheckBox qrCheckBox;
     private Button uploadPosterButton;
@@ -64,32 +62,23 @@
     private Button resetButton;
     private Button saveButton;
 
-    // Date/time handling
+
     private final Calendar eventCalendar = Calendar.getInstance();
     private final Calendar regStartCalendar = Calendar.getInstance();
     private final Calendar regEndCalendar = Calendar.getInstance();
-    private final SimpleDateFormat dateFmt =
-            new SimpleDateFormat("yyyy-MM-dd", Locale.getDefault());
-    private final SimpleDateFormat timeFmt =
-            new SimpleDateFormat("HH:mm", Locale.getDefault());
+    private final SimpleDateFormat dateFmt = new SimpleDateFormat("yyyy-MM-dd", Locale.getDefault());
+    private final SimpleDateFormat timeFmt = new SimpleDateFormat("HH:mm", Locale.getDefault());
 
-    // Poster
-    private Uri posterImageUri;           // new selected image (if any)
-    private String existingPosterUrl;     // existing URL from Firestore (for info only)
+    private Uri posterImageUri;
+    private String existingPosterUrl;
     private ActivityResultLauncher<String> pickImageLauncher;
-
-    // Event id to edit
     private String eventId;
 
-    public OrganizerEditEventFragment() {
-        // Required empty public constructor
-    }
+    public OrganizerEditEventFragment() { }
 
     @Override
     public void onCreate(@Nullable Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-
-        // image picker for replacing poster
         pickImageLauncher = registerForActivityResult(
                 new ActivityResultContracts.GetContent(),
                 uri -> {
@@ -104,35 +93,40 @@
     }
 
     @Override
-    public View onCreateView(LayoutInflater inflater, ViewGroup container,
-                             Bundle savedInstanceState) {
+    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
         return inflater.inflate(R.layout.fragment_organizer_edit_event, container, false);
     }
 
     @Override
-    public void onViewCreated(@NonNull View view,
-                              @Nullable Bundle savedInstanceState) {
+    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
         super.onViewCreated(view, savedInstanceState);
 
-        // --- Header buttons ---
+        // prevent null pointer
         ImageButton backBtn = view.findViewById(R.id.button_back);
-        backBtn.setOnClickListener(v -> Navigation.findNavController(view).navigateUp());
+        if (backBtn != null) backBtn.setOnClickListener(v -> Navigation.findNavController(view).navigateUp());
 
         ImageButton infoBtn = view.findViewById(R.id.button_info);
         if (infoBtn != null) {
-            infoBtn.setOnClickListener(v ->
-                    Toast.makeText(getContext(),
-                            "Edit your event details and tap SAVE.",
-                            Toast.LENGTH_SHORT).show()
-            );
+            infoBtn.setOnClickListener(v -> Toast.makeText(getContext(), "Edit details and tap SAVE.", Toast.LENGTH_SHORT).show());
         }
 
-        // --- Bind all views ---
+
         eventTitleField      = view.findViewById(R.id.edit_event_title);
         eventLimitField      = view.findViewById(R.id.edit_limit);
+        eventCapacityField   = view.findViewById(R.id.edit_capacity);
+
         geoCheckBox          = view.findViewById(R.id.checkbox_geo);
         qrCheckBox           = view.findViewById(R.id.checkbox_qr);
+
+
         uploadPosterButton   = view.findViewById(R.id.button_upload_poster);
+        resetButton          = view.findViewById(R.id.button_reset);
+
+
+        saveButton = view.findViewById(R.id.button_save);
+        if (saveButton == null) {
+            saveButton = view.findViewById(R.id.button_create);
+        }
 
         eventAddressField    = view.findViewById(R.id.edit_address);
         eventCityField       = view.findViewById(R.id.edit_city);
@@ -144,296 +138,180 @@
         regStartDateField    = view.findViewById(R.id.edit_registration_start);
         regEndDateField      = view.findViewById(R.id.edit_registration_end);
 
-        resetButton          = view.findViewById(R.id.button_reset);
-        saveButton           = view.findViewById(R.id.button_create);
 
-        // Change label from CREATE -> SAVE for this screen
-        saveButton.setText("SAVE");
-
-        // Date/time pickers
         setupPickers();
 
-        // Poster picker
-        uploadPosterButton.setOnClickListener(v -> pickImageLauncher.launch("image/*"));
+        if (uploadPosterButton != null) {
+            uploadPosterButton.setOnClickListener(v -> pickImageLauncher.launch("image/*"));
+        }
+
+        if (saveButton != null) {
+            saveButton.setText("SAVE");
+            saveButton.setOnClickListener(v -> saveChanges());
+        }
 
-        // Get eventId from arguments
+        if (resetButton != null) {
+            resetButton.setOnClickListener(v -> loadEvent(eventId));
+        }
+
+        // --- 3. LOAD DATA ---
         if (getArguments() != null) {
             eventId = getArguments().getString("eventId");
         }
 
         if (TextUtils.isEmpty(eventId)) {
-            Toast.makeText(getContext(),
-                    "Missing eventId for editing",
-                    Toast.LENGTH_LONG).show();
-            Navigation.findNavController(view).navigateUp();
+            Toast.makeText(getContext(), "Missing eventId", Toast.LENGTH_LONG).show();
             return;
         }
 
-        // Load event and prefill fields
         loadEvent(eventId);
-
-        // Buttons
-        resetButton.setOnClickListener(v -> loadEvent(eventId));   // reload from Firestore
-        saveButton.setOnClickListener(v -> saveChanges());
     }
 
-    /**
-     * Loads the event document from Firestore and fills the form.
-     */
     private void loadEvent(String eventId) {
-        DbManager.getInstance().getDb()
-                .collection("events")
-                .document(eventId)
-                .get()
+        DbManager.getInstance().getDb().collection("events").document(eventId).get()
                 .addOnSuccessListener(this::applyEventSnapshot)
-                .addOnFailureListener(e -> {
-                    if (getContext() != null) {
-                        Toast.makeText(getContext(),
-                                "Failed to load event: " + e.getMessage(),
-                                Toast.LENGTH_LONG).show();
-                    }
-                });
+                .addOnFailureListener(e -> Toast.makeText(getContext(), "Failed to load event", Toast.LENGTH_SHORT).show());
     }
 
-    /**
-     * Apply Firestore snapshot into UI fields + calendars.
-     */
     private void applyEventSnapshot(DocumentSnapshot doc) {
-        if (!doc.exists()) {
-            if (getContext() != null) {
-                Toast.makeText(getContext(),
-                        "Event not found.",
-                        Toast.LENGTH_LONG).show();
-            }
-            return;
-        }
+        if (!doc.exists()) return;
+
+        if (eventTitleField != null) eventTitleField.setText(doc.getString("eventName"));
+        if (eventDescriptionField != null) eventDescriptionField.setText(doc.getString("description"));
 
-        String title       = doc.getString("eventName");
-        String description = doc.getString("description");
-        String location    = doc.getString("eventLocation");
-        Long   capacity    = doc.getLong("eventCapacity");
-        Long   waitLimit   = doc.getLong("waitingListLimit");
-        String qrHash      = doc.getString("qrCodeHash");
-        existingPosterUrl  = doc.getString("eventPosterURL");
-
-        // Title
-        if (title != null) eventTitleField.setText(title);
-        else eventTitleField.setText("");
-
-        // Description
-        if (description != null) eventDescriptionField.setText(description);
-        else eventDescriptionField.setText("");
-
-        // Capacity / waitlist limit
-        if (waitLimit != null) {
-            eventLimitField.setText(String.valueOf(waitLimit));
-        } else {
-            eventLimitField.setText("");
-        }
-
-        // Location: we originally stored "address, city". Try to split.
-        if (location != null) {
-            String addr = location;
-            String city = "";
-            int comma = location.indexOf(',');
-            if (comma >= 0) {
-                addr = location.substring(0, comma).trim();
-                city = location.substring(comma + 1).trim();
-            }
-            eventAddressField.setText(addr);
-            eventCityField.setText(city);
-        } else {
-            eventAddressField.setText("");
-            eventCityField.setText("");
-        }
-        // Province wasn't stored separately; leave empty
-        eventProvinceField.setText("");
-
-        // QR checkbox
-        qrCheckBox.setChecked(qrHash != null && !qrHash.isEmpty());
-
-        // Poster button text
-        if (existingPosterUrl != null && !existingPosterUrl.isEmpty()) {
-            uploadPosterButton.setText("Change poster");
-        } else {
-            uploadPosterButton.setText("+ Upload Poster");
+        Long capacity = doc.getLong("eventCapacity");
+        if (eventCapacityField != null) eventCapacityField.setText(capacity != null ? String.valueOf(capacity) : "");
+
+        Long limit = doc.getLong("waitingListLimit");
+        if (eventLimitField != null) eventLimitField.setText(limit != null ? String.valueOf(limit) : "");
+
+        // Location splitting logic...
+        String location = doc.getString("eventLocation");
+        if (location != null && eventAddressField != null) {
+            eventAddressField.setText(location);
+        }
+
+        if (qrCheckBox != null) {
+            String qrHash = doc.getString("qrCodeHash");
+            qrCheckBox.setChecked(qrHash != null && !qrHash.isEmpty());
         }
 
-        // Event start time
-        Object startObj = doc.get("eventStartTime");
-        Date startDate = null;
-        if (startObj instanceof Timestamp) {
-            startDate = ((Timestamp) startObj).toDate();
-        } else if (startObj instanceof Date) {
-            startDate = (Date) startObj;
+        Boolean geoRequired = doc.getBoolean("geolocationRequired");
+        if (geoCheckBox != null) {
+            geoCheckBox.setChecked(geoRequired != null && geoRequired);
         }
-        if (startDate != null) {
-            eventCalendar.setTime(startDate);
-            eventDateField.setText(dateFmt.format(startDate));
-            eventTimeField.setText(timeFmt.format(startDate));
-        } else {
-            eventDateField.setText("");
-            eventTimeField.setText("");
-        }
+
+        // Dates
+        setCalendarFromDoc(doc, "eventStartTime", eventCalendar, eventDateField, eventTimeField);
+        setCalendarFromDoc(doc, "registrationStart", regStartCalendar, regStartDateField, null);
+        setCalendarFromDoc(doc, "registrationEnd", regEndCalendar, regEndDateField, null);
+    }
 
-        // Registration start
-        Object rsObj = doc.get("registrationStart");
-        Date rsDate = null;
-        if (rsObj instanceof Timestamp) {
-            rsDate = ((Timestamp) rsObj).toDate();
-        } else if (rsObj instanceof Date) {
-            rsDate = (Date) rsObj;
-        }
-        if (rsDate != null) {
-            regStartCalendar.setTime(rsDate);
-            regStartDateField.setText(dateFmt.format(rsDate));
-        } else {
-            regStartDateField.setText("");
-        }
+    private void setCalendarFromDoc(DocumentSnapshot doc, String field, Calendar cal, EditText dateField, EditText timeField) {
+        Object obj = doc.get(field);
+        Date date = null;
+        if (obj instanceof Timestamp) date = ((Timestamp) obj).toDate();
+        else if (obj instanceof Date) date = (Date) obj;
 
-        // Registration end
-        Object reObj = doc.get("registrationEnd");
-        Date reDate = null;
-        if (reObj instanceof Timestamp) {
-            reDate = ((Timestamp) reObj).toDate();
-        } else if (reObj instanceof Date) {
-            reDate = (Date) reObj;
-        }
-        if (reDate != null) {
-            regEndCalendar.setTime(reDate);
-            regEndDateField.setText(dateFmt.format(reDate));
-        } else {
-            regEndDateField.setText("");
+        if (date != null) {
+            cal.setTime(date);
+            if (dateField != null) dateField.setText(dateFmt.format(date));
+            if (timeField != null) timeField.setText(timeFmt.format(date));
         }
     }
 
-    /**
-     * Saves edited values back into the same event document.
-     */
     private void saveChanges() {
         if (TextUtils.isEmpty(eventId)) return;
 
-        String title = eventTitleField.getText().toString().trim();
+        String title = (eventTitleField != null) ? eventTitleField.getText().toString().trim() : "";
         if (title.isEmpty()) {
-            Toast.makeText(getContext(),
-                    "Title is required",
-                    Toast.LENGTH_SHORT).show();
+            Toast.makeText(getContext(), "Title is required", Toast.LENGTH_SHORT).show();
             return;
         }
 
-        String desc = eventDescriptionField.getText().toString().trim();
-        String limitStr = eventLimitField.getText().toString().trim();
-        int waitlistLimit = limitStr.isEmpty() ? 0 : Integer.parseInt(limitStr);
 
-        String address = eventAddressField.getText().toString().trim();
-        String city = eventCityField.getText().toString().trim();
-        String province = eventProvinceField.getText().toString().trim();
+        int capacity = 0;
+        if (eventCapacityField != null) {
+            String s = eventCapacityField.getText().toString().trim();
+            if (!s.isEmpty()) capacity = Integer.parseInt(s);
+        }
 
-        String combinedLocation;
-        if (!city.isEmpty()) {
-            combinedLocation = address + ", " + city;
-        } else {
-            combinedLocation = address;
+        int limit = 0;
+        if (eventLimitField != null) {
+            String s = eventLimitField.getText().toString().trim();
+            if (!s.isEmpty()) limit = Integer.parseInt(s);
         }
-        // Province not yet stored in schema; you can append if desired:
-        // if (!province.isEmpty()) combinedLocation += ", " + province;
 
-        // Use an arbitrary capacity for now (schema already uses eventCapacity = 100 in create)
-        // If you later add a capacity field to the UI, wire it in here.
-        int capacity = 100;
+        String desc = (eventDescriptionField != null) ? eventDescriptionField.getText().toString().trim() : "";
+        String location = (eventAddressField != null) ? eventAddressField.getText().toString().trim() : "";
 
-        saveButton.setEnabled(false);
-        saveButton.setText("Saving...");
+        if (saveButton != null) {
+            saveButton.setEnabled(false);
+            saveButton.setText("Saving...");
+        }
 
         Map<String, Object> updates = new HashMap<>();
         updates.put("eventName", title);
         updates.put("description", desc);
-        updates.put("eventLocation", combinedLocation);
+        updates.put("eventLocation", location);
         updates.put("eventCapacity", capacity);
-        updates.put("waitingListLimit", waitlistLimit);
+        updates.put("waitingListLimit", limit);
         updates.put("eventStartTime", eventCalendar.getTime());
         updates.put("registrationStart", regStartCalendar.getTime());
         updates.put("registrationEnd", regEndCalendar.getTime());
 
-        if (qrCheckBox.isChecked()) {
-            updates.put("qrCodeHash", eventId);
-        } else {
-            // remove QR or set null; here we clear it
-            updates.put("qrCodeHash", null);
+        if (qrCheckBox != null) {
+            updates.put("qrCodeHash", qrCheckBox.isChecked() ? eventId : null);
         }
-
-        Task<Void> updateTask = DbManager.getInstance()
-                .getDb()
-                .collection("events")
-                .document(eventId)
-                .set(updates, SetOptions.merge());
+        if (geoCheckBox != null) {
+            updates.put("geolocationRequired", geoCheckBox.isChecked());
+        }
 
-        updateTask
+        DbManager.getInstance().getDb().collection("events").document(eventId)
+                .set(updates, SetOptions.merge())
                 .addOnSuccessListener(aVoid -> {
-                    // If a new poster was chosen, upload it
                     if (posterImageUri != null) {
                         DbManager.getInstance().uploadEventPoster(eventId, posterImageUri);
                     }
-
-                    if (getContext() != null) {
-                        Toast.makeText(getContext(),
-                                "Event updated",
-                                Toast.LENGTH_SHORT).show();
-                    }
-                    if (getView() != null) {
-                        Navigation.findNavController(getView()).navigateUp();
-                    }
+                    Toast.makeText(getContext(), "Event updated", Toast.LENGTH_SHORT).show();
+                    if (getView() != null) Navigation.findNavController(getView()).navigateUp();
                 })
                 .addOnFailureListener(e -> {
-                    if (getContext() != null) {
-                        Toast.makeText(getContext(),
-                                "Failed to save changes: " + e.getMessage(),
-                                Toast.LENGTH_LONG).show();
-                    }
-                    saveButton.setEnabled(true);
-                    saveButton.setText("SAVE");
+                    if (saveButton != null) {
+                        saveButton.setEnabled(true);
+                        saveButton.setText("SAVE");
+                    }
+                    Toast.makeText(getContext(), "Failed to save", Toast.LENGTH_SHORT).show();
                 });
     }
-
-    // ------------------------------------------------------------
-    // Date/time pickers + helpers
-    // ------------------------------------------------------------
 
     private void setupPickers() {
-        makeReadOnly(eventDateField);
-        makeReadOnly(eventTimeField);
-        makeReadOnly(regStartDateField);
-        makeReadOnly(regEndDateField);
-
-        eventDateField.setOnClickListener(v -> showDate(eventCalendar, eventDateField));
-        eventTimeField.setOnClickListener(v -> showTime(eventCalendar, eventTimeField));
-        regStartDateField.setOnClickListener(v -> showDate(regStartCalendar, regStartDateField));
-        regEndDateField.setOnClickListener(v -> showDate(regEndCalendar, regEndDateField));
+        setupDatePicker(eventDateField, eventCalendar);
+        setupTimePicker(eventTimeField, eventCalendar);
+        setupDatePicker(regStartDateField, regStartCalendar);
+        setupDatePicker(regEndDateField, regEndCalendar);
     }
 
-    private void makeReadOnly(EditText et) {
+    private void setupDatePicker(EditText et, Calendar cal) {
+        if (et == null) return;
         et.setFocusable(false);
         et.setClickable(true);
-    }
-
-    private void showDate(Calendar cal, EditText et) {
-        new DatePickerDialog(getContext(), (picker, y, m, d) -> {
+        et.setOnClickListener(v -> new DatePickerDialog(getContext(), (view, y, m, d) -> {
             cal.set(Calendar.YEAR, y);
             cal.set(Calendar.MONTH, m);
             cal.set(Calendar.DAY_OF_MONTH, d);
             et.setText(dateFmt.format(cal.getTime()));
-        }, cal.get(Calendar.YEAR),
-                cal.get(Calendar.MONTH),
-                cal.get(Calendar.DAY_OF_MONTH)).show();
+        }, cal.get(Calendar.YEAR), cal.get(Calendar.MONTH), cal.get(Calendar.DAY_OF_MONTH)).show());
     }
 
-    private void showTime(Calendar cal, EditText et) {
-        new TimePickerDialog(getContext(), (picker, h, min) -> {
+    private void setupTimePicker(EditText et, Calendar cal) {
+        if (et == null) return;
+        et.setFocusable(false);
+        et.setClickable(true);
+        et.setOnClickListener(v -> new TimePickerDialog(getContext(), (view, h, m) -> {
             cal.set(Calendar.HOUR_OF_DAY, h);
-            cal.set(Calendar.MINUTE, min);
+            cal.set(Calendar.MINUTE, m);
             et.setText(timeFmt.format(cal.getTime()));
-        }, cal.get(Calendar.HOUR_OF_DAY),
-                cal.get(Calendar.MINUTE),
-                true).show();
+        }, cal.get(Calendar.HOUR_OF_DAY), cal.get(Calendar.MINUTE), true).show());
     }
-}
+}
\ No newline at end of file
Index: app/src/main/AndroidManifest.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\">\r\n\r\n    <application\r\n        android:name=\".MyApp\"\r\n        android:allowBackup=\"true\"\r\n        android:dataExtractionRules=\"@xml/data_extraction_rules\"\r\n        android:fullBackupContent=\"@xml/backup_rules\"\r\n        android:icon=\"@mipmap/ic_launcher\"\r\n        android:roundIcon=\"@mipmap/ic_launcher_round\"\r\n        android:label=\"@string/app_name\"\r\n        android:supportsRtl=\"true\"\r\n        android:theme=\"@style/Theme.MagpieWingman\">\r\n\r\n        <!--\r\n             TODO: Before you run your application, you need a Google Maps API key.\r\n\r\n             To get one, follow the directions here:\r\n\r\n                https://developers.google.com/maps/documentation/android-sdk/get-api-key\r\n\r\n             Once you have your API key (it starts with \"AIza\"), define a new property in your\r\n             project's local.properties file (e.g. MAPS_API_KEY=Aiza...), and replace the\r\n             \"YOUR_API_KEY\" string in this file with \"${MAPS_API_KEY}\".\r\n        -->\r\n        <meta-data\r\n            android:name=\"com.google.android.geo.API_KEY\"\r\n            android:value=\"YOUR_API_KEY\" />\r\n\r\n        <activity\r\n            android:name=\".MainActivity\"\r\n            android:exported=\"true\"\r\n            android:theme=\"@style/Theme.MagpieWingman\">\r\n\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.MAIN\" />\r\n                <category android:name=\"android.intent.category.LAUNCHER\" />\r\n            </intent-filter>\r\n\r\n        </activity>\r\n    </application>\r\n\r\n</manifest>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
--- a/app/src/main/AndroidManifest.xml	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/AndroidManifest.xml	(date 1764449277198)
@@ -2,6 +2,7 @@
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools">
 
+    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
     <application
         android:name=".MyApp"
         android:allowBackup="true"
Index: app/src/main/java/com/example/magpie_wingman/organizer/OrganizerGeolocationFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.organizer;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport android.os.Bundle;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\n\r\nimport com.example.magpie_wingman.R;\r\nimport com.google.android.gms.maps.CameraUpdateFactory;\r\nimport com.google.android.gms.maps.GoogleMap;\r\nimport com.google.android.gms.maps.OnMapReadyCallback;\r\nimport com.google.android.gms.maps.SupportMapFragment;\r\nimport com.google.android.gms.maps.model.LatLng;\r\nimport com.google.android.gms.maps.model.MarkerOptions;\r\n\r\npublic class OrganizerGeolocationFragment extends Fragment {\r\n\r\n    private OnMapReadyCallback callback = new OnMapReadyCallback() {\r\n\r\n        /**\r\n         * Manipulates the map once available.\r\n         * This callback is triggered when the map is ready to be used.\r\n         * This is where we can add markers or lines, add listeners or move the camera.\r\n         * In this case, we just add a marker near Sydney, Australia.\r\n         * If Google Play services is not installed on the device, the user will be prompted to\r\n         * install it inside the SupportMapFragment. This method will only be triggered once the\r\n         * user has installed Google Play services and returned to the app.\r\n         */\r\n        @Override\r\n        public void onMapReady(GoogleMap googleMap) {\r\n            LatLng sydney = new LatLng(-34, 151);\r\n            googleMap.addMarker(new MarkerOptions().position(sydney).title(\"Marker in Sydney\"));\r\n            googleMap.moveCamera(CameraUpdateFactory.newLatLng(sydney));\r\n        }\r\n    };\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater,\r\n                             @Nullable ViewGroup container,\r\n                             @Nullable Bundle savedInstanceState) {\r\n        return inflater.inflate(R.layout.fragment_organizer_geolocation, container, false);\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\r\n        super.onViewCreated(view, savedInstanceState);\r\n        SupportMapFragment mapFragment =\r\n                (SupportMapFragment) getChildFragmentManager().findFragmentById(R.id.map);\r\n        if (mapFragment != null) {\r\n            mapFragment.getMapAsync(callback);\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerGeolocationFragment.java b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerGeolocationFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerGeolocationFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerGeolocationFragment.java	(date 1764449277205)
@@ -3,40 +3,29 @@
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.fragment.app.Fragment;
+import androidx.navigation.Navigation;
 
 import android.os.Bundle;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
+import android.widget.ImageButton;
+import android.widget.Toast;
 
 import com.example.magpie_wingman.R;
+import com.example.magpie_wingman.data.DbManager;
 import com.google.android.gms.maps.CameraUpdateFactory;
 import com.google.android.gms.maps.GoogleMap;
 import com.google.android.gms.maps.OnMapReadyCallback;
 import com.google.android.gms.maps.SupportMapFragment;
 import com.google.android.gms.maps.model.LatLng;
 import com.google.android.gms.maps.model.MarkerOptions;
+import com.google.firebase.firestore.DocumentSnapshot;
+import com.google.firebase.firestore.FirebaseFirestore;
 
 public class OrganizerGeolocationFragment extends Fragment {
-
-    private OnMapReadyCallback callback = new OnMapReadyCallback() {
-
-        /**
-         * Manipulates the map once available.
-         * This callback is triggered when the map is ready to be used.
-         * This is where we can add markers or lines, add listeners or move the camera.
-         * In this case, we just add a marker near Sydney, Australia.
-         * If Google Play services is not installed on the device, the user will be prompted to
-         * install it inside the SupportMapFragment. This method will only be triggered once the
-         * user has installed Google Play services and returned to the app.
-         */
-        @Override
-        public void onMapReady(GoogleMap googleMap) {
-            LatLng sydney = new LatLng(-34, 151);
-            googleMap.addMarker(new MarkerOptions().position(sydney).title("Marker in Sydney"));
-            googleMap.moveCamera(CameraUpdateFactory.newLatLng(sydney));
-        }
-    };
+    private GoogleMap map;
+    private String eventId;
 
     @Nullable
     @Override
@@ -45,14 +34,88 @@
                              @Nullable Bundle savedInstanceState) {
         return inflater.inflate(R.layout.fragment_organizer_geolocation, container, false);
     }
+    @Override
+    public void onCreate(@Nullable Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        if (getArguments() != null) {
+            eventId = getArguments().getString("eventId");
+        }
+    }
 
     @Override
     public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
+        ImageButton backBtn = view.findViewById(R.id.button_back);
+        backBtn.setOnClickListener(v -> Navigation.findNavController(view).navigateUp());
         super.onViewCreated(view, savedInstanceState);
         SupportMapFragment mapFragment =
                 (SupportMapFragment) getChildFragmentManager().findFragmentById(R.id.map);
+
         if (mapFragment != null) {
-            mapFragment.getMapAsync(callback);
+            mapFragment.getMapAsync(googleMap -> {
+                map = googleMap;
+                if (eventId != null) {
+                    checkGeolocationEnabled();
+                }
+            });
         }
     }
+
+    private void checkGeolocationEnabled() {
+        FirebaseFirestore db = DbManager.getInstance().getDb();
+
+        db.collection("events").document(eventId).get().addOnSuccessListener(eventSnap -> {
+                    Boolean geoRequired = eventSnap.getBoolean("geolocationRequired");
+
+                    if (geoRequired == null || !geoRequired) {
+                        Toast.makeText(requireContext(),
+                                "Geolocation was not enabled for this event.",
+                                Toast.LENGTH_LONG).show();
+                        return;
+                    }
+                    loadEntrantLocations();
+                });
+    }
+
+    /**
+     * Load all entrant coordinates from Firestore:
+     * events/{eventId}/waitlist/{userId}
+     *  ->latitude
+     *  ->longitude
+     */
+    private void loadEntrantLocations() {
+        FirebaseFirestore db = FirebaseFirestore.getInstance();
+
+        db.collection("events").document(eventId).collection("waitlist").get().addOnSuccessListener(snapshot -> {
+                    boolean hasMarkers = false;
+
+                    for (DocumentSnapshot doc : snapshot) {
+                        Double lat = doc.getDouble("lat");
+                        Double lng = doc.getDouble("lng");
+                        String userId = doc.getId();
+
+                        if (lat != null && lng != null) {
+                            LatLng point = new LatLng(lat, lng);
+                            map.addMarker(new MarkerOptions()
+                                    .position(point)
+                                    .title("Entrant: " + userId));
+
+                            if (!hasMarkers) {
+                                map.moveCamera(CameraUpdateFactory.newLatLngZoom(point, 12f));
+                                hasMarkers = true;
+                            }
+                        }
+                    }
+
+                    if (!hasMarkers) {
+                        Toast.makeText(requireContext(),
+                                "No entrant location data available.",
+                                Toast.LENGTH_SHORT).show();
+                    }
+                })
+                .addOnFailureListener(e ->
+                        Toast.makeText(requireContext(),
+                                "Failed to load entrant locations.",
+                                Toast.LENGTH_SHORT).show()
+                );
+    }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNotifyFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.organizer;\r\n\r\nimport android.os.Bundle;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.CheckBox;\r\nimport android.widget.EditText;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.navigation.NavController;\r\nimport androidx.navigation.fragment.NavHostFragment;\r\n\r\nimport com.example.magpie_wingman.R;\r\nimport com.example.magpie_wingman.data.NotificationFunction;\r\n\r\n/**\r\n * Organizer sends notifications to waitlist / registrable / cancelled entrants.\r\n * Covers US 02.05.01, US 02.07.01, US 02.07.02, US 02.07.03.\r\n */\r\npublic class OrganizerNotifyFragment extends Fragment {\r\n\r\n    private EditText titleInput, messageInput;\r\n    private CheckBox waitlistCheck, registrableCheck, cancelledCheck;\r\n    private Button sendButton;\r\n    private String eventId;\r\n\r\n    private final NotificationFunction notificationFunction = new NotificationFunction();\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater,\r\n                             @Nullable ViewGroup container,\r\n                             @Nullable Bundle savedInstanceState) {\r\n\r\n        View view = inflater.inflate(R.layout.fragment_organizer_notify, container, false);\r\n\r\n        NavController navController = NavHostFragment.findNavController(this);\r\n        View toolbar = view.findViewById(R.id.button_back);\r\n        if (toolbar != null) toolbar.setOnClickListener(v -> navController.navigateUp());\r\n\r\n        titleInput = view.findViewById(R.id.edit_notification_title);\r\n        messageInput = view.findViewById(R.id.edit_notification_message);\r\n        waitlistCheck = view.findViewById(R.id.checkbox_waiting);\r\n        registrableCheck = view.findViewById(R.id.checkbox_selected);\r\n        cancelledCheck = view.findViewById(R.id.checkbox_cancelled);\r\n        sendButton = view.findViewById(R.id.button_send_notification);\r\n\r\n        if (getArguments() != null) {\r\n            eventId = getArguments().getString(\"eventId\");\r\n        }\r\n\r\n        sendButton.setOnClickListener(v -> sendNotifications());\r\n        return view;\r\n    }\r\n\r\n    private void sendNotifications() {\r\n        String title = titleInput.getText().toString().trim();\r\n        String message = messageInput.getText().toString().trim();\r\n\r\n        if (title.isEmpty() || message.isEmpty()) {\r\n            Toast.makeText(getContext(),\r\n                    R.string.error_empty_title_or_message,\r\n                    Toast.LENGTH_SHORT).show();\r\n            return;\r\n        }\r\n\r\n        if (!waitlistCheck.isChecked() && !registrableCheck.isChecked() && !cancelledCheck.isChecked()) {\r\n            Toast.makeText(getContext(),\r\n                    R.string.error_no_group_selected,\r\n                    Toast.LENGTH_SHORT).show();\r\n            return;\r\n        }\r\n\r\n        if (waitlistCheck.isChecked()) {\r\n            notifyGroup(\"waitlist\", title, message);\r\n        }\r\n\r\n        if (registrableCheck.isChecked()) {\r\n            notifyGroup(\"registrable\", title, message);\r\n        }\r\n\r\n        if (cancelledCheck.isChecked()) {\r\n            notifyGroup(\"cancelled\", title, message);\r\n        }\r\n    }\r\n\r\n    private void notifyGroup(String subcollection, String title, String message) {\r\n        String fullMessage = title + \": \" + message;\r\n\r\n        notificationFunction.notifyEntrants(eventId, subcollection, fullMessage)\r\n                .addOnSuccessListener(aVoid -> Toast.makeText(\r\n                        getContext(),\r\n                        getString(R.string.msg_notification_sent, subcollection),\r\n                        Toast.LENGTH_SHORT\r\n                ).show())\r\n                .addOnFailureListener(e -> Toast.makeText(\r\n                        getContext(),\r\n                        getString(R.string.error_notification_failed, subcollection, e.getMessage()),\r\n                        Toast.LENGTH_LONG\r\n                ).show());\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNotifyFragment.java b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNotifyFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNotifyFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/organizer/OrganizerNotifyFragment.java	(date 1764449277206)
@@ -26,7 +26,6 @@
 
     private EditText titleInput, messageInput;
     private CheckBox waitlistCheck, registrableCheck, cancelledCheck;
-    private Button sendButton;
     private String eventId;
 
     private final NotificationFunction notificationFunction = new NotificationFunction();
@@ -48,7 +47,7 @@
         waitlistCheck = view.findViewById(R.id.checkbox_waiting);
         registrableCheck = view.findViewById(R.id.checkbox_selected);
         cancelledCheck = view.findViewById(R.id.checkbox_cancelled);
-        sendButton = view.findViewById(R.id.button_send_notification);
+        Button sendButton = view.findViewById(R.id.button_send_notification);
 
         if (getArguments() != null) {
             eventId = getArguments().getString("eventId");
Index: app/src/main/java/com/example/magpie_wingman/data/model/Notification.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.data.model;\r\n\r\nimport com.google.firebase.Timestamp;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\n\r\npublic class Notification {\r\n    private final String message;\r\n    private final long timestamp;\r\n    private final String eventId;\r\n    private final boolean read;\r\n\r\n    public Notification(String message, long timestamp, String eventId, boolean read) {\r\n        this.message = message;\r\n        this.timestamp = timestamp;\r\n        this.eventId = eventId;\r\n        this.read = read;\r\n    }\r\n\r\n    public String getMessageRaw() { return message; }\r\n    public long getTimestamp() { return timestamp; }\r\n    public String getEventId() { return eventId; }\r\n    public boolean isRead() { return read; }\r\n\r\n    // Split whole message at first colon to get title + notification message\r\n    public String getTitle() {\r\n        if (message == null) return \"Notification\";\r\n        int i = message.indexOf(':');\r\n        return (i > 0) ? message.substring(0, i).trim() : \"Notification\";\r\n    }\r\n\r\n    public String getBody() {\r\n        if (message == null) return \"\";\r\n        int i = message.indexOf(':');\r\n        return (i >= 0) ? message.substring(i + 1).trim() : message;\r\n    }\r\n\r\n    public static Notification from(DocumentSnapshot d) {\r\n        String msg = d.getString(\"message\");\r\n        if (msg == null) msg = \"\";\r\n\r\n        String eventId = d.getString(\"eventId\");\r\n\r\n        Boolean readObj = d.getBoolean(\"read\");\r\n        boolean read = readObj != null && readObj;\r\n\r\n        long ts = 0L;\r\n        Object raw = d.get(\"timestamp\");\r\n        if (raw instanceof Timestamp) {\r\n            ts = ((Timestamp) raw).toDate().getTime();\r\n        } else if (raw instanceof Long) {\r\n            ts = (Long) raw;\r\n        }\r\n\r\n        return new Notification(msg, ts, eventId, read);\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/data/model/Notification.java b/app/src/main/java/com/example/magpie_wingman/data/model/Notification.java
--- a/app/src/main/java/com/example/magpie_wingman/data/model/Notification.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/data/model/Notification.java	(date 1764449277200)
@@ -53,4 +53,4 @@
 
         return new Notification(msg, ts, eventId, read);
     }
-}
+}
\ No newline at end of file
Index: app/src/main/res/layout/fragment_organizer_geolocation.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><LinearLayout\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:orientation=\"vertical\"\r\n    android:background=\"#0B0B18\"\r\n    tools:context=\".organizer.OrganizerGeolocationFragment\">\r\n\r\n    <!-- HEADER BAR -->\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"56dp\"\r\n        android:orientation=\"horizontal\"\r\n        android:gravity=\"center_vertical\"\r\n        android:background=\"@android:color/white\"\r\n        android:paddingHorizontal=\"12dp\">\r\n\r\n        <ImageButton\r\n            android:id=\"@+id/button_back\"\r\n            android:layout_width=\"28dp\"\r\n            android:layout_height=\"28dp\"\r\n            android:background=\"@android:color/transparent\"\r\n            android:src=\"@drawable/ic_arrow_back\"\r\n            android:contentDescription=\"Back\"\r\n            app:tint=\"#000000\" />\r\n\r\n        <ImageView\r\n            android:id=\"@+id/image_logo\"\r\n            android:layout_width=\"28dp\"\r\n            android:layout_height=\"28dp\"\r\n            android:layout_marginStart=\"8dp\"\r\n            android:src=\"@drawable/wingman_logo\"\r\n            android:contentDescription=\"Logo\" />\r\n\r\n        <TextView\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginStart=\"8dp\"\r\n            android:text=\"Geolocation\"\r\n            android:textColor=\"#000000\"\r\n            android:textStyle=\"bold\"\r\n            android:textSize=\"18sp\" />\r\n    </LinearLayout>\r\n\r\n    <!-- ENTRANT DROPDOWN -->\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"horizontal\"\r\n        android:padding=\"12dp\"\r\n        android:gravity=\"center_vertical\">\r\n\r\n        <TextView\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"Location of:\"\r\n            android:textColor=\"#FFFFFF\"\r\n            android:textSize=\"14sp\"\r\n            android:layout_marginEnd=\"8dp\" />\r\n\r\n        <Spinner\r\n            android:id=\"@+id/spinner_person\"\r\n            android:layout_width=\"wrap_content\"\r\n            android:layout_height=\"40dp\"\r\n            android:background=\"@drawable/rounded_white\"\r\n            android:paddingHorizontal=\"8dp\"\r\n            android:spinnerMode=\"dropdown\"\r\n            android:entries=\"@array/sample_persons\" />\r\n    </LinearLayout>\r\n\r\n    <!-- MAP VIEW -->\r\n    <fragment\r\n        android:id=\"@+id/map\"\r\n        android:name=\"com.google.android.gms.maps.SupportMapFragment\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"0dp\"\r\n        android:layout_weight=\"1\"\r\n        android:layout_marginTop=\"8dp\" />\r\n</LinearLayout>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/fragment_organizer_geolocation.xml b/app/src/main/res/layout/fragment_organizer_geolocation.xml
--- a/app/src/main/res/layout/fragment_organizer_geolocation.xml	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/res/layout/fragment_organizer_geolocation.xml	(date 1764449277208)
@@ -66,8 +66,7 @@
             android:layout_height="40dp"
             android:background="@drawable/rounded_white"
             android:paddingHorizontal="8dp"
-            android:spinnerMode="dropdown"
-            android:entries="@array/sample_persons" />
+            android:spinnerMode="dropdown" />
     </LinearLayout>
 
     <!-- MAP VIEW -->
Index: app/src/main/java/com/example/magpie_wingman/entrant/EntrantEventsFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.entrant;\r\n\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ImageButton;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.navigation.NavController;\r\nimport androidx.navigation.Navigation;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport com.example.magpie_wingman.R;\r\nimport com.example.magpie_wingman.data.DbManager;\r\nimport com.example.magpie_wingman.data.model.Event;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class EntrantEventsFragment extends Fragment {\r\n\r\n    private static final String ARG_ENTRANT_ID = \"entrantId\";\r\n    private String entrantId;\r\n    private RecyclerView recyclerView;\r\n    private EventAdapter adapter;\r\n    private List<Event> eventList;\r\n\r\n    public EntrantEventsFragment() { }\r\n\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        if (getArguments() != null) {\r\n            entrantId = getArguments().getString(ARG_ENTRANT_ID);\r\n        }\r\n        if (entrantId == null) {\r\n            entrantId = \"test_user_id\";\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\r\n        return inflater.inflate(R.layout.fragment_entrant_events, container, false);\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\r\n        super.onViewCreated(view, savedInstanceState);\r\n\r\n        ImageButton backBtn = view.findViewById(R.id.button_back);\r\n        backBtn.setOnClickListener(v -> Navigation.findNavController(view).navigateUp());\r\n\r\n        recyclerView = view.findViewById(R.id.recycler_view_events);\r\n        recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));\r\n\r\n        eventList = new ArrayList<>();\r\n\r\n        adapter = new EventAdapter(eventList, entrantId, event -> {\r\n            Bundle bundle = new Bundle();\r\n            bundle.putString(\"eventId\", event.getEventId());\r\n            bundle.putString(\"entrantId\", entrantId);\r\n\r\n            NavController navController = Navigation.findNavController(view);\r\n            navController.navigate(R.id.action_entrantEventsFragment_to_detailedEventDescriptionFragment, bundle);\r\n        });\r\n\r\n        recyclerView.setAdapter(adapter);\r\n        fetchEvents();\r\n    }\r\n\r\n    private void fetchEvents() {\r\n        DbManager.getInstance().getDb().collection(\"events\")\r\n                .get()\r\n                .addOnSuccessListener(queryDocumentSnapshots -> {\r\n                    eventList.clear();\r\n                    for (DocumentSnapshot doc : queryDocumentSnapshots) {\r\n                        Event event = doc.toObject(Event.class);\r\n                        if (event != null) {\r\n                            eventList.add(event);\r\n                        }\r\n                    }\r\n                    adapter.notifyDataSetChanged();\r\n                })\r\n                .addOnFailureListener(e -> Log.e(\"EntrantEvents\", \"Error fetching events\", e));\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/entrant/EntrantEventsFragment.java b/app/src/main/java/com/example/magpie_wingman/entrant/EntrantEventsFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/entrant/EntrantEventsFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/entrant/EntrantEventsFragment.java	(date 1764449277202)
@@ -6,6 +6,7 @@
 import android.view.View;
 import android.view.ViewGroup;
 import android.widget.ImageButton;
+import android.widget.Toast;
 
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
@@ -15,17 +16,20 @@
 import androidx.recyclerview.widget.LinearLayoutManager;
 import androidx.recyclerview.widget.RecyclerView;
 
+import com.example.magpie_wingman.MyApp;
 import com.example.magpie_wingman.R;
 import com.example.magpie_wingman.data.DbManager;
 import com.example.magpie_wingman.data.model.Event;
+import com.example.magpie_wingman.data.model.User;
+import com.google.firebase.firestore.DocumentReference;
 import com.google.firebase.firestore.DocumentSnapshot;
 
 import java.util.ArrayList;
 import java.util.List;
+import java.util.concurrent.atomic.AtomicInteger;
 
 public class EntrantEventsFragment extends Fragment {
 
-    private static final String ARG_ENTRANT_ID = "entrantId";
     private String entrantId;
     private RecyclerView recyclerView;
     private EventAdapter adapter;
@@ -36,12 +40,8 @@
     @Override
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        if (getArguments() != null) {
-            entrantId = getArguments().getString(ARG_ENTRANT_ID);
-        }
-        if (entrantId == null) {
-            entrantId = "test_user_id";
-        }
+        User currentUser = MyApp.getInstance().getCurrentUser();
+        entrantId = currentUser.getUserId();
     }
 
     @Override
@@ -74,19 +74,143 @@
         fetchEvents();
     }
 
+    /**
+     * Loads the current entrant's registration history.
+     * For each event document, it checks the "waitlist",
+     * "registrable", and "registered" subcollections for this entrant.
+     * Only matching events are shown in the list.
+     */
     private void fetchEvents() {
-        DbManager.getInstance().getDb().collection("events")
+        if (entrantId == null) {
+            showShortToast("No entrant set; cannot load events.");
+            return;
+        }
+
+        DbManager.getInstance()
+                .getDb()
+                .collection("events")
                 .get()
                 .addOnSuccessListener(queryDocumentSnapshots -> {
                     eventList.clear();
+
+                    int totalEvents = queryDocumentSnapshots.size();
+                    if (totalEvents == 0) {
+                        adapter.notifyDataSetChanged();
+                        return;
+                    }
+
+                    AtomicInteger processedCount = new AtomicInteger(0);
+
                     for (DocumentSnapshot doc : queryDocumentSnapshots) {
                         Event event = doc.toObject(Event.class);
-                        if (event != null) {
-                            eventList.add(event);
-                        }
+
+                        if (event == null) {
+                            // Still count this event as processed
+                            if (processedCount.incrementAndGet() == totalEvents) {
+                                adapter.notifyDataSetChanged();
+                            }
+                            continue;
+                        }
+
+                        // Ensure the eventId field is populated from the document ID
+                        event.setEventId(doc.getId());
+
+                        DocumentReference eventRef = doc.getReference();
+                        checkEventMembership(eventRef, event, processedCount, totalEvents);
+                    }
+                })
+                .addOnFailureListener(e -> {
+                    e.printStackTrace(); // goes to Logcat
+                    showShortToast("Error fetching events.");
+                });
+    }
+
+    /**
+     * Checks whether the current entrant appears in any of the event's
+     * membership subcollections: "waitlist", "registrable", or "registered".
+     *
+     * If the entrant is found, the event is added to the list.
+     * In all cases, we mark this event as processed and eventually
+     * notify the adapter when all checks are done.
+     */
+    private void checkEventMembership(DocumentReference eventRef,
+                                      Event event,
+                                      AtomicInteger processedCount,
+                                      int totalEvents) {
+
+        final String userId = entrantId;
+        if (userId == null) {
+            onEventCheckComplete(processedCount, totalEvents);
+            return;
+        }
+
+        // 1) Check waitlist
+        eventRef.collection("waitlist")
+                .whereEqualTo("userId", userId)
+                .get()
+                .addOnSuccessListener(waitlistSnap -> {
+                    if (!waitlistSnap.isEmpty()) {
+                        eventList.add(event);
+                        onEventCheckComplete(processedCount, totalEvents);
+                    } else {
+                        // 2) Check registrable
+                        eventRef.collection("registrable")
+                                .whereEqualTo("userId", userId)
+                                .get()
+                                .addOnSuccessListener(registrableSnap -> {
+                                    if (!registrableSnap.isEmpty()) {
+                                        eventList.add(event);
+                                        onEventCheckComplete(processedCount, totalEvents);
+                                    } else {
+                                        // 3) Check registered
+                                        eventRef.collection("registered")
+                                                .whereEqualTo("userId", userId)
+                                                .get()
+                                                .addOnSuccessListener(registeredSnap -> {
+                                                    if (!registeredSnap.isEmpty()) {
+                                                        eventList.add(event);
+                                                    }
+                                                    onEventCheckComplete(processedCount, totalEvents);
+                                                })
+                                                .addOnFailureListener(e -> {
+                                                    e.printStackTrace();
+                                                    showShortToast("Error checking registered status.");
+                                                    onEventCheckComplete(processedCount, totalEvents);
+                                                });
+                                    }
+                                })
+                                .addOnFailureListener(e -> {
+                                    e.printStackTrace();
+                                    showShortToast("Error checking registrable status.");
+                                    onEventCheckComplete(processedCount, totalEvents);
+                                });
                     }
-                    adapter.notifyDataSetChanged();
-                })
-                .addOnFailureListener(e -> Log.e("EntrantEvents", "Error fetching events", e));
+                })
+                .addOnFailureListener(e -> {
+                    e.printStackTrace();
+                    showShortToast("Error checking waitlist status.");
+                    onEventCheckComplete(processedCount, totalEvents);
+                });
+    }
+
+    /**
+     * Helper that increments the processed event counter and
+     * notifies the adapter once all events have been checked.
+     */
+    private void onEventCheckComplete(AtomicInteger processedCount, int totalEvents) {
+        if (processedCount.incrementAndGet() == totalEvents) {
+            adapter.notifyDataSetChanged();
+        }
+    }
+
+    /**
+     * Shows a short toast if the fragment is attached to a context.
+     *
+     * @param message The message to display.
+     */
+    private void showShortToast(String message) {
+        if (getContext() != null) {
+            Toast.makeText(getContext(), message, Toast.LENGTH_SHORT).show();
+        }
     }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/magpie_wingman/entrant/EntrantSettingsFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.magpie_wingman.entrant;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.content.Context;\r\nimport android.os.Bundle;\r\nimport android.text.TextUtils;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.Switch;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.navigation.NavController;\r\nimport androidx.navigation.Navigation;\r\n\r\nimport com.example.magpie_wingman.MyApp;\r\nimport com.example.magpie_wingman.R;\r\nimport com.example.magpie_wingman.data.DbManager;\r\nimport com.example.magpie_wingman.data.model.User;\r\n\r\n/**\r\n * Settings screen for entrant users backed by a custom layout\r\n * {@code fragment_entrant_settings.xml}.\r\n *\r\n * Responsibilities:\r\n *  - Load/display the user's display name.\r\n *  - Toggle/persist notification preferences.\r\n *  - Log out (clear local session and finish Activity).\r\n *  - Delete account (calls preexisting DbManager#deleteEntrant(String)).\r\n */\r\npublic class EntrantSettingsFragment extends Fragment {\r\n\r\n    public static final String ARG_ENTRANT_ID = \"arg_entrant_id\";\r\n\r\n    private String entrantId;\r\n\r\n    // UI\r\n    private TextView nameText;\r\n    private Switch adminNotificationsSwitch;\r\n    private Switch organizerNotificationsSwitch;\r\n    private Button logoutButton;\r\n    private Button deleteButton;\r\n\r\n    // Pref keys\r\n    private static final String PREFS = \"app_prefs\";\r\n    private static final String KEY_USER_ID = \"user_id\";\r\n    private static final String KEY_NOTIFY_ADMINS = \"notify_admins\";\r\n    private static final String KEY_NOTIFY_ORGANIZERS = \"notify_organizers\";\r\n\r\n    public static EntrantSettingsFragment newInstance(@NonNull String entrantId) {\r\n        Bundle b = new Bundle();\r\n        b.putString(ARG_ENTRANT_ID, entrantId);\r\n        EntrantSettingsFragment f = new EntrantSettingsFragment();\r\n        f.setArguments(b);\r\n        return f;\r\n    }\r\n\r\n    @Override\r\n    public void onCreate(@Nullable Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n\r\n        if (getArguments() != null) {\r\n            entrantId = getArguments().getString(ARG_ENTRANT_ID);\r\n        }\r\n\r\n        if (TextUtils.isEmpty(entrantId)) {\r\n            entrantId = loadUserIdFromPrefs();\r\n        }\r\n    }\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(\r\n            @NonNull LayoutInflater inflater,\r\n            @Nullable ViewGroup container,\r\n            @Nullable Bundle savedInstanceState\r\n    ) {\r\n        View root = inflater.inflate(R.layout.fragment_entrant_settings, container, false);\r\n\r\n        // --- Bind views ---\r\n        ImageButton back = root.findViewById(R.id.button_back);\r\n        nameText = root.findViewById(R.id.text_user_name);\r\n        adminNotificationsSwitch = root.findViewById(R.id.switch_admin_notifications);\r\n        organizerNotificationsSwitch = root.findViewById(R.id.switch_organizer_notifications);\r\n        View rowEditProfile = root.findViewById(R.id.row_edit_profile);\r\n        View rowAboutUs = root.findViewById(R.id.row_about_us);\r\n        logoutButton = root.findViewById(R.id.button_logout);\r\n        deleteButton = root.findViewById(R.id.button_delete_account);\r\n\r\n        back.setOnClickListener(v ->\r\n                requireActivity().getOnBackPressedDispatcher().onBackPressed());\r\n\r\n        bindUserName();\r\n        initNotificationSwitches();\r\n\r\n        deleteButton.setOnClickListener(v -> confirmAndDeleteProfile());\r\n\r\n        boolean hasId = !TextUtils.isEmpty(entrantId);\r\n        deleteButton.setEnabled(hasId);\r\n        logoutButton.setEnabled(true);\r\n\r\n        return root;\r\n    }\r\n\r\n    @Override\r\n    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {\r\n        super.onViewCreated(view, savedInstanceState);\r\n\r\n        ImageView btnEditProfile = view.findViewById(R.id.btn_edit_profile);\r\n        ImageView btnAboutUs = view.findViewById(R.id.btn_about_us);\r\n        Button btnLogOut = view.findViewById(R.id.button_logout);\r\n\r\n        // NEW: mode-switch buttons\r\n        Button btnEntrantMode = view.findViewById(R.id.button_entrant_mode);\r\n        Button btnOrganizerMode = view.findViewById(R.id.button_organizer_mode);\r\n\r\n        NavController navController = Navigation.findNavController(view);\r\n\r\n        btnEditProfile.setOnClickListener(\r\n                v -> navController.navigate(R.id.action_entrantSettingsFragment_to_entrantEditProfileFragment)\r\n        );\r\n        btnAboutUs.setOnClickListener(\r\n                v -> navController.navigate(R.id.action_entrantSettingsFragment_to_entrantAboutUsFragment)\r\n        );\r\n        btnLogOut.setOnClickListener(\r\n                v -> navController.navigate(R.id.action_entrantSettingsFragment_to_loginFragment)\r\n        );\r\n\r\n        // --- Mode switch logic based on current user ---\r\n        User currentUser = MyApp.getInstance().getCurrentUser();\r\n\r\n        if (currentUser == null || !currentUser.isOrganizer()) {\r\n            // Not an organizer -> no mode switching\r\n            btnEntrantMode.setVisibility(View.GONE);\r\n            btnOrganizerMode.setVisibility(View.GONE);\r\n        } else {\r\n            // Entrant settings = already in entrant mode\r\n            btnEntrantMode.setEnabled(false);\r\n            btnOrganizerMode.setEnabled(true);\r\n\r\n            btnOrganizerMode.setOnClickListener(v ->\r\n                    navController.navigate(R.id.organizerLandingFragment2));\r\n        }\r\n    }\r\n\r\n    // =============================================================================================\r\n    // Data / actions\r\n    // =============================================================================================\r\n\r\n    private void bindUserName() {\r\n        if (TextUtils.isEmpty(entrantId)) {\r\n            nameText.setText(\"Guest\");\r\n            return;\r\n        }\r\n        try {\r\n            DbManager.getInstance()\r\n                    .getUserName(entrantId)\r\n                    .addOnSuccessListener(name -> {\r\n                        if (name == null || name.trim().isEmpty()) {\r\n                            nameText.setText(entrantId);\r\n                        } else {\r\n                            nameText.setText(name);\r\n                        }\r\n                    })\r\n                    .addOnFailureListener(e -> nameText.setText(entrantId));\r\n        } catch (Throwable t) {\r\n            nameText.setText(entrantId);\r\n        }\r\n    }\r\n\r\n    private void initNotificationSwitches() {\r\n        boolean adminsOn = getPrefs().getBoolean(KEY_NOTIFY_ADMINS, false);\r\n        boolean organizersOn = getPrefs().getBoolean(KEY_NOTIFY_ORGANIZERS, true);\r\n\r\n        adminNotificationsSwitch.setChecked(adminsOn);\r\n        organizerNotificationsSwitch.setChecked(organizersOn);\r\n\r\n        adminNotificationsSwitch.setOnCheckedChangeListener((buttonView, isChecked) ->\r\n                getPrefs().edit().putBoolean(KEY_NOTIFY_ADMINS, isChecked).apply());\r\n\r\n        organizerNotificationsSwitch.setOnCheckedChangeListener((buttonView, isChecked) ->\r\n                getPrefs().edit().putBoolean(KEY_NOTIFY_ORGANIZERS, isChecked).apply());\r\n    }\r\n\r\n    private void confirmAndDeleteProfile() {\r\n        new AlertDialog.Builder(requireContext())\r\n                .setTitle(\"Delete your profile?\")\r\n                .setMessage(\"This will remove you from all waitlists/registrations and delete your account. This cannot be undone.\")\r\n                .setNegativeButton(android.R.string.cancel, null)\r\n                .setPositiveButton(\"Delete\", (d, w) -> performDelete())\r\n                .show();\r\n    }\r\n\r\n    private void performDelete() {\r\n        if (TextUtils.isEmpty(entrantId)) {\r\n            Toast.makeText(requireContext(), \"Could not resolve your user ID.\", Toast.LENGTH_LONG).show();\r\n            return;\r\n        }\r\n\r\n        DbManager.getInstance()\r\n                .deleteEntrant(entrantId)\r\n                .addOnSuccessListener(v -> {\r\n                    clearUserIdFromPrefs();\r\n                    Toast.makeText(requireContext(), \"Profile deleted\", Toast.LENGTH_SHORT).show();\r\n                    requireActivity().finish();\r\n                })\r\n                .addOnFailureListener(e ->\r\n                        Toast.makeText(requireContext(),\r\n                                \"Delete failed: \" + e.getMessage(), Toast.LENGTH_LONG).show());\r\n    }\r\n\r\n    // =============================================================================================\r\n    // Local storage helpers\r\n    // =============================================================================================\r\n\r\n    @Nullable\r\n    private String loadUserIdFromPrefs() {\r\n        try {\r\n            return getPrefs().getString(KEY_USER_ID, null);\r\n        } catch (Throwable t) {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    private void clearUserIdFromPrefs() {\r\n        try {\r\n            getPrefs().edit().remove(KEY_USER_ID).apply();\r\n        } catch (Throwable ignored) {}\r\n    }\r\n\r\n    private android.content.SharedPreferences getPrefs() {\r\n        return requireContext().getSharedPreferences(PREFS, Context.MODE_PRIVATE);\r\n    }\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/magpie_wingman/entrant/EntrantSettingsFragment.java b/app/src/main/java/com/example/magpie_wingman/entrant/EntrantSettingsFragment.java
--- a/app/src/main/java/com/example/magpie_wingman/entrant/EntrantSettingsFragment.java	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/java/com/example/magpie_wingman/entrant/EntrantSettingsFragment.java	(date 1764449277203)
@@ -73,6 +73,9 @@
         if (TextUtils.isEmpty(entrantId)) {
             entrantId = loadUserIdFromPrefs();
         }
+
+        User currentUser = MyApp.getInstance().getCurrentUser();
+        entrantId = currentUser.getUserId();
     }
 
     @Nullable
@@ -176,18 +179,101 @@
     }
 
     private void initNotificationSwitches() {
-        boolean adminsOn = getPrefs().getBoolean(KEY_NOTIFY_ADMINS, false);
-        boolean organizersOn = getPrefs().getBoolean(KEY_NOTIFY_ORGANIZERS, true);
+        if (TextUtils.isEmpty(entrantId)) {
+            adminNotificationsSwitch.setEnabled(false);
+            organizerNotificationsSwitch.setEnabled(false);
+            return;
+        }
+
+        adminNotificationsSwitch.setEnabled(false);
+        organizerNotificationsSwitch.setEnabled(false);
+
+        DbManager dbManager = DbManager.getInstance();
+
+        dbManager.getDb()
+                .collection("users")
+                .document(entrantId)
+                .get()
+                .addOnSuccessListener(doc -> {
+                    // Read values from Firestore
+                    Boolean notifAdmin = doc.getBoolean("notifAdmin");
+                    Boolean notifOrg   = doc.getBoolean("notifOrganizer");
+
+                    // If fields don't exist yet, use local defaults/prefs
+                    boolean adminsOn = (notifAdmin != null)
+                            ? notifAdmin
+                            : getPrefs().getBoolean(KEY_NOTIFY_ADMINS, false);
+
+                    boolean organizersOn = (notifOrg != null)
+                            ? notifOrg
+                            : getPrefs().getBoolean(KEY_NOTIFY_ORGANIZERS, true);
+
+                    // Set initial state
+                    adminNotificationsSwitch.setChecked(adminsOn);
+                    organizerNotificationsSwitch.setChecked(organizersOn);
+
+                    // Keep prefs in sync
+                    getPrefs().edit()
+                            .putBoolean(KEY_NOTIFY_ADMINS, adminsOn)
+                            .putBoolean(KEY_NOTIFY_ORGANIZERS, organizersOn)
+                            .apply();
+
+                    // Now attach listeners that write back to Firestore
+                    attachNotificationListeners();
+
+                    adminNotificationsSwitch.setEnabled(true);
+                    organizerNotificationsSwitch.setEnabled(true);
+                })
+                .addOnFailureListener(e -> {
+                    // If Firestore read fails, fall back to prefs
+                    boolean adminsOn = getPrefs().getBoolean(KEY_NOTIFY_ADMINS, false);
+                    boolean organizersOn = getPrefs().getBoolean(KEY_NOTIFY_ORGANIZERS, true);
 
-        adminNotificationsSwitch.setChecked(adminsOn);
-        organizerNotificationsSwitch.setChecked(organizersOn);
+                    adminNotificationsSwitch.setChecked(adminsOn);
+                    organizerNotificationsSwitch.setChecked(organizersOn);
 
-        adminNotificationsSwitch.setOnCheckedChangeListener((buttonView, isChecked) ->
-                getPrefs().edit().putBoolean(KEY_NOTIFY_ADMINS, isChecked).apply());
+                    attachNotificationListeners();
+
+                    adminNotificationsSwitch.setEnabled(true);
+                    organizerNotificationsSwitch.setEnabled(true);
 
-        organizerNotificationsSwitch.setOnCheckedChangeListener((buttonView, isChecked) ->
-                getPrefs().edit().putBoolean(KEY_NOTIFY_ORGANIZERS, isChecked).apply());
+                    Toast.makeText(requireContext(),
+                            "Failed to load notification settings; using last saved values.",
+                            Toast.LENGTH_SHORT).show();
+                });
     }
+
+    private void attachNotificationListeners() {
+        adminNotificationsSwitch.setOnCheckedChangeListener((buttonView, isChecked) -> {
+            DbManager.getInstance()
+                    .updateNotificationPrefs(entrantId, isChecked, null)
+                    .addOnSuccessListener(v -> {
+                        getPrefs().edit().putBoolean(KEY_NOTIFY_ADMINS, isChecked).apply();
+                    })
+                    .addOnFailureListener(e -> {
+                        Toast.makeText(requireContext(),
+                                "Failed to update admin notifications: " + e.getMessage(),
+                                Toast.LENGTH_SHORT).show();
+                        // revert switch
+                        adminNotificationsSwitch.setChecked(!isChecked);
+                    });
+        });
+
+        organizerNotificationsSwitch.setOnCheckedChangeListener((buttonView, isChecked) -> {
+            DbManager.getInstance()
+                    .updateNotificationPrefs(entrantId, null, isChecked)
+                    .addOnSuccessListener(v -> {
+                        getPrefs().edit().putBoolean(KEY_NOTIFY_ORGANIZERS, isChecked).apply();
+                    })
+                    .addOnFailureListener(e -> {
+                        Toast.makeText(requireContext(),
+                                "Failed to update organizer notifications: " + e.getMessage(),
+                                Toast.LENGTH_SHORT).show();
+                        organizerNotificationsSwitch.setChecked(!isChecked);
+                    });
+        });
+    }
+
 
     private void confirmAndDeleteProfile() {
         new AlertDialog.Builder(requireContext())
Index: app/src/main/res/layout/fragment_organizer_edit_event.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><ScrollView\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"#0B0B18\"\r\n    tools:context=\".organizer.OrganizerEditEventFragment\">\r\n\r\n    <LinearLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:orientation=\"vertical\">\r\n\r\n        <!-- HEADER BAR -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"56dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:gravity=\"center_vertical\"\r\n            android:background=\"@android:color/white\"\r\n            android:paddingHorizontal=\"12dp\">\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/button_back\"\r\n                android:layout_width=\"28dp\"\r\n                android:layout_height=\"28dp\"\r\n                android:background=\"@android:color/transparent\"\r\n                android:src=\"@drawable/ic_arrow_back\"\r\n                android:contentDescription=\"Back\"\r\n                app:tint=\"#000000\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/image_logo\"\r\n                android:layout_width=\"28dp\"\r\n                android:layout_height=\"28dp\"\r\n                android:src=\"@drawable/wingman_logo\"\r\n                android:contentDescription=\"Logo\"\r\n                android:layout_marginStart=\"8dp\" />\r\n\r\n            <TextView\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:text=\"Edit Event\"\r\n                android:textColor=\"#000000\"\r\n                android:textStyle=\"bold\"\r\n                android:textSize=\"18sp\"\r\n                android:layout_marginStart=\"8dp\" />\r\n\r\n            <!-- Spacer pushes info button to the right -->\r\n            <View\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\" />\r\n\r\n            <ImageButton\r\n                android:id=\"@+id/button_info\"\r\n                android:layout_width=\"28dp\"\r\n                android:layout_height=\"28dp\"\r\n                android:background=\"@android:color/transparent\"\r\n                android:contentDescription=\"Info\"\r\n                android:src=\"@drawable/ic_info\"\r\n                android:gravity=\"end\"\r\n                app:tint=\"#000000\" />\r\n        </LinearLayout>\r\n\r\n        <!-- EVENT TITLE -->\r\n        <EditText\r\n            android:id=\"@+id/edit_event_title\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:hint=\"Title\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:background=\"@drawable/edittext_white\"\r\n            android:padding=\"12dp\"\r\n            android:textColor=\"#000000\"\r\n            android:textColorHint=\"#888888\" />\r\n\r\n        <!-- LIMIT AND OPTIONS -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:weightSum=\"3\">\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_limit\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"8dp\"\r\n                android:hint=\"Limit\"\r\n                android:inputType=\"number\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <CheckBox\r\n                android:id=\"@+id/checkbox_geo\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"GEO\"\r\n                android:textColor=\"#FFFFFF\"\r\n                android:buttonTint=\"#2E5BFF\"\r\n                android:gravity=\"center\" />\r\n\r\n            <CheckBox\r\n                android:id=\"@+id/checkbox_qr\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"QR\"\r\n                android:textColor=\"#FFFFFF\"\r\n                android:buttonTint=\"#2E5BFF\"\r\n                android:gravity=\"center\" />\r\n        </LinearLayout>\r\n\r\n        <!-- POSTER UPLOAD -->\r\n        <Button\r\n            android:id=\"@+id/button_upload_poster\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"150dp\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:text=\"+ Upload Poster\"\r\n            android:textColor=\"#000000\"\r\n            android:background=\"@drawable/edittext_white\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <!-- LOCATION INPUTS -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:orientation=\"horizontal\"\r\n            android:weightSum=\"3\">\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_address\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:hint=\"Address\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_city\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:hint=\"City\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_province\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:hint=\"Province\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n        </LinearLayout>\r\n\r\n        <!-- DESCRIPTION -->\r\n        <EditText\r\n            android:id=\"@+id/edit_description\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"100dp\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:hint=\"Description\"\r\n            android:gravity=\"top\"\r\n            android:background=\"@drawable/edittext_white\"\r\n            android:padding=\"12dp\"\r\n            android:textColor=\"#000000\" />\r\n\r\n        <!-- DATE & TIME -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"horizontal\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:weightSum=\"2\">\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_date\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:hint=\"Event Date\"\r\n                android:drawableStart=\"@drawable/ic_calendar\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_time\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:hint=\"Event Time\"\r\n                android:drawableStart=\"@drawable/ic_clock\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n        </LinearLayout>\r\n\r\n        <!-- REGISTRATION DATES -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:weightSum=\"2\">\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_registration_start\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"4dp\"\r\n                android:hint=\"Registration Start\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n\r\n            <EditText\r\n                android:id=\"@+id/edit_registration_end\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_weight=\"1\"\r\n                android:hint=\"Registration End\"\r\n                android:background=\"@drawable/edittext_white\"\r\n                android:padding=\"12dp\"\r\n                android:textColor=\"#000000\" />\r\n        </LinearLayout>\r\n\r\n        <!-- FILTER ICONS -->\r\n        <TextView\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:layout_marginTop=\"16dp\"\r\n            android:text=\"Select Filters\"\r\n            android:textColor=\"#FFFFFF\"\r\n            android:textSize=\"16sp\"\r\n            android:textStyle=\"bold\" />\r\n\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:gravity=\"center\"\r\n            android:layout_marginTop=\"8dp\"\r\n            android:orientation=\"horizontal\">\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_sports\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Sports\" />\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_music\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Music\" />\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_art\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Art\" />\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_food\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Food\" />\r\n\r\n            <ImageView\r\n                android:layout_width=\"40dp\"\r\n                android:layout_height=\"40dp\"\r\n                android:layout_margin=\"8dp\"\r\n                android:src=\"@drawable/ic_more\"\r\n                android:background=\"@drawable/circle_white\"\r\n                android:contentDescription=\"Other\" />\r\n        </LinearLayout>\r\n\r\n        <!-- BUTTONS -->\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"horizontal\"\r\n            android:gravity=\"center\"\r\n            android:layout_marginTop=\"16dp\">\r\n\r\n            <Button\r\n                android:id=\"@+id/button_reset\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"48dp\"\r\n                android:layout_weight=\"1\"\r\n                android:layout_marginEnd=\"8dp\"\r\n                android:text=\"RESET\"\r\n                android:textStyle=\"bold\"\r\n                android:textColor=\"#000000\"\r\n                android:background=\"@drawable/white_button_bg\" />\r\n\r\n            <Button\r\n                android:id=\"@+id/button_create\"\r\n                android:layout_width=\"0dp\"\r\n                android:layout_height=\"48dp\"\r\n                android:layout_weight=\"1\"\r\n                android:text=\"CREATE\"\r\n                android:textStyle=\"bold\"\r\n                android:textColor=\"@android:color/white\"\r\n                android:background=\"@drawable/blue_button_bg\"\r\n                android:backgroundTint=\"@null\" />\r\n        </LinearLayout>\r\n    </LinearLayout>\r\n</ScrollView>\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/fragment_organizer_edit_event.xml b/app/src/main/res/layout/fragment_organizer_edit_event.xml
--- a/app/src/main/res/layout/fragment_organizer_edit_event.xml	(revision 7b2ca1a0f652b887ad1780f9c955fd078949e1e2)
+++ b/app/src/main/res/layout/fragment_organizer_edit_event.xml	(date 1764449277206)
@@ -12,7 +12,6 @@
         android:layout_height="wrap_content"
         android:orientation="vertical">
 
-        <!-- HEADER BAR -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="56dp"
@@ -30,14 +29,6 @@
                 android:contentDescription="Back"
                 app:tint="#000000" />
 
-            <ImageView
-                android:id="@+id/image_logo"
-                android:layout_width="28dp"
-                android:layout_height="28dp"
-                android:src="@drawable/wingman_logo"
-                android:contentDescription="Logo"
-                android:layout_marginStart="8dp" />
-
             <TextView
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content"
@@ -46,25 +37,8 @@
                 android:textStyle="bold"
                 android:textSize="18sp"
                 android:layout_marginStart="8dp" />
-
-            <!-- Spacer pushes info button to the right -->
-            <View
-                android:layout_width="0dp"
-                android:layout_height="wrap_content"
-                android:layout_weight="1" />
-
-            <ImageButton
-                android:id="@+id/button_info"
-                android:layout_width="28dp"
-                android:layout_height="28dp"
-                android:background="@android:color/transparent"
-                android:contentDescription="Info"
-                android:src="@drawable/ic_info"
-                android:gravity="end"
-                app:tint="#000000" />
         </LinearLayout>
 
-        <!-- EVENT TITLE -->
         <EditText
             android:id="@+id/edit_event_title"
             android:layout_width="match_parent"
@@ -73,103 +47,55 @@
             android:layout_marginTop="16dp"
             android:background="@drawable/edittext_white"
             android:padding="12dp"
-            android:textColor="#000000"
-            android:textColorHint="#888888" />
+            android:textColor="#000000" />
 
-        <!-- LIMIT AND OPTIONS -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:layout_marginTop="8dp"
-            android:orientation="horizontal"
-            android:weightSum="3">
+            android:orientation="horizontal">
 
             <EditText
-                android:id="@+id/edit_limit"
+                android:id="@+id/edit_capacity"
                 android:layout_width="0dp"
                 android:layout_height="wrap_content"
                 android:layout_weight="1"
                 android:layout_marginEnd="8dp"
-                android:hint="Limit"
+                android:hint="Max Capacity"
                 android:inputType="number"
                 android:background="@drawable/edittext_white"
                 android:padding="12dp"
                 android:textColor="#000000" />
 
-            <CheckBox
-                android:id="@+id/checkbox_geo"
-                android:layout_width="0dp"
-                android:layout_height="wrap_content"
-                android:layout_weight="1"
-                android:text="GEO"
-                android:textColor="#FFFFFF"
-                android:buttonTint="#2E5BFF"
-                android:gravity="center" />
-
-            <CheckBox
-                android:id="@+id/checkbox_qr"
-                android:layout_width="0dp"
-                android:layout_height="wrap_content"
-                android:layout_weight="1"
-                android:text="QR"
-                android:textColor="#FFFFFF"
-                android:buttonTint="#2E5BFF"
-                android:gravity="center" />
-        </LinearLayout>
-
-        <!-- POSTER UPLOAD -->
-        <Button
-            android:id="@+id/button_upload_poster"
-            android:layout_width="match_parent"
-            android:layout_height="150dp"
-            android:layout_marginTop="8dp"
-            android:text="+ Upload Poster"
-            android:textColor="#000000"
-            android:background="@drawable/edittext_white"
-            android:textStyle="bold" />
-
-        <!-- LOCATION INPUTS -->
-        <LinearLayout
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content"
-            android:layout_marginTop="8dp"
-            android:orientation="horizontal"
-            android:weightSum="3">
-
             <EditText
-                android:id="@+id/edit_address"
+                android:id="@+id/edit_limit"
                 android:layout_width="0dp"
                 android:layout_height="wrap_content"
                 android:layout_weight="1"
-                android:layout_marginEnd="4dp"
-                android:hint="Address"
+                android:layout_marginEnd="8dp"
+                android:hint="Waitlist Limit"
+                android:inputType="number"
                 android:background="@drawable/edittext_white"
                 android:padding="12dp"
                 android:textColor="#000000" />
+        </LinearLayout>
 
-            <EditText
-                android:id="@+id/edit_city"
-                android:layout_width="0dp"
-                android:layout_height="wrap_content"
-                android:layout_weight="1"
-                android:layout_marginEnd="4dp"
-                android:hint="City"
-                android:background="@drawable/edittext_white"
-                android:padding="12dp"
-                android:textColor="#000000" />
+        <LinearLayout
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="8dp"
+            android:orientation="horizontal">
 
             <EditText
-                android:id="@+id/edit_province"
-                android:layout_width="0dp"
+                android:id="@+id/edit_location"
+                android:layout_width="match_parent"
                 android:layout_height="wrap_content"
-                android:layout_weight="1"
-                android:hint="Province"
+                android:hint="Location (Full Address)"
                 android:background="@drawable/edittext_white"
                 android:padding="12dp"
                 android:textColor="#000000" />
         </LinearLayout>
 
-        <!-- DESCRIPTION -->
         <EditText
             android:id="@+id/edit_description"
             android:layout_width="match_parent"
@@ -181,13 +107,11 @@
             android:padding="12dp"
             android:textColor="#000000" />
 
-        <!-- DATE & TIME -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:orientation="horizontal"
-            android:layout_marginTop="8dp"
-            android:weightSum="2">
+            android:layout_marginTop="8dp">
 
             <EditText
                 android:id="@+id/edit_date"
@@ -195,8 +119,9 @@
                 android:layout_height="wrap_content"
                 android:layout_weight="1"
                 android:layout_marginEnd="4dp"
-                android:hint="Event Date"
-                android:drawableStart="@drawable/ic_calendar"
+                android:hint="Date"
+                android:focusable="false"
+                android:clickable="true"
                 android:background="@drawable/edittext_white"
                 android:padding="12dp"
                 android:textColor="#000000" />
@@ -206,14 +131,14 @@
                 android:layout_width="0dp"
                 android:layout_height="wrap_content"
                 android:layout_weight="1"
-                android:hint="Event Time"
-                android:drawableStart="@drawable/ic_clock"
+                android:hint="Time"
+                android:focusable="false"
+                android:clickable="true"
                 android:background="@drawable/edittext_white"
                 android:padding="12dp"
                 android:textColor="#000000" />
         </LinearLayout>
 
-        <!-- REGISTRATION DATES -->
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
@@ -226,7 +151,9 @@
                 android:layout_height="wrap_content"
                 android:layout_weight="1"
                 android:layout_marginEnd="4dp"
-                android:hint="Registration Start"
+                android:hint="Reg Start"
+                android:focusable="false"
+                android:clickable="true"
                 android:background="@drawable/edittext_white"
                 android:padding="12dp"
                 android:textColor="#000000" />
@@ -236,100 +163,57 @@
                 android:layout_width="0dp"
                 android:layout_height="wrap_content"
                 android:layout_weight="1"
-                android:hint="Registration End"
+                android:hint="Reg End"
+                android:focusable="false"
+                android:clickable="true"
                 android:background="@drawable/edittext_white"
                 android:padding="12dp"
                 android:textColor="#000000" />
         </LinearLayout>
 
-        <!-- FILTER ICONS -->
-        <TextView
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content"
-            android:layout_marginTop="16dp"
-            android:text="Select Filters"
-            android:textColor="#FFFFFF"
-            android:textSize="16sp"
-            android:textStyle="bold" />
-
         <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
-            android:gravity="center"
             android:layout_marginTop="8dp"
             android:orientation="horizontal">
 
-            <ImageView
-                android:layout_width="40dp"
-                android:layout_height="40dp"
-                android:layout_margin="8dp"
-                android:src="@drawable/ic_sports"
-                android:background="@drawable/circle_white"
-                android:contentDescription="Sports" />
-
-            <ImageView
-                android:layout_width="40dp"
-                android:layout_height="40dp"
-                android:layout_margin="8dp"
-                android:src="@drawable/ic_music"
-                android:background="@drawable/circle_white"
-                android:contentDescription="Music" />
-
-            <ImageView
-                android:layout_width="40dp"
-                android:layout_height="40dp"
-                android:layout_margin="8dp"
-                android:src="@drawable/ic_art"
-                android:background="@drawable/circle_white"
-                android:contentDescription="Art" />
-
-            <ImageView
-                android:layout_width="40dp"
-                android:layout_height="40dp"
-                android:layout_margin="8dp"
-                android:src="@drawable/ic_food"
-                android:background="@drawable/circle_white"
-                android:contentDescription="Food" />
+            <CheckBox
+                android:id="@+id/checkbox_geo"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Require Geo-Location"
+                android:textColor="#FFFFFF"
+                android:buttonTint="#2E5BFF"
+                android:layout_marginEnd="16dp"/>
 
-            <ImageView
-                android:layout_width="40dp"
-                android:layout_height="40dp"
-                android:layout_margin="8dp"
-                android:src="@drawable/ic_more"
-                android:background="@drawable/circle_white"
-                android:contentDescription="Other" />
-        </LinearLayout>
-
-        <!-- BUTTONS -->
-        <LinearLayout
-            android:layout_width="match_parent"
-            android:layout_height="wrap_content"
-            android:orientation="horizontal"
-            android:gravity="center"
-            android:layout_marginTop="16dp">
+            <CheckBox
+                android:id="@+id/checkbox_qr"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:text="Generate QR"
+                android:textColor="#FFFFFF"
+                android:buttonTint="#2E5BFF"/>
+        </LinearLayout>
 
-            <Button
-                android:id="@+id/button_reset"
-                android:layout_width="0dp"
-                android:layout_height="48dp"
-                android:layout_weight="1"
-                android:layout_marginEnd="8dp"
-                android:text="RESET"
-                android:textStyle="bold"
-                android:textColor="#000000"
-                android:background="@drawable/white_button_bg" />
+        <Button
+            android:id="@+id/button_upload_poster"
+            android:layout_width="match_parent"
+            android:layout_height="50dp"
+            android:layout_marginTop="8dp"
+            android:text="+ Change Poster"
+            android:textColor="#000000"
+            android:background="@drawable/edittext_white"
+            android:textStyle="bold" />
 
-            <Button
-                android:id="@+id/button_create"
-                android:layout_width="0dp"
-                android:layout_height="48dp"
-                android:layout_weight="1"
-                android:text="CREATE"
-                android:textStyle="bold"
-                android:textColor="@android:color/white"
-                android:background="@drawable/blue_button_bg"
-                android:backgroundTint="@null" />
-        </LinearLayout>
+        <Button
+            android:id="@+id/button_save"
+            android:layout_width="match_parent"
+            android:layout_height="48dp"
+            android:layout_marginTop="24dp"
+            android:text="SAVE CHANGES"
+            android:textStyle="bold"
+            android:textColor="@android:color/white"
+            android:backgroundTint="#3A5BFF" />
+
     </LinearLayout>
-</ScrollView>
-
+</ScrollView>
\ No newline at end of file
